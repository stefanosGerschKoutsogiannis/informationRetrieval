2017,Interactive Submodular Bandit,In many machine learning applications  submodular functions have been used as a model for evaluating the utility or payoff of a set such as news items to recommend  sensors to deploy in a terrain  nodes to influence in a social network  to name a few. At the heart of all these applications is the assumption that the underlying utility/payoff function is known a priori  hence maximizing it is in principle possible. In real life situations  however  the utility function is not fully known in advance and can only be estimated via interactions. For instance  whether a user likes a movie or not can be reliably evaluated only after it was shown to her. Or  the range of influence of a user in a social network can be estimated only after she is selected to advertise the product. We model such problems as an interactive submodular bandit optimization  where in each round we receive a context (e.g.  previously selected movies) and have to choose an action (e.g.  propose a new movie). We then receive a noisy feedback about the utility of the action (e.g.  ratings) which we model as a submodular function over the context-action space. We develop SM-UCB that efficiently trades off exploration (collecting more data) and exploration (proposing a good action given gathered data) and achieves a $O(\sqrt{T})$ regret bound after $T$ rounds of interaction. Given a bounded-RKHS norm kernel over the context-action-payoff space that governs the smoothness of the utility function  SM-UCB keeps an upper-confidence bound on the payoff function that allows it to asymptotically achieve no-regret. Finally  we evaluate our results on four concrete applications  including movie recommendation (on the MovieLense data set)  news recommendation (on Yahoo! Webscope dataset)  interactive influence maximization (on a subset of the Facebook network)  and personalized data summarization (on Reuters Corpus). In all these applications  we observe that SM-UCB consistently outperforms the prior art.,InteractiveSubmodularBanditLinChen1 2 AndreasKrause3 AminKarbasi1 21DepartmentofElectricalEngineering 2YaleInstituteforNetworkScience YaleUniversity3DepartmentofComputerScience ETHZürich{lin.chen amin.karbasi}@yale.edu krausea@ethz.chAbstractInmanymachinelearningapplications submodularfunctionshavebeenusedasamodelforevaluatingtheutilityorpayoffofasetsuchasnewsitemstorecommend sensorstodeployinaterrain nodestoinﬂuenceinasocialnetwork tonameafew.Attheheartofalltheseapplicationsistheassumptionthattheunderlyingutility/payofffunctionisknownapriori hencemaximizingitisinprinciplepossible.Inmanyreallifesituations however theutilityfunctionisnotfullyknowninadvanceandcanonlybeestimatedviainteractions.Forinstance whetherauserlikesamovieornotcanbereliablyevaluatedonlyafteritwasshowntoher.Or therangeofinﬂuenceofauserinasocialnetworkcanbeestimatedonlyaftersheisselectedtoadvertisetheproduct.Wemodelsuchproblemsasaninteractivesubmodularbanditoptimization whereineachroundwereceiveacontext(e.g. previouslyselectedmovies)andhavetochooseanaction(e.g. proposeanewmovie).Wethenreceiveanoisyfeedbackabouttheutilityoftheaction(e.g. ratings)whichwemodelasasubmodularfunctionoverthecontext-actionspace.WedevelopSM-UCBthatefﬁcientlytradesoffexploration(collectingmoredata)andexploration(proposingagoodactiongivengathereddata)andachievesaO(√T)regretboundafterTroundsofinteraction.Morespeciﬁcally givenabounded-RKHSnormkerneloverthecontext-action-payoffspacethatgovernsthesmoothnessoftheutilityfunction SM-UCBkeepsanupper-conﬁdenceboundonthepayofffunctionthatallowsittoasymptoticallyachieveno-regret.Finally weevaluateourresultsonfourconcreteapplications includingmovierecommendation(ontheMovieLensedataset) newsrecommendation(onYahoo!Webscopedataset) interactiveinﬂuencemaximization(onasubsetoftheFacebooknetwork) andpersonalizeddatasummarization(onReutersCorpus).Inalltheseapplications weobservethatSM-UCBconsistentlyoutperformsthepriorart.1IntroductionInteractivelearningisamodernmachinelearningparadigmthathasrecentlyreceivedsigniﬁcantinterestinboththeoryandpractice[15 14 7 6].Inthissetting thelearningalgorithmengagesinatwo-waydialogwiththeenvironment(e.g. users)byperformingactionsandreceivingaresponse(e.g. likeordislike)foreachaction.Interactivelearninghasledtosubstantialperformanceimprovementinavarietyofmachinelearningapplications[43 13] includingclustering[4 25 1] classiﬁcation[46 10] languagelearning[48] decisionmaking[26] andrecommendersystems[28] tonameafew.Atahighlevel interactivelearningcanbecastasadynamicoptimizationproblemwithaknownutility/payofffunctionwherethegoalistoachieveanobjectivewhosevaluedependsontheselectedactions theirresponses andthestateoftheenvironment.Inmanypracticalsettings theutilityfunctionsaresubmodular stating(informally)thatthepayoffofperforminganactionearlierismore31stConferenceonNeuralInformationProcessingSystems(NIPS2017) LongBeach CA USA.thanperformingitlater.Infact rigoroustreatmentofsubmodularityininteractivesettingsledtostrongtheoreticalguaranteesontheperformanceofgreedypolicies[19 22].Inthispaper wegoonestepfurtherandconsiderscenarioswheretheexactformofthesubmodularpayofffunctionisnotcompletelyknownandhenceneedstobeestimatedthroughinteractions.Thisproblemiscloselyrelatedtothecontextualmulti-armedbandit[38 9 36]whereforasequenceofTrounds wereceiveapayofffunctionalongwithsomesideinformationorcontext(e.g. user’sfeatures) basedonwhichwehavetochooseanaction(e.g. proposinganitem)andthenanoisyfeedbackabouttheobtainedpayoffisrevealed(e.g. ratingoftheproposeditem).Thegoalistominimizetheregretofnotselectingtheoptimalactionduetotheuncertaintyassociatedwiththeutilityfunction.Theinteractivecontextualbanditgeneralizesthissettingbyallowingtointeractwithapayofffunctionmultipletimes whereeachtimeweneedtotakeanewactionbasedonboththecontextandpreviouslytakenactions.Theregretisthendeﬁnedintermsofthedifferencebetweentheutilityofthebestsetofactionsthatwecouldhavechosenversustheonesthatareactuallyselected.Inthispaper wefurtherassumethatthemarginalpayoffsofactionsshowdiminishingreturns.Thisproblem whichwecallinteractivesubmodularbandit appearsinmanypracticalscenarios including:•Interactiverecommendersystem.Thegoalistodesignarecommendersystemthatinteractswiththeusersinordertoelicitandsatisfytheirpreferences.Inourapproach wemodeltheutilityofasetofitemsasanunknownsubmodularobjectivefunctionthattherecommendersystemsaimstomaximize.Ineachroundofinteraction therecommendersystemdecideswhichitemshouldbepresentedtotheuser giventhepreviouslyproposeditemstothisorsimilarusers(afﬁnitybetweenusers ifthissideinformationexists canbeleveragedtoenhancerecommendationperformance).Sincetheusers’preferencesareunknown therecommendersystemcanonlygatherinformationabouttheusersthroughthefeedbacktheyprovideintermsofratings.AsuccessfulrecommendersystemshouldbeabletominimizethetotalregretaccumulatedoverTiterationswithusers.•Interactiveinﬂuencemaximization.Inﬂuencespreadmaximizationaddressestheproblemofselectingthemostinﬂuentialsourcenodesofagivensizeinadiffusionnetwork[51].Adiffusionprocessthatstartswiththosesourcenodescanpotentiallyreachthegreatestnumberofnodesinthenetwork.Undermanydiffusionmodels theexpectedtotalnumberofinﬂuencedpeopleisasubmodularfunctionoftheseedsubjects[29 20].Inanaturalinteractivevariantofthisproblem usersmayberecruitedinasequentialmanner[42 5]whereanewuserisselectedoncewefullyobservetheextenttowhichthecurrentseedusersinﬂuencedpeople.Notethatﬁndingtheoptimalsetofsourcenodesinadiffusionnetworkdependsdramaticallyontheunderlyingdynamicsofthediffusion.Again veryofteninpractice wearefacedwiththedilemmaofestimatingtheunderlyingdiffusionparametersthroughinteractivelyselectingthenodeswhileatthesametimetryingtomaximizetheinﬂuence.•Interactivecoverage.Coverageproblemsarisenaturallyinmanyapplications[32 33].Consideranenvironmentalmonitoringtask forinstance wheresensorsareplacedintheAlpstobetterpredictﬂoods landslidesandavalanches[8].Similarly Wi-Fihotspotsarecarefullyarrangedtocovereverycornerofaﬂoor.However itislikelythattheactualcoverageofadeviceisuncertainbeforedeploymentduetounknownconditionspresentintheenvironment.Hence wemightneedtoinstalldevicesinasequentialmannerafterweobservetheactualcoverageoftheonesalreadyinstalled[19 22].Withoutanyassumptionsaboutthesmoothnessofthepayofffunction noalgorithmmaybeabletoachievelowregret[31].Thus inoursetting wemakeacrucialyetverynaturalassumptionthatthespaceofcontext-action-payoffhaslowcomplexity quantiﬁedintermsoftheReproducingKernelHilbertSpace(RKHS)normassociatedwithsomekernel[24].WethenshowthatSM-UCB anupper-conﬁdence-boundbasedalgorithmachievesanO(√T)regret.WealsoevaluatetheperformanceofSM-UCBonfourreal-worldapplications includingmovierecommendation[40] newsrecommendation[16] interactiveinﬂuencemaximization[42 34] andpersonalizeddatasummarization[39].22ProblemFormulationAswestatedearlier manyutilityorpayofffunctionsweencounterinmachinelearningapplicationsaresubmodular.Asareminder asetfunctionfiscalledsubmodularifforallA⊆B⊆Ωwehavef(A)+f(B)≥f(A∩B)+f(A∪B).Anequivalentdeﬁnitionofsubmodularitythatshowsbetterthediminishingreturnspropertyisasfollows:forallA⊆B⊆Ωandanyelemente6∈Bwehavef(A∪{e})−f(A)≥f(B∪{e})−f(B).WealsodenotethemarginalgainofanelementetoasetAby∆(e|A) f(A∪{e})−f(A).ThefunctionfiscalledmonotoneifforallA⊆Bwehavef(A)≤f(B).Inthispaper weconsiderasequentialdecisionmakingprocessforahorizonofTtimesteps whereateachroundi amonotonesubmodularfunctionfi is(partially)revealed.Letusﬁrstconsiderthesimplebanditproblem[50]whereweneedtoselectanitem(oranarm)efromthesetofitemsΩsuchthatfi(e)ismaximized.Aftertheitemeisselected thepayofffi(e)isrevealed.Sinceft’sarenotknowninadvance thegoalistominimizetheaccumulatedregretoverTrounds fornotchoosingtheoptimumitems.Contextualsubmodularbanditgeneralizestheaforementionedsettingbyallowingtoreceivesideinformationφi(alsocalledcontext)ineachroundi[31].Butstillthegoalistoselectasingleitemesuchthatfφi(e)ismaximized.Intheinteractivecontextualsubmodularbandit thefocusofthispaper wemayencounterthesamevaluationfunctionfφ withitsassociatecontextφ multipletimesoverthetimehorizonT.Hereinstead ateachround weneedtoproposeanewitemthatmaximizesthemarginalpayoffgiventheonesweselectedinthepreviousencounters.Therefore wearesequentiallybuildingupsubsetsofitemsthatmaximizethepayoffforeachseparatefunctionfφ.Forinstance arecommendersystemmayinteractwithauser(oranumberofusers)multipletimes.Ineachinteraction ithastorecommendanewitemwhiletakingintoaccountwhatithasrecommendedinpreviousinteractions.Moreformally letusassumethatweencounterm≤Tdistinctfunctionsfφ inanarbitraryorder overthetimehorizonT i.e. φ∈{φ1 ... φm}.Wedenotethearrivingorderedsequencebyf1 f2 ... fTwhereforeachroundi wehavefi∈{fφ1 ... fφm}.Letusalsodenotebyui∈{1 ... m}theindexofthecontextreceivedinroundi.WealsoneedtomaintainacollectionofmsetsS1 ... Sm (initializedtotheemptyset)correspondingtofφ1 ... fφm.OurgoalistoselectasubsetSj⊆Ωforeachfunctionfφjthatmaximizesitscorrespondingutilityfφj(Sj).Notethatiffφjwereknowninadvance wecouldsimplyusethegreedyalgorithm.However intheinteractivesubmodularbanditsetting weneedtobuildupthesetsSjsequentiallyandthroughinteractions asthemarginalpayoffofanelementisonlyrevealedafteritisselected.Letoi Pj≤i1{uj=ui}denotethenumberofoccurrencesoffunctionfφuiintheﬁrstirounds.Ineachround saythei-thwiththecorrespondingfunctionfφui weneedtoselectanewitemxoi uifromthesetofitemsΩandaddittoSui.Clearly afterincludingxoi ui thesetSuiwillbeofcardinalityoi.Fortheeaseofpresentation wedenoteSui∪{xoi ui}bySoi ui initializedtotheemptysetinthebeginning i.e. S0 ui=∅.Afterselectingtheitemxoi uiandgiventhepreviouslyselecteditemsSui wereceiveyi anoisy(butunbiased)estimateofxoi ui’smarginalpayoff i.e. yi=∆(xoi ui|Soi−1 ui φui)+i wherethemarginalgain∆(·|· ·):Ω×2Ω×Φ→Risdeﬁnedas∆(x|S φ)=fφ(S∪{x})−fφ(S).(1)Wealsoassumethati’sareuniformlyboundednoisevariablesthatformamartingaledifferencesequence i.e. E[i|1 2 ... i−1]=0and|i|≤σforalli∈{1 ... T}.Wecallσthenoiselevel.Notethatyiistheonlyfeedbackthatweobtaininroundi.ItcruciallydependsonthepreviouslyselecteditemsandcontextualinformationSoi−1 ui φui.Therefore theonlyavenuethroughwhichwecanlearnaboutthepayofffunctionsfφ(thatwetrytooptimizeover)isvianoisyfeedbacksyi.WeneedtodesignanalgorithmthatminimizestheaccumulatedregretoverthetotalnumberofTrounds.Formally wecomparetheperformanceofanyalgorithminthisinteractivesubmodularbanditsettingwiththatofthegreedyalgorithmwiththefullknowledgeofthepayofffunctionsfφ1 ... fφm.3Algorithm1SM-UCBInput:setofitemsΩ meanµ0=0 varianceσ0.1:InitializeSi←∅foralli∈[m]2:fori=1 2 3 ...do3:selectanitemxoi ui←argmaxx∈Ωµi−1(x)+√βiσi−1(x)4:updatethesetSui←Sui∪{xoi ui}5:obtainthefeedbackyi=∆(xoi ui|Soi−1 ui φui)+i6:letki(x)beavector-valuedfunctionthatoutputsani-dimensionalcolumnvectorwithj-thentryk((xoj uj Soj−1 uj φuj) (x Soi−1 ui φui))7:letKibeani×imatrixwith(j j0)-entryk((xoj uj Soj−1 uj φuj) (xoj0 uj0 Soj0−1 uj0 φuj0))8:updateyi←[y1 y2 ... yi]T9:letki(x x0)beakernelfunctiondeﬁnedask(x x0)−ki(x)T(Ki+σ2I)−1ki(x0)10:estimateµi(x)←ki(x)T(Ki+σ2I)−1yi11:estimateσi(x)←pki(x x)12:endforSupposethatbytheendoftheT-thround analgorithmhasselectedTjitemsforthepayofffunctionfφj;thereforethecardinalityofSjbytheendoftheT-throundisTj.Thus wehaveTj=Pt≤T1{ut=j}andT=Pmj=1Tj.WeuseS∗jtodenotethesetthatmaximizesthepayoffoffunctionfφjwithatmostTjelements i.e. S∗j=argmax|S|≤Tjfφj(S).Weknowthatthegreedyalgorithmisguaranteedtoachieve(1−1/e)Pmj=1fφj(S∗j)[41]andthereisnopolynomialtimealgorithmthatachievesabetterapproximationguaranteeingeneral[17].Therefore wedeﬁnethetotalregretofanalgorithmuptoroundTasfollows:RT (1−1/e)mXj=1fφj(S∗j)−mXj=1fφj(STj j) (2)whichisthegapbetweenthegreedyalgorithm’sguaranteeandthetotalutilityobtainedbythealgorithm.Withoutanysmoothnessassumptionoverthepayofffunctions itmaynotbepossibletoguaranteeasublinearregret[31].Inthispaper wemakeanaturalassumptionaboutthecomplexityofpayofffunctions.Morespeciﬁcally weassumethatthemarginalpayoffs deﬁnedin(1) havealowRKHS-normaccordingtoakernelk:(Ω×2Ω×Φ)×(Ω×2Ω×Φ)→R i.e. k∆(·|· ·)kk≤B.Notethatsuchakernelencodeshowclosetwomarginalpayoffsareifa)thecontextsφiandφjorb)theselectedelementsSiandSjaresimilar.Forinstance arecommendersystemcanleveragethisinformationtoproposeanitemtoauserifithasobservedthatauserwithsimilarfeatureslikedthatitem.3MainResultsInAlgorithm1weproposeSM-UCB aninteractivesubmodularbanditalgorithm.Recallthatthemarginalgainfunction∆hasalowRKHSnormw.r.t.somekernelk.Ineachround saythei-th SM-UCBmaintainstheposteriormeanµi−1(·)andstandarddeviationσi−1(·)conditionedonthehistoricalobservationsorcontext{(xoj uj Soj−1 uj φuj):1≤j≤i}.Basedontheseposteriorestimates SM-UCBthenselectsanitemxthatattainsthehighestupperconﬁdenceboundµi−1(x)+√βiσi−1(x).Itthenreceivesthenoisyfeedbackyi=∆(xoi ui|Soi−1 ui φui)+i.Sincei’sareuniformlyboundedandformamartingaledifferencesequence SM-UCBcanpredictthemeanµiandstandarddeviationσiviaposteriorinferenceinordertodeterminetheitemtobeselectedinthenextround.Inordertoboundtheregretofanalgorithm weneedtoquantifyhowmuchinformationthatalgorithmcanacquirethroughinteractions.LetyAdenoteasubsetofnoisyobservationsindexedbythesetA i.e. yA={yi|i∈A}.NotethatanysubsetAofnoisyobservationsyAreducesouruncertaintyaboutthemarginalgainfunction∆.Inanextremecase ifwehadperfectinformation(ornouncertainty)about∆ wecouldhaveachievedzeroregret.WecanpreciselyquantifythisnotionthroughwhatiscalledtheinformationgainI(yA;∆)=H(yA)−H(yA|∆) whereHdenotestheShannonentropy.Infact byliftingtheresultsfrom[31 44]toamuchmoregeneralsetting werelatetheregrettothemaximuminformationgainγT[44]obtainedafterTroundsanddeﬁnedas4γT maxA⊆Ω:|A|=TI(yA;∆).AnotherimportantquantitythatshowsupintheregretboundistheconﬁdenceparameterβT(seeline3ofAlgorithm1)thatneedstobechosencarefullysothatourtheoreticalguaranteeholdswithhighprobability.Infact thefollowingtheoremshowsthatSM-UCBattainsaO(√TβTγT)regretboundwithhighprobability.Theorem1.Supposethatthetruemarginalgainfunction∆(·|· ·)hasasmallRKHSnormaccordingtosomekernelk i.e. k∆(·|· ·)kk≤B.ThenoisevariablestsatisfyE[t|1 2 ... t−1]=0forallt∈Nandareuniformlyboundedbyσ.Letδ∈(0 1) βt=2B2+300γtln3(t/δ)andC1=8/log(1+σ−2).Then theaccumulatedregretofSM-UCBoverTroundsisasfollows:PrnRT≤pC1TβTγT+2 ∀T≥1o≥1−δ.TheproofoftheabovetheoremisprovidedintheSupplementaryMaterial.Itreliesontwopowerfulideas:greedyselectionforconstrainedsubmodularmaximization[41]andupperconﬁdenceboundsofcontextualGaussianbandit[31].Ifthemarginalpayoffswerecompletelyknown thenthegreedypolicywouldprovideacompetitivesolutiontotheoptimum.However onecannotrunthegreedypolicywithoutknowingthemarginalgains.Infact therearestrongnegativeresultsregardingtheapproximationguaranteeofanypolynomialtimealgorithmifthemarginalgainsarearbitrarilynoisy[23].Instead SM-UCBreliesonoptimisticestimatesofthemarginalgainsandselectgreedilyanitemwiththehighestupperconﬁdencebound.ByassumingthatmarginalgainsaresmoothandrelyingonTheorem1in[31] wecancontroltheaccumulatederrorofagreedy-likesolutionthatreliesonconﬁdenceboundsandobtainlowregret.Oursettingandtheoreticalresultgeneralizeanumberofpriorworkmentionedbelow.Linearsubmodularbandit[50].Inthissetting theobjectivefunctionhastheformf(S)=Pdi=1wifi(S) wherefi’sareknownsubmodularfunctionsandwi’sarepositiveunknowncoefﬁ-cients.Therefore themarginalgainfunctioncanbewrittenas∆(x|S)=Pdi=1wi∆i(x|S) where∆i(·|·)’sareknownfunctionsandwi’sareunknowncoefﬁcients.Letw=(w1 w2 ... wd)denotetheweightvector.Sincetheonlyunknownpartofthemarginalgainfunctionistheweightvector thespaceofthemarginalgainfunctionisisomorphictothespaceofweightvectors whichisinfactad-dimensionalEuclideanspaceRd.TheRKHSnormof∆isgivenbysomenorminRd;i.e. k∆kk kwk.Theassumptionin[50]thatkwk≤Bisequivalenttoassumingthatk∆kk≤B.Therefore thelinearbanditsettingisincludedinoursettingwherethemarginalgainfunction∆hasaspecialformanditsRKHSnormisgivenbythenormofitscorrespondingweightvectorintheEuclideanspace.Also LSBGREEDYproposedin[50] isaspecialcaseofSM-UCB(exceptthatthefeedbackisdelayed).Adaptivevaluableitemdiscovery[47].Inthissetting theobjectivefunctionhastheformf(S)=(1−λ)Px∈Sg(x)+λD(S) whereDisaknownsubmodularfunctionthatquantiﬁesthediversityoftheitemsinS gisanunknownfunctionthatdenotestheutilityg(x)foranyitemx andλisaknowntradeoffparameterbalancingtheimportanceoftheaccumulativeutilityandjointdiversityoftheitems.NotethattheunknownfunctionM(S)=Px∈Sg(x)isamodularfunction.Therefore themarginalgainfunctionhastheform∆(x|S)=(1−λ)g(x)+λD(x|S) whereD(x|S) D({x}∪S)−D(S).Theonlyuncertaintyof∆arisesfromtheuncertaintyaboutthemodularfunctionM.Inparticular [47]assumesthattheRKHSnormofgisbounded.Again oursettingencompassesadaptivevaluableitemdiscoveryasweconsideranymonotonesubmodularfunction.Moreover GPSELECTproposedin[47] isaspecialcaseofSM-UCB.ContextualGaussianbandit[31].ThisistheclosestsettingtoourswhereineachroundiwereceiveacontextφifromthesetofcontextsΦandhavetochooseanitemxfromthesetofitemsΩ.Wethenreceiveapayofffφi(x)+t.Notethatinsteadofbuildingupaset(ourproblem) inthecontextualbanditprocesswesimplychooseasingleelementforeachfunctionfφiasthemainassumptionisthatweencountereachfunctiononlyonce.Toobtainregretboundsitisassumedin[31]thatfhaslownormintheRKHSassociatedwithsomekernelk.Again CGP-UCBproposedin[31] isaspecialcaseofSM-UCB.54ExperimentsInthissection wecompareempiricallytheperformanceofSM-UCBwiththefollowingbaselines:•RANDOM.Ineachround anitemisrandomlyselectedforthecurrentpayofffunctionfφ.•GREEDY.Ithasthefullknowledgeofthesubmodularfunctionsfφ.Ineachround saythei-thwiththecorrespondingfunctionfφui GREEDYselectstheitemthatmaximizesthemarginalgain i.e. argmaxx∈Ω∆(x|Soi−1 φui).•HISTORY-FREE.WerunSM-UCBwithoutconsideringthepreviouslyselecteditems.HISTORY-FREEisbasicallythecontextualGaussianbanditalgorithmproposedin[31]whosecontextistheuserfeature.•FEATURE-FREE.WerunSM-UCBwithoutconsideringthecontextφofanarrivingfunctionf.•CONTEXT-FREE.WerunSM-UCBwithoutconsideringthecontextorthepreviouslyselectedelements.Infact CONTEXT-FREEisbasicallytheGP-SELECTalgorithmproposedin[47].Inallofourexperiments themdistinctfunctions{fφi:1≤i≤m}thatthealgorithmencountersrepresentthevaluationfunctionsofmusers wherethecontextφi∈Rdencodesusers’features.Moreover Siisthesetofitemsthatanalgorithmselectsforuseri∈[m].Insteadofcomputingtheregret wequantifytheperformanceofthealgorithmsbycomputingtheaccumulatedrewardPmi=1fφi(Si).Recallthattheregretisgivenby(1−1/e)·OPT−Pmi=1fφi(Si) whereOPT=Pmi=1fφi(S∗i)isaconstantgenerallyhardtocompute.MovieRecommendationInthissetofexperiments weusetheMovieLensdataset1whereauser-ratingmatrixMisprovided.TherowsofMrepresentusersandthecolumnsrepresentmovies.ThematrixMcontains943usersand1682movies.Asapreprocessingstep weapplythesingular-valuedecomposition(SVD)toimputethemissingvalues;thesixlargestsingularvaluesarekept.Intheﬁrstpartofthestudy weusethesubmatrixofMthatconsistsof80%oftheusersandallofthemoviesfortrainingthefeaturevectorsofmoviesviaSVD.LetM0bethesubmatrixofMthatconsistsoftheremainingnuserusersandallofthemovies;thismatrixisfortesting.LetΩdenotethesetofmovies.WeconsiderselectingasubsetofΩtomaximizethefacility-location-typeobjective[30]f(S)=Pnuseri=1maxj∈SM0ij.Thisobjectivefunctioncorrespondstoascenariowithoutanycontextφasthereisonlyonepayofffunctionfthatwearetryingtomaximize.Thus FEATURE-FREEdoesnotapplyhere.Weusethecosinekernelkmovie:Ω×Ω→RforpairsofmoviesandJaccardkernelksubset(S T)=|S∩T|/|S∪T|[18]forpairsofsubsetsofmovies saySandT.Thecompositekernelk:(Ω×2Ω)×(Ω×2Ω)→Risdeﬁnedasκ1kmovie⊕κ2ksubset i.e. k((u S) (v T))=κ1kmovie(u v)+κ2ksubset(S T) whereκ1 κ2>0.TheresultsareshowninFig.1(a).ThehorizontalaxisdenotesthecardinalityofS.TheverticalaxisdenotesthefunctionvalueoffonthesetS.WeobservethatSM-UCBoutperformsallofthebaselinesexceptthepracticallyinfeasibleGREEDY.Inthesecondpart weconsiderasettingwhereaseparatesubsetofmoviesisselectedforeachuser.Weclustertheusersinthedatasetinto40groupsviathek-meansalgorithmandtheusersofthesamegroupareviewedasidenticalusers.Thefeaturevectorofagroupofusersisthemeanofthefeaturevectorsofallmemberusersandtheratingofagroupisthesumoftheratingsofallmemberusers.Theusersarelabeledas1 2 3 ... n0user wheren0user=40.Similartotheﬁrstpart thefeaturevectorsoftheusersandmoviesareobtainedviaSVD.WemaintainasetSiforuseri.Theobjectivefunctionisfφi(S)=maxj∈SM00ij whereM00ijisuseri’sratingformoviej.Inaddition wealsoneedacollectiveobjectivefunctionthatquantiﬁestheoverallperformanceofanalgorithmforallusers.Itisdeﬁnedasf(S1 S2 ... Sn0user)=Pn0useri=1fφi(Si).Weassumearandomarrivalofusers.Weusethelinearkernelkuser:Φ×Φ→Rforpairsofusers.Thecompositekernelk:(Ω×2Ω×Φ)×(Ω×2Ω×Φ)→Risdeﬁnedasκ1kmovie⊕κ2ksubset⊕κ3kuser.InFig.1(b) weplottheperformanceofSM-UCBagainstotherbaselines.Thehorizontalaxisdenotesthenumberofuserarrivalswhiletheverticalaxisdenotesthevalueofthecollectiveobjectivefunction.We1https://grouplens.org/datasets/movielens/6GreedySM-UCBHistory freeRandom(a)GreedySM-UCBRandomFeature freeHistory freeContext free(b)GreedySM-UCBHistory freeRandom(c)GreedyRandomHistory freeSM-UCB(d)GreedySM-UCBRandomContext freeHistory freeFeature free(e)GreedySM-UCBFeature freeContext freeHistory free(f)Figure1:Figs.1(a)and1(b)showtheresultsoftheexperimentsontheMovieLensdataset.Fig.1(a)showshowthetotalobjectivefunctionforallusersevolvesasthenumberofselectedmoviesincreases;thealgorithmrecommendsthesamesubsetofmoviestoallusers.InFig.1(b) weconsiderthesituationwhereusersarriveinarandomorderandwehavetorecommendaseparatesubsetofmoviestoeachuser.Figs.1(c)and1(d)showthedependencyoffractionofinﬂuencednodesonthetargetsetsizeintheFacebooknetworkandthestudentnetworkfromtheUserKnowledgeModellingDataset[27].Fig.1(e)showshowthepayofffunctionvariesasmoreusersarriveintheYahoonewsrecommender.InFig.1(f) weconsiderthepersonalizeddatasummarizationfromReuterscorpusforarrivingusers.Itshowsthefractionofcoveredtopicsversusthenumberofuserarrivals.observethatSM-UCBoutperformsallotherbaselinesexceptGREEDY.Inaddition CONTEXT-FREEthatusestheleastamountofinformationachievesalowerfunctionvaluethanHISTORY-FREEandFEATURE-FREE whicheitherleveragestheinformationaboutusers’featuresorpreviouslyselecteditems.7InteractiveInﬂuenceMaximizationForthisexperiment weusetheFacebooknetworkprovidedin[35].Thegoalistochooseasubsetofsubjectsinthenetwork whichwecallthetargetset inordertomaximizethenumberofinﬂuencedsubjects.Weassumethateachmemberinthetargetsetcaninﬂuenceallofherneighbors.Underthisassumption thesubmodularobjectivefunctionisf(S)=(cid:12)(cid:12)Su∈S(N(u)∪{u})(cid:12)(cid:12) whereN(u)isthesetofallneighborsofsubjectu.Allthebaselines exceptGREEDY havenoknowledgeoftheunderlyingFacebooknetworkortheobjectivefunction.TheyareonlygiventhefeaturevectorofeachsubjectobtainedviatheNODE2VECalgorithm[21].ThekernelfunctionksubjectbetweentwosubjectsisalinearkernelwhilethekernelfunctionbetweensubsetsofsubjectsistheJaccardkernel.TheresultsareshowninFig.1(c).Again SM-UCBreachesthelargestinﬂuencew.r.totherbaselinesexceptforGREEDY.Weranthesameideaoverthe6-nearestneighbornetworkofrandomlysampled150studentsfromUserKnowledgeModellingDataset[27].AsFig.1(d)indicates asimilarpatternemerges.NewsRecommendationForthisexperiment weusetheYahoo!WebscopedatasetR6A2.Thedatasetprovidesalistofrecords eachcontainingatimestamp auserID anewsarticleIDandaBooleanvaluethatindicateswhethertheuserclickedonthenewsarticlethatwaspresentedtoher.Thefeaturevectorsoftheusersandthearticlesarealsoprovided.Weusek-meansclusteringtoclusterusersinto175groupsandidentifyusersofthesamegroupasidenticalusers.WeformamatrixMwhose(i j)-entryisthetotalnumberoftimesthatusericlickedonarticlej.Thismatrixquantiﬁeseachuser’spreferencesregardingnewsarticles.Theobjectivefunctionforuseriisdeﬁnedasfφi(Si)=maxj∈SiMij.Thecollectiveobjectivefunctionfisdeﬁnedasthesumoftheobjectivefunctionsofallusers.Fromthetimestamps wecaninfertheorderinwhichtheusersarrive.WeusetheLaplaciankernelsknews:Ω×Ω→Randkuser:Φ×Φ→Rforpairsofpiecesofnewsandpairsofusers respectively.ForapairofsubsetsofnewsSandT thekernelfunctionbetweenthemisagaintheJaccardkernel.Thecompositekernelk:(Ω×2Ω×Φ)×(Ω×2Ω×Φ)→Risdeﬁnedasκ1knews⊕κ2ksubset⊕κ3kuser.TheresultsareillustratedinFig.1(e).Thehorizontalaxisisthenumberofarrivinguserswhiletheverticalaxisisthevalueofthecollectiveobjectivefunction.Again weobservethatSM-UCBoutperformsallothermethodsexceptGREEDY.PersonalizedDataSummarizationForthisexperiment weapplylatentDirichletallocation(LDA)totheReutersCorpus.Thenumberoftopicsissettontopic=10.LDAreturnsatopicdistributionP(i|a)foreacharticleaandtopici.SupposethatAisasubsetofarticles.ProbabilisticcoveragefunctionquantiﬁesthedegreetowhichasetofarticlesAcoversatopici[16] andisgivenbyFi(A)=1−Qa∈A(1−P(i|a)).Eachuserjischaracterizedbyherntopic-dimensionalpreferencevectorwj=(wj 1 wj 2 wj 3 ... wj ntopic);weassumethatthepreferencevectorisL1-normalized i.e. itsentriessumto1.Thepersonalizedprobabilisticcoveragefunctionforuserjisdeﬁnedasfj(A)=Pntopici=1wj iFi(A)[16 50].NotethatsincethepreferencevectorisL1-normalizedandFi(A)≤1 wehavefj(A)≤1foranyj.Thetotalaveragecoveragefunctionisf(A)=1nuserPnuserj=1fj(A) wherenuser=10isthenumberofusers.Randomorderofuserarrivalsissimulated.WeusethelinearkernelforpairsofusersandpairsofarticlesandusetheJaccardkernelbetweensubsetsofarticles.TheresultsareshowninFig.1(f).Thehorizontalaxisisthenumberofuserarrivalswhiletheverticalaxisisthetotalaveragecoveragefunctionf(A) whichcharacterizestheaveragefractionofcoveredtopics.WeobservethatSM-UCBoutperformsallthebaselinesotherthanGREEDY.DiscussionRecallthattheRKHSisacompletesubspaceoftheL2spaceoffunctionsdeﬁnedontheproductoftheitemset itspowerset andthecontextset.Ithasaninnerproduct(· ·)kobeyingthereproducingproperty:(f k(x ·))k=f(x)forallfinRKHS.Functionsimpliedbyaparticularkernelkarealwaysoftheformf(x)=Piαik(xi x).Theboundednormimpliesthatαivanishquicklyenough.WithuniversalkernelslikeGaussian/Laplaciankernels suchfunctionsaredense(accordingtosup-norm)inthespaceofcontinuousfunctions.Inthreesetsofexperiments(movierecommendation inﬂuencemaximization datasummarization)weusedthelinearandcosinekernelsforitemsandusers andtheJaccardkernelforsubsetsofitems.Infact theJaccardkernelisawidelyusedmetricthatquantiﬁesthesimilaritybetweensubsetsofselecteditems.Moreover thelinearandcosinekernelsbetweenitemsanduserscapturethesimplestformofinteractions.Incontrasttothetheabovethreeexperiments inthenewsrecommendation2http://webscope.sandbox.yahoo.com/8application wechosetheLaplaciankernelforthefollowingreason.Thefeaturesprovidedinthedatasethavehighlyheterogeneousnorms.Ifweusethelinearkernel theinnerproductbetweenashortvectorandaclose-byvectorwithasmallnormwillbeeasilydominatedbytheinnerproductwithavectorwithalargenorm.WeusedtheLaplaciankerneltocircumventthisproblemandputmoreweightonnearbyvectorseveniftheyhavesmallnorms.5RelatedWorkOriginally Aueretal.[2]proposedUCBpoliciesforthemulti-armedbandit(MAB)problemwhichexhibitstheexploration-exploitationtradeoffandachievesanO(√T)regret.Intheliterature therearemanyvariantsofthemulti-armedbanditproblemandcorrespondingsolutions forexample EXP3algorithmforadversarialbandits[3] LINUCBforstochasticcontextualbandits[36 12] andafamilyofUCB-basedpoliciesforinﬁnitelymany-armedbandit[49].Chenetal.[11]consideredthecombinatorialMABproblemwheretheunitofplayisasuperarmandbasearmscanbeprobabilisticallytriggered.Foracomprehensivesurveyonbanditproblems werefertheinterestedreaderto[9].Srinivasetal.[44]studiedtheGaussianprocess(GP)optimizationprobleminthebanditsetting.TheyassumedthattheobjectivefunctionfiseithersampledfromaGaussianprocessorresidesinareproducingkernelHilbertspace(RKHS).GivenasubsetofitemsS⊆Ω thetotalutilityisPx∈Ωf(x).UndereithertheGPmodelortheRKHSassumption theyshowedthattheirproposedGP-UCBalgorithmachievesanO(√T)regretbound.Itisnoteworthytomentionthattheirboundalsoreliesonthemaximuminformationgain.Basedon[44] KrauseandOng[31]furtherinvestigatedthecontextualGuassianprocessbanditoptimizationandtheirproposedalgorithmCGP-UCBachievesasimilarregretbound.Linetal.[37]addressedanonlinelearningproblemwheretheinputtothegreedyalgorithmisstochasticwithunknownparametersandthealgorithmreceivessemi-banditfeedbacks.Theiralgorithmcanalsobeappliedtosubmodularfunctions.However thereareseveralmajordifferencesbetweentheirworkandours:Firstly theyassumethattheobjectivefunctionsaredrawnfromapredeterminedbutunknowndistribution whileourworkappliestoanysetofsubmodularfunctions;secondlytheyassumeboundedsubmodularfunctionswhilewehavenosuchassumptions;thirdly theirworkdidnothavethenotionofcontext.Theyoptimizetheexpectedobjectivefunctionwhileweoptimizeobjectivefunctionswithdifferentcontextssimultaneously.StreeterandGolovin[45]studiedtheonlinemaximizationproblemofsubmodularfunctions.YueandGuestrin[50]studiedthelinearsubmodularbanditproblemwheretheyassumedthattheunknownsubmodularfunctionisalinearcombinationofmultipleknownsubmodularfunctions.Theonlyuncertaintyintheirsettingistheunknownpositivecoefﬁcientsofeachknownsubmodularfunction.TheyproposedLSBGREEDYthatachievesasimilarO(√T)regretbound.Beyondunconstrainedsequentialdecisionproblems Zhouetal.[52]consideredonlinemaximizationoflistsubmodularfunctionsunderaknapsackconstraint.Ourkeycontributioninthispaperisthatthenotionofcontextualregretthatweboundismuchmorechallengingthanthetypicalnotion:Ouractionsareaffectingthefuturecontextsexperienced andwecompetewithpoliciesthatareawareofthisfactandcanplanforit.Thisisqualitativelydifferentfromanyprioranalysis.Morespeciﬁcally weneedtobuildupasubsetofitems/actionsasweencounteravaluationfunctionmultipletimes.Thisisanon-trivialtaskasnotonlythefunctionsareunknown themarginalgainsarealsonoisy.Moreover thechoiceswemakecanaffectthefuture.Ourpositiveresultscanbeseeninlightofveryrecentnegativeresultsin[23]thatindicatessubmodularoptimizationishardwhenfunctionevaluationsarenoisy.WeshowthattheUCB-basedalgorithmcanbenaturallycombinedwiththegreedyselectionpolicytoprovidesublinearregret.Tothebestofourknowledgetheanalysisisnew.AcknowledgementsThisresearchwassupportedbyDARPAYoungFacultyAward(D16AP00046) grantSCADAPTandERCStG.9References[1]HassanAshtiani ShrinuKushagra andShaiBen-David.Clusteringwithsame-clusterqueries.InNIPS pages3216–3224 2016.[2]PeterAuer NicoloCesa-Bianchi andPaulFischer.Finite-timeanalysisofthemultiarmedbanditproblem.Machinelearning 47(2-3):235–256 2002.[3]PeterAuer NicoloCesa-Bianchi YoavFreund andRobertESchapire.Thenonstochasticmultiarmedbanditproblem.SIAMjournaloncomputing 32(1):48–77 2002.[4]PranjalAwasthi Maria-FlorinaBalcan andKonstantinVoevodski.Localalgorithmsforinteractiveclustering.InICML pages550–558 2014.[5]AshwinkumarBadanidiyuru ChristosPapadimitriou AviadRubinstein LiorSeeman andYaronSinger.Locallyadaptiveoptimization:Adaptiveseedingformonotonesubmodularfunctions.InSODA pages414–429 2016.[6]Maria-FlorinaBalcan AndreiBroder andTongZhang.Marginbasedactivelearning.InCOLT pages35–50.Springer 2007.[7]Maria-FlorinaBalcan AlinaBeygelzimer andJohnLangford.Agnosticactivelearning.JournalofComputerandSystemSciences 75(1):78–89 2009.[8]GuillermoBarrenetxea FrançoisIngelrest GunnarSchaefer andMartinVetterli.Thehitch-hiker’sguidetosuccessfulwirelesssensornetworkdeployments.InACMSenSys pages43–56 2008.[9]SébastienBubeck NicoloCesa-Bianchi etal.Regretanalysisofstochasticandnonstochasticmulti-armedbanditproblems.FoundationsandTrendsR(cid:13)inMachineLearning 5(1):1–122 2012.[10]LinChen SeyedHamedHassani andAminKarbasi.Near-optimalactivelearningofhalfspacesviaquerysynthesisinthenoisysetting.InAAAI pages1798–1804 2017.[11]WeiChen YajunWang YangYuan andQinshiWang.Combinatorialmulti-armedbanditanditsextensiontoprobabilisticallytriggeredarms.JMLR 17(1):1746–1778 2016.[12]WeiChu LihongLi LevReyzin andRobertESchapire.Contextualbanditswithlinearpayofffunctions.InAISTATS volume15 pages208–214 2011.[13]DavidACohn ZoubinGhahramani andMichaelIJordan.Activelearningwithstatisticalmodels.InNIPS pages705–712 1995.[14]SanjoyDasgupta.Analysisofagreedyactivelearningstrategy.InNIPS pages337–344 2005.[15]SanjoyDasgupta DanielJHsu andClaireMonteleoni.Ageneralagnosticactivelearningalgorithm.InNIPS pages353–360 2008.[16]KhalidEl-Arini GauravVeda DafnaShahaf andCarlosGuestrin.Turningdownthenoiseintheblogosphere.InACMSIGKDD pages289–298 2009.[17]UrielFeige.Athresholdoflnnforapproximatingsetcover.JournaloftheACM 45(4):634–652 1998.[18]ThomasGärtner.Kernelsforstructureddata volume72.WorldScientiﬁc 2008.[19]DanielGolovinandAndreasKrause.Adaptivesubmodularity:Theoryandapplicationsinactivelearningandstochasticoptimization.JAIR 42:427–486 2011.[20]ManuelGomez-Rodriguez LeSong NanDu HongyuangZha andB.Schoelkopf.Inﬂuenceestimationandmaximizationincontinuous-timediffusionnetworks.ACMTOIS 2016.[21]AdityaGroverandJureLeskovec.node2vec:Scalablefeaturelearningfornetworks.InACMSIGKDD pages855–864 2016.10[22]AndrewGuilloryandJeffBilmes.Interactivesubmodularsetcover.InICML Haifa Israel 2010.[23]AvinatanHassidimandYaronSinger.Submodularoptimizationundernoise.InCOLT vol-ume65 pages1069–1122 2017.[24]ThomasHofmann BernhardSchölkopf andAlexanderJSmola.Kernelmethodsinmachinelearning.Theannalsofstatistics pages1171–1220 2008.[25]RuizhangHuangandWaiLam.Anactivelearningframeworkforsemi-superviseddocumentclusteringwithlanguagemodeling.Data&KnowledgeEngineering 68(1):49–67 2009.[26]ShervinJavdani YuxinChen AminKarbasi AndreasKrause DrewBagnell andSiddharthaSSrinivasa.Nearoptimalbayesianactivelearningfordecisionmaking.InAISTATS pages430–438 2014.[27]HTolgaKahraman SerefSagiroglu andIlhamiColak.Thedevelopmentofintuitiveknowledgeclassiﬁerandthemodelingofdomaindependentdata.Knowledge-BasedSystems 37:283–295 2013.[28]AminKarbasi StratisIoannidis andlaurentMassoulie.Comparison-basedlearningwithranknets.InICML pages855–862 2012.[29]DavidKempe JonKleinberg andÉvaTardos.Maximizingthespreadofinﬂuencethroughasocialnetwork.InACMSIGKDD pages137–146 2003.[30]AndreasKrauseandDanielGolovin.Submodularfunctionmaximization.Tractability:Practi-calApproachestoHardProblems 3(19):8 2012.[31]AndreasKrauseandChengSOng.Contextualgaussianprocessbanditoptimization.InNIPS pages2447–2455 2011.[32]AndreasKrause CarlosGuestrin AnupamGupta andJonKleinberg.Near-optimalsensorplacements:Maximizinginformationwhileminimizingcommunicationcost.InACMIPSN pages2–10 2006.[33]AndreasKrause AjitSingh andCarlosGuestrin.Near-optimalsensorplacementsingaussianprocesses:Theory efﬁcientalgorithmsandempiricalstudies.JMLR 9(Feb):235–284 2008.[34]SiyuLei SilviuManiu LuyiMo ReynoldCheng andPierreSenellart.Onlineinﬂuencemaximization.InACMSIGKDD pages645–654 2015.[35]JureLeskovecandJulianJMcauley.Learningtodiscoversocialcirclesinegonetworks.InNIPS pages539–547 2012.[36]LihongLi WeiChu JohnLangford andRobertESchapire.Acontextual-banditapproachtopersonalizednewsarticlerecommendation.InWWW pages661–670.ACM 2010.[37]TianLin JianLi andWeiChen.Stochasticonlinegreedylearningwithsemi-banditfeedbacks.InNIPS pages352–360 2015.[38]TylerLu DávidPál andMartinPál.Contextualmulti-armedbandits.InAISTATS pages485–492 2010.[39]BaharanMirzasoleiman AshwinkumarBadanidiyuru andAminKarbasi.Fastconstrainedsubmodularmaximization:Personalizeddatasummarization.InICML volume48 pages1358–1367 2016.[40]BaharanMirzasoleiman MortezaZadimoghaddam andAminKarbasi.Fastdistributedsub-modularcover:Public-privatedatasummarization.InNIPS pages3594–3602 2016.[41]GeorgeLNemhauserandLaurenceAWolsey.Bestalgorithmsforapproximatingthemaximumofasubmodularsetfunction.Mathematicsofoperationsresearch 3(3):177–188 1978.11[42]LiorSeemanandYaronSinger.Adaptiveseedinginsocialnetworks.InFOCS pages459–468 2013.[43]BurrSettles.Activelearningliteraturesurvey.UniversityofWisconsin Madison 52(55-66):11 2010.[44]NiranjanSrinivas AndreasKrause ShamKakade andMatthiasSeeger.Information-theoreticregretboundsforgaussianprocessoptimizationinthebanditsetting.IEEETransactionsonInformationTheory 58(5):3250–3265 May2012.[45]MatthewStreeterandDanielGolovin.Anonlinealgorithmformaximizingsubmodularfunctions.InNIPS pages1577–1584 2009.[46]SimonTongandDaphneKoller.Supportvectormachineactivelearningwithapplicationstotextclassiﬁcation.JMLR 2(Nov):45–66 2001.[47]HastagiriVanchinathan AndreasMarfurt Charles-AntoineRobelin DonaldKossmann andAndreasKrause.Discoveringvaluableitemsfrommassivedata.InACMSIGKDD 2015.[48]S.I.Wang P.Liang andC.Manning.Learninglanguagegamesthroughinteraction.InACL 2016.[49]YizaoWang JeanyvesAudibert andRémiMunos.Algorithmsforinﬁnitelymany-armedbandits.InNIPS pages1729–1736.2009.[50]YisongYueandCarlosGuestrin.Linearsubmodularbanditsandtheirapplicationtodiversiﬁedretrieval.InNIPS pages2483–2491 2011.[51]YuanxingZhang YichongBai LinChen KaiguiBian andXiaomingLi.Inﬂuencemaximiza-tioninmessenger-basedsocialnetworks.InGLOBECOM pages1–6.IEEE 2016.[52]JiajiZhou StephaneRoss YisongYue DebadeeptaDey andJAndrewBagnell.Knapsackconstrainedcontextualsubmodularlistpredictionwithapplicationtomulti-documentsumma-rization.InInInferningWorkshopatICML.Citeseer 2013.12,Lin Chen
Andreas Krause
Amin Karbasi
Soheil Kolouri
Kimia Nadjahi
Umut Simsekli
Roland Badeau
Gustavo Rohde