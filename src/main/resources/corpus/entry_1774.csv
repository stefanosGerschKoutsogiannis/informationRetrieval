2019,Efficient characterization of electrically evoked responses for neural interfaces,Future neural interfaces will read and write population neural activity with high spatial and temporal resolution  for diverse applications. For example  an artificial retina may restore vision to the blind by electrically stimulating retinal ganglion cells. Such devices must tune their function  based on stimulating and recording  to match the function of the circuit. However  existing methods for characterizing the neural interface scale poorly with the number of electrodes  limiting their practical applicability. This work tests the idea that using prior information from previous experiments and closed-loop measurements may greatly increase the efficiency of the neural interface. Large-scale  high-density electrical recording and stimulation in primate retina were used as a lab prototype for an artificial retina. Three key calibration steps were optimized: spike sorting in the presence of stimulation artifacts  response modeling  and adaptive stimulation. For spike sorting  exploiting the similarity of electrical artifact across electrodes and experiments substantially reduced the number of required measurements. For response modeling  a joint model that captures the inverse relationship between recorded spike amplitude and electrical stimulation threshold from previously recorded retinas resulted in greater consistency and efficiency. For adaptive stimulation  choosing which electrodes to stimulate based on probability estimates from previous measurements improved efficiency. Similar improvements resulted from using either non-adaptive stimulation with a joint model across cells  or adaptive stimulation with an independent model for each cell. Finally  image reconstruction revealed that these improvements may translate to improved performance of an artificial retina.,Efﬁcient characterization of electrically evoked

responses for neural interfaces

Nishal P. Shah ∗
Stanford University

Sasidhar Madugula
Stanford University

Pawel Hottowy

AGH University of Science and Technology

Alexander Sher

University of California  Santa Cruz

Alan Litke

University of California  Santa Cruz

Liam Paninski

Columbia University

E.J. Chichilnisky
Stanford University

Abstract

Future neural interfaces will read and write population neural activity with high
spatial and temporal resolution  for diverse applications. For example  an artiﬁcial
retina may restore vision to the blind by electrically stimulating retinal ganglion
cells. Such devices must tune their function  based on stimulating and recording  to
match the function of the circuit. However  existing methods for characterizing the
neural interface scale poorly with the number of electrodes  limiting their practical
applicability. This work tests the idea that using prior information from previous
experiments and closed-loop measurements may greatly increase the efﬁciency of
the neural interface. Large-scale  high-density electrical recording and stimulation
in primate retina were used as a lab prototype for an artiﬁcial retina. Three key
calibration steps were optimized: spike sorting in the presence of stimulation arti-
facts  response modeling  and adaptive stimulation. For spike sorting  exploiting
the similarity of electrical artifact across electrodes and experiments substantially
reduced the number of required measurements. For response modeling  a joint
model that captures the inverse relationship between recorded spike amplitude and
electrical stimulation threshold from previously recorded retinas resulted in greater
consistency and efﬁciency. For adaptive stimulation  choosing which electrodes to
stimulate based on probability estimates from previous measurements improved ef-
ﬁciency. Similar improvements resulted from using either non-adaptive stimulation
with a joint model across cells  or adaptive stimulation with an independent model
for each cell. Finally  image reconstruction revealed that these improvements may
translate to improved performance of an artiﬁcial retina.

Introduction

1
Recent advances in large-scale electrical and optical recording have made it possible to record and
stimulate neural circuits at unprecedented scale and resolution [Jun et al.  2017  Kipke et al.  2008 
Kerr and Denk  2008  Stosiek et al.  2003]. These advances suggest the possibility of using electronic
devices to restore functions lost to disease  or to augment human capacities [Wilson et al.  1991 
Schwartz  2004]. One such application is an artiﬁcial retina  which can provide a treatment for
incurable blindness by electrically stimulating retinal ganglion cells  the output neurons of the retina
[Stingl et al.  2013  Humayun et al.  2012  Lorach et al.  2015]. A high-ﬁdelity device must encode a
visual scene by electrically stimulating retinal neurons in a way that produces accurate and useful
visual perception (Figure 1A).

∗Code: https://github.com/Chichilnisky-Lab/shah-neurips-2019

33rd Conference on Neural Information Processing Systems (NeurIPS 2019)  Vancouver  Canada.

However  to achieve this goal  the device must control the precise  asynchronous patterns of activity
transmitted by multiple ganglion cell types to the brain. This will require ﬁrst identifying the location
and type of many individual ganglion cells in the patient’s retina  then characterizing their responses
to electrical stimulation. Previously  it has been shown that the location and types of individual retinal
ganglion cells can be identiﬁed using recorded activity [Richard et al.  2015]. However  efﬁcient
characterization of electrical responses remains unsolved.
For example  in ex vivo experiments with primate retina  intended as a lab prototype for an artiﬁcial
retina  characterization of neural response to stimulation of each of 512 electrodes individually
(to avoid nonlinear interactions) requires about an hour  and scales linearly with the number of
electrodes. Thus  with the advent of arrays that can stimulate thousands of electrodes [Dragas et al. 
2017] with multi-electrode current patterns [Fan et al.  2018]  naive response calibration may be too
time-consuming for the clinic.

Figure 1: (A) Functional components of a retinal prosthesis. (B) Different steps in adaptive character-
ization of electrical response properties.
In the present work  new methods are proposed to efﬁciently characterize the electrical stimulation
properties of a retinal interface  in a manner that may extend to other neural systems. Three novel
steps are presented to calibrate the interface  based on the voltage recorded in response to electrical
stimulation (Figure 1B):

• Spike sorting in the presence of electrical artifact: We develop a novel approach to
estimate electrical artifacts  a key hurdle in spike sorting [Mena et al.  2017]  in a subspace
identiﬁed from past experimental data.
• Response modeling: We develop a model of electrical response properties of the target
cells; this model incorporates as a prior the observed relationship between recorded spike
amplitude and the threshold for electrical stimulation of a cell on a given electrode  from
past experimental data.
• Adaptive stimulation: Inspired by previous work [Lewi et al.  2009  Shababo et al.  2013] 
we develop a method to exploit the data already recorded from a retina to optimize the
choice of stimulation patterns for the next batch of measurements.

Finally  to make these methods most relevant for artiﬁcial vision  a modiﬁcation is presented that
minimizes error in the reconstructed visual stimulus  a more meaningful indicator of performance
than the recorded spike counts.
Below  each algorithm is described separately in detail  with the results presented in aggregate after.
Note that for simplicity  distinct notation is used for each algorithm; this notation is deﬁned in the
beginning of each section.
2 Spike sorting in the presence of stimulation artifacts
The goal of spike sorting is to identify spikes ﬁred in response to electrical stimulation  and to distin-
guish spikes produced by different neurons. Spike sorting in the presence of electrical stimulation
is difﬁcult because the recorded spike voltages are corrupted by large stimulation artifacts with
magnitude and duration comparable to those of the spike waveforms (see for [Mena et al.  2017] for
examples). Hence  artifacts must be subtracted before identifying spikes. After artifact subtraction 
spikes are identiﬁed based on waveforms previously recorded in the absence of electrical stimulation.
Previous work from [O’Shea and Shenoy  2018] estimated the stimulation artifact by exploiting
the artifact similarity for a given stimulation electrode  across different pulses  trials and recording

2

ABdecodingencodingelectrical responsestarget electrical stimulation neural responses perceptionspike sortingresponse modelingadaptive stimulationelectrodes  but did not assign spikes to cells. [Mena et al.  2017] used previously recorded spike
waveforms to jointly estimate the cellular activity and artifacts  assuming a smooth change in artifact
with increasing currents. In comparison  this work identiﬁes spikes by exploiting artifact similarity
across stimulating electrodes and experiments  eliminating the need to track and separate spikes and
artifact over a range of current levels  substantially reducing data requirements.
Let (cid:126)ya r ∈ RL be the L dimensional recorded data on electrode r when the stimulating electrode
has amplitude a (L is the number of timesteps considered following the electrical stimulus). Using
the artifacts estimated by applying the algorithm in [Mena et al.  2017] on previous experiments 
an n dimensional subspace Aa d(r e) ∈ RL×n is estimated for each stimulation amplitude (a) and
distance d(r  e) between the recording and stimulating electrodes. Hence the artifact is modeled as
Aa d(r e)(cid:126)ba r  with (cid:126)ba r ∈ Rn estimated from the recorded data.
Let (cid:126)xc a ∈ {0  1}L be the spiking activity of cell c and Wc r ∈ RL×L be the Toeplitz matrix
consisting of shifted copies of a previously identiﬁed spike waveform on electrode r. Each neuron has
at most one spike during the recording interval after stimulation  and the amplitude is exactly 1 when
it spikes. This constraint is incorporated approximately by a softmax parameterization of (cid:126)xc a with
an auxillary parameter qc a allowing for the possibility of no spike and temperature τ determining the
quality of approximation. Since neurons ﬁre sparsely  an L1 norm penalty is applied on xc a as well.
The artifact parameters (cid:126)b and spike assignments (cid:126)x are estimated by minimizing the penalized
reconstruction error (Lspike-sort) for a particular stimulating electrode e  the recorded voltage traces on
multiple recording electrodes  and all the stimulating amplitudes simultaneously:

(cid:88)
c (cid:107)(cid:126)xc a(cid:107)1.

Wc r(cid:126)xc a)(cid:107)2

2 + λL1

(1)

(cid:88)

a

(cid:88)
r (cid:107)(cid:126)ya r − (Aa d(r e)(cid:126)ba r +

(cid:88)

c

Lspike-sort =

For the results presented here  L = 55  n = 9  and cells with large amplitude on the stimulating
electrode were used for spike sorting (roughly 10 cells per electrode). See Results and Appendix for
details.

3 Response modeling
Given the spikes recorded in response to electrical stimulation  the goal of response modeling is
to estimate the activation probability for each cell and electrode pair. The standard method  which
involves estimating the response probability for each cell-electrode pair independently is presented
ﬁrst  followed by a joint model that incorporates priors from previous experiments.
n=1 are
For estimating these models  N samples of electrical stimulus-response pairs {en  an  cn}n=N
given  with stimulating electrode en ∈ {1 ···   Ne}  activated cell cn ∈ {1 ···   Nc}  and current
level an ∈ {1 ···   Na}.
3.1
Independent model
This model assumes that there is no consistent relationship between recorded spikes and stimulation
threshold across cell-electrode pairs. Thus  for each sample  the spiking probability is modeled as
a Bernoulli distribution P (Rn = 1) := γen an cn =
1+e−(pen  cn (an−qen cn ))   where pen cn   qen cn
are the parameters of the sigmoidal activation curve for the stimulating electrode en and cell cn.
The parameters are inferred independently by using standard methods for maximizing the logistic
log-likelihood for each cell electrode pair.

1

Joint model

3.2
Using prior data on the relationship between recording and stimulation from previously recorded
retinas could lead to more efﬁcient characterization of activation probabilities. Previous work
[Madugula et al.  2017] suggests that for a given electrode  the recorded spike amplitude and the
stimulation threshold are inversely related. The inverse relationship lies on different curves for axonal
and somatic activation due to differences in channel density and geometry (Figure 3A). This section
presents a model that jointly models this relationship across multiple cell-electrode pairs.
In the model  the activation threshold qe c is related to the spike amplitude (Ee c) using a reciprocal
relationship  different for somatic or axonal activation (Te c) but common for all cell-electrode pairs

3

in a given retina (Equation 2). A Gaussian prior on the parameters of the reciprocal relationship (x  y)
is derived from previously recorded retinas (Equation 3  see Results):

qe c ∼ N (xTe c +

yTe c
Ee c

  ν2)

{xT   yT} ∼ N (µT   ΣT ); T ∈ {soma  axon}.

Hence  the parameters of the model are given by
Θ = {{pe c  qe c}e=Ne c=Nc
and the resulting model likelihood (Lmodel) given by

e=1 c=1

;{xj  yj}j∈{soma axon}  ν}

(2)

(3)

(4)

(5)

Lmodel = ΠnP (Rn|an; pen cn   qen cn )Πe cP (qe c|Ee c; xTe c   yTe c  νTe c )

Πi∈{soma axon}P (xi  yi|µi  Σi).
n=1 ). ν is learned but
The goal is to estimate the posterior over the parameters P (Θ|{Rn  en  an  cn}n=N
non-random  and other parameters are estimated by variational approximation of the posterior [Blei
et al.  2017  Wainwright et al.  2008]. The posterior is approximated using a Gaussian mean-ﬁeld
variational distribution. This approximation is estimated by maximizing the evidence lower bound
(ELBO) on the log-likelihood using the reparametrization trick [Kingma and Welling  2013]. See
Appendix for details.
4 Adaptive stimulation
In this section  the goal is to develop an algorithm that uses responses from prior stimulation within
a retina to choose subsequent stimulation patterns  in closed loop. Since real-time closed loop
experiments are generally not feasible using existing hardware  the experiment is assumed to run in
multiple phases  with the algorithm choosing the entire collection of current patterns to stimulate in
the next phase. The ﬁrst phase is non-adaptive: each electrode and amplitude is stimulated T times 
for a total of NeNaT . In subsequent phases  parameter estimates from earlier phases are used to
allocate a total of NeNaT stimuli unevenly across electrodes and amplitudes.
The number of stimuli for each electrode and amplitude  Te a ∈ Z+  is computed by minimizing a loss
function L  that depends on the estimation accuracy of the stimulation probabilities. In this paper  the
loss function is chosen as total variance in the estimate of response probability across electrodes and
e a c var(γe a c)  where var(γe a c) denotes the variance in estimate of activation
probability. This condition is identical to A-optimality in optimal design literature [Atkinson et al. 
2007]  departing from the commonly used information-theoretic methods in neuroscience [Lewi
et al.  2009  Paninski et al.  2007]; since the stimulation algorithms considered here choose only
one electrode-amplitude combination at a time (Section 5)  it is not necessary to account for the
dependence of estimation error between different probabilities as in D-optimality.
For adaptively choosing the stimulations  the estimation error in response probabilities γe a after
Te a additional stimulations must be computed. Given the variance in estimate of the sigmoid
parameters (θe c)  the error in probabilities at individual current levels is given using Taylor expansion
e a c  where f(cid:48) is the sigmoid derivative. If T (cid:48)
e a are the number
as var(γe a c) ≈ f
of previous stimulations  the variance of sigmoid parameters after (Te a + T (cid:48)
e a) stimulations is
approximated using the inverse of the resulting Fisher information I(θ)−1. More concretely  the
asymptotic variance of maximum likelihood estimate ˆθ is related to the inverse Fisher information
computed using true parameter θ. However as θ is unknown  the inverse Fisher information is
approximated using the estimated parameters I(ˆθe c). The resulting optimization problem is:

amplitudes L =(cid:80)

e a cvar(θe c)f(cid:48)
(cid:48)T

(cid:88)

(cid:48)T
e a c[I(ˆθe c)]
f

−1f

(cid:48)
e a c

Ladapt-stim =

Te a

minimize

subject to (cid:88)

e a c

(6)

Te a ≤ NeNaT 

Te a ≥ 0 ∀e  a.

e a

A soft-max representation of Te a is used to minimize the unconstrained problem and the ﬁnal
approximate solution is quantized to give an exact (integer) solution (full details in Appendix).

4

5 Evaluation for artiﬁcial retina application

To optimize and evaluate these techniques in a manner that most accurately captures the function of
an artiﬁcial retina  a metric for approximating the expected impact on visual function is developed.
Recent work [Shah et al.  2019] proposed that the perception from a collection of current patterns
may be added linearly when they are combined by sequential stimulation at a rate faster than visual
integration times. The stimulation sequence is chosen such that the response to each stimulation
pattern is independent  and the ﬁnal perception depends only on the total number of spikes generated in
a temporal integration window. In this framework  the contribution of response probability estimation
error from each cell-electrode pair to the accuracy of perception is estimated. Let Rγ denote the
observed spike response  given that the spiking probability is γ. When (cid:126)dc denotes the linear decoding
ﬁlter associated with activation of cell c  the cell’s contribution to perception is given by (cid:126)dcRγ. The
expected change in perception when the cell response is generated by estimated probability ˆγ instead
of the true probability γ is given by Eˆγ R(cid:107) (cid:126)dc(Rˆγ − Rγ)(cid:107)2 = (cid:107)(cid:126)dc(cid:107)2(var(Rˆγ) + var(Rγ) + var(ˆγ)) 
assuming Rγ and Rˆγ are independent. The effect of inaccurate response probability estimation is
mainly accounted for by the last term: (cid:107) (cid:126)dc(cid:107)2var(ˆγ).
In section 6.4  the performance for the retinal prosthesis application is evaluated using the above mea-
sure. The variance is either computed from the independent response model or the variational approx-
imation of the joint response model. For adaptive stimulation  the optimization problem in Equation
2var(ˆγe a c).

6 is modiﬁed by weighing each term by the strength of the decoder(cid:80)

(cid:80)

(cid:80)
c (cid:107)dc(cid:107)2

e

a

6 Results
Extracellular recording and stimulation of primate retinal ganglion cells ex vivo using a 512-electrode
technology [Litke et al.  2004  Frechette et al.  2005] were used to evaluate the performance of the
algorithms. First  recorded voltages from 30 minutes of visual stimulation were spike sorted using
custom software. The estimated spatio-temporal spike waveform for each cell was identiﬁed by
averaging the recorded voltage waveforms over thousands of recorded spikes. Spike amplitude was
measured on each electrode as the maximum negative voltage deviation  and spike shape was used
to determine if the electrode was recording from the soma (biphasic waveform) or axon (triphasic
waveform). Subsequently  electrical stimulation experiments were performed [Jepson et al.  2013]
by passing brief (∼ 0.1ms)  weak (∼ 1µA)) current pulses repeatedly through each electrode
individually to identify the probability of eliciting a spike.

Figure 2: Spike sorting (A) Artifact recorded for a 0.68µA triphasic current pulse  on electrodes at
different distances on a 60µm hexagonal grid. Lines in same column correspond to artifacts from
different retinal preparations but the same electrode  lines with the same color indicate recordings
from different pieces of retina from the same animal. (B) Comparison of estimated current index
for 50% spiking probability for the algorithm (y-axis) and manual analysis (x-axis) for the new
method (red) and the simpliﬁed method from Mena et al. [2017] (baseline  blue). Each of the 241
dots represents a cell-electrode pair. (C) Comparison of spike sorting results on 5 trials  when the
5 trials were analyzed independently  and as part of a total of 24 trials. Histogram across multiple
cell-electrode pairs for the new method (red) and a simple form of a previous approach (blue) [Mena
et al.  2017].

5

BACelec 1elec 2elec 1elec 2elec 1elec 20 micronsretinas01020304005101520253035400102030400510152025303540manual analysis (current index)algorithm (current index)new methodbaseline60 microns120 micronsdistancesfraction of trials with matched results between 5 and 24 trialsnew methodbaseline10-210-11001010.40.50.60.70.80.91.0number of cell-electrode pairs (log10)comparison of activation tresholdrobustness to fewer trialsartifact similarity 6.1 Spike sorting in the presence of stimulation artifacts
The performance of spike sorting was evaluated with voltage traces recorded in response to repeated
electrical stimulation. For each of the recorded traces  stimulation artifacts were estimated by applying
the simpliﬁed algorithm previously proposed in [Mena et al.  2017]. Brieﬂy  the artifact estimate is
initialized to the results obtained with a lower current amplitude  and then is updated by iterating
between greedy spike estimation and artifact estimation. The estimated artifacts for different relative
locations of stimulating and recording electrodes  across multiple experiments  are shown in Figure
2A. For a given stimulation current and a ﬁxed distance between stimulating and recording electrodes 
the artifact was similar across different stimulating electrodes  and across recordings.
Improved spike sorting was therefore implemented using the reduced space to regularize the artifact
estimates. Performance was tested on the responses of one retina  with the artifact waveform
basis estimated from a 9-dimensional approximation of data from 22 recordings (>99% of variance
explained; see Appendix  Figure 6). Analysis of 24 repetitions for each electrode and amplitude
revealed that the estimated activation threshold (current value that elicits a spike with probability
0.5) matched the value obtained with human analysis to within 67% in 161/ 241 of cell-electrode
pairs (Figure 2B  left). In some cases the algorithm produced higher thresholds than the human  and
vice-versa  but no large overall bias was observed. These results were comparable to the value of
173/241 of pairs obtained with the baseline method (Figure 2B  right). Thus  the new and baseline
methods exhibited similar accuracy. To test whether the new method showed improved efﬁciency 
both algorithms were applied in two cases: using 5 trials  or 24 trials  per stimulation pattern. The
new approach resulted in greater consistency: spike times identiﬁed using fewer trials matched the
spike times identiﬁed using more trials more closely than with the baseline method (Figure 6C) Thus 
incorporating priors on artifact waveforms across recordings can allow for effective spike detection
with limited data.
6.2 Response modeling

Figure 3: Response models (A) Relationship between observed spike amplitude (horizontal axis) and
activation threshold (vertical axis) for electrodes recording from soma (blue) or axon (red). Each dot
corresponds to a cell-electrode pair. Thin lines indicate ﬁts obtained by different random samplings
of a subset of cells (B) Squared error in probability estimates  averaged over multiple cell-electrode
pairs (vertical axis) with different number of measurements using different methods. Measurements
are done in batches  with a total of 2NeNa measurements per batch. (C) Estimated spike probability
for a few cell-electrode pairs  showing improvement using the proposed methods.

To improve the efﬁciency of response model estimation  the effect of imposing priors on electrical
properties of cells was examined. To test the impact of priors with ground truth and separately from
spike sorting  neural responses were simulated based on activation probabilities estimated from a
previously recorded retina. Two models were compared: (a) an independent model  in which spike
probabilities are estimated without priors; (b) a joint model  in which spike probabilities are estimated
with priors.
The key concept used for priors is that electrical stimulation thresholds for a cell on different electrodes
should bear some relationship to the magnitude of the spike recorded on those electrodes  because
both threshold and spike amplitude should depend inversely on the physical distance to the spike
initiation region of the cell. Thus  for the joint model  the relationship between threshold and spike
amplitude for both axonal and somatic activation was learned from a set of 199 cell-electrode pairs
across 3 data sets (Figure 3A)  using the spike sorting algorithm in [Mena et al.  2017]. The mean and
variance of the parameters of the inverse relationship were identiﬁed by ﬁtting curves with randomly
sampled cell-electrode pairs.

6

AB510152025!0.020.040.060.080.10average number of trials<(ˆpp)2><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit>C0501001502002501521273339activation thresholdspike amplitudeactivation probabilitycurrent index10adaptivejointindependentground truth24323223adaptivejointindependentdataperformanceexamplessoma!axon3226The impact of using this prior was evaluated by measuring the responses from the simulated retina in
batches  where an average of 2 measurements per electrode and amplitude were delivered in each
batch. As the number of measurements increased  the joint model (green  Figure 3B  examples
in Figure 3C and additional data set in Figure 7A) produced estimates of spike probability which
were more accurate than estimates made by the independent model (black curve). Thus  a prior
capturing the inverse relationship between spike amplitude and threshold can improve estimation of
the response model.
6.3 Adaptive stimulation

Figure 4: Adaptive stimulation (A) Adaptive stimulation with different batch sizes (red lines) and
non-adaptive stimulation (black)  both with the independent response model. Subsequent panels
indicate spatial distribution of the electrodes selected by the adaptive algorithm. (B) First phase: All
electrodes and amplitudes are selected uniformly (2 times each). Cell soma (red circle) and axon
direction (red lines) are estimated from detected spike waveform across electrodes. (C) Second phase:
The increase (yellow) and decrease (blue) in number of measurements in second (ﬁrst adaptive) phase
compared to the ﬁrst (non-adaptive) phase. Size of circle indicates the magnitude of deviation. (D  E)
Successive difference in the number of measurements for each electrode.

An alternative to regularizing based on previous retinas is to use feedback from measurements already
made in the target retina to select the next electrical stimulus  and thus potentially improve estimation
in closed loop. The effectiveness of this approach was tested using simulated data  to allow for
more repetitions of electrical stimulation than were present in recorded data. An adaptive algorithm
was developed using two stimuli on average per electrode and amplitude for each batch (2NeNa
measurements in total). After the ﬁrst non-adaptive phase  the adaptive algorithm divides all the
available capacity in the next batch across stimulations to minimize estimation error. With the simpler
independent model  adaptive stimulation gave lower estimation error compared to the non-adaptive
method (Figure 3B  red). The adaptive method with the independent model and the non-adaptive
method with the joint model exhibited similar performance  suggesting that  with sufﬁcient data  the
computationally expensive adaptive stimulation can be replaced with better priors in non-adaptive
stimulation. The adaptive method with the joint model performed similarly to the adaptive model
with the independent model (not shown)  possibly because the contribution of prior from previous
experiments is reduced with better stimulus selection. The estimated response probabilities as a
function of stimulation current for a few cell-electrode pairs after three phases of each approach are
shown in Figure 3C  again showing similar performance of the two approaches.
In any adaptive method  a reduction in the number of adaptive phases reduces the computational
burden  but could also reduce performance. To explore this tradeoff  the algorithm was tested with a
smaller number of adaptive phases  and a corresponding increase in stimulation capacity per phase. A
small number of adaptive phases typically yielded high estimation accuracy; for example  two phases
with batch size 5 each yielded similar accuracy as 10 phases with batch size 1 each (Figure 4A).
Adaptive stimulation also revealed systematic spatial structure in the electrodes selected for stim-
ulation. Compared to the uniform stimulation in the ﬁrst (non-adaptive) phase  the electrodes on
lower left side of the array were stimulated more frequently in the second (adaptive) phase (Figure
4C). This could potentially be explained by the geometry of the axons in the recording  which cross
the array in a particular direction as they head toward the optic nerve (Figure 4B). Since cells could
either be stimulated directly at the soma or indirectly at the axon  electrodes on the side of the array

7

phase 1: uniformphase 2 - phase 1phase 3 - phase 2phase 4 - phase 3+-BCDEspatial pattern of selected electrodes5101520250.0250.0750.1250.175average number of trials<(ˆpp)2><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit>non-adaptiveadaptive batch: 1adaptive batch: 2adaptive batch: 3adaptive batch: 4adaptive batch: 5adaptive batch: 7adaptive batch: 10Aperformancewith more axons would potentially stimulate more cells on average. Thus  these electrodes would
contribute more to reducing error in estimation of response probabilities  and the adaptive algorithm
preferentially selects them. However  in the third (adaptive) phase  the algorithm corrects itself and
selects electrodes with fewer stimulated cells  presumably because estimation error remains high
in those cells (Figure 4D). For subsequent phases  there is no obvious spatial structure in selected
electrodes  presumably because the residual estimation is now similar across electrodes (Figure 4E).
These observations were replicated in another retina (Figure 7B C D E).
6.4 Performance for neural interface

<(cid:107)d(cid:107)2>

Figure 5: Impact of electrical calibration on decoded stimulus (A) Contribution of imperfect prob-
ability estimates to error in linear decoding (y-axis)  measured by variance in estimated probabilities 
weighted by decoder norm ( <(cid:107)d(cid:107)2(p− ˆp)2>
) as a function of the average number of stimulation pulses
(per electrode and amplitude  x-axis) for the three methods presented in the text. Independent and
joint model same as Figure 3  but stimuli for adaptive method chosen using the modiﬁed objective.
Black arrow indicates the trials at which the estimates are compared in (B). (B) Expected mean
squared error of linearly decoded stimulus when probabilities from different methods are used for
choosing the stimulation pattern. Each dot corresponds to a different white noise image. (C  D  E)
The improvement in the expected linearly decoded stimulus using different probability estimates
(over the independent model).

error in the estimate of response probability is given by(cid:80)

While the above techniques improve spike identiﬁcation  response model estimation  and stimulus
selection  a larger issue is how effective these improvements are for the function of the neural
interface. In the case of vision restoration  performance ultimately depends on how each targeted cell
contributes to vision  and on how well an actual image can be represented in the collection of cells.
To test functional impact in a way that accounts for how cells contribute to perception  the adaptive
method was used with a modiﬁed error metric. Previous work [Shah et al.  2019] proposes that
an artiﬁcial retina could linearly combine the expected perception from stimulation of different
electrodes by temporally multiplexing within the integration time of the brain. Expected perception
is inferred by assuming that the brain performs optimal linear reconstruction of the visual stimulus
from retinal inputs. When electrode e is stimulated at amplitude a  the change in perception due to
c (cid:107)dc(cid:107)2var(ˆγe ac)  where dc is the optimal
linear reconstruction ﬁlter for cell c. To evaluate adaptive estimation in this framework  the adaptive
algorithm was modiﬁed to minimize the error in visual stimulus reconstruction  across electrodes
and amplitudes (see Section 5). Applying the modiﬁed algorithm to simulated data revealed a faster
decrease in the stimulus reconstruction error that is attributable to response probability estimation 
compared to non-adaptive stimulation (Figure 5A). As before  the joint model with non-adaptive
stimulation also outperformed the independent model.
To test functional impact in a way that captures variation in visual image structure  the spatial
reconstruction of 20 different target images based on electrical stimulation was examined. Optimizing
the electrical stimulation using estimated response probabilities for both the adaptive and joint

8

adaptive - independentjoint - independentground truth - independentCDA510152025!0.0010.0020.0030.0040.0050.0060.007independentjointadaptiveaverage number of trialsEcontribution to decoding errorchange in achieved decodingperformanceB0.5500.6000.6500.7000.7500.550.600.650.700.75jointadaptiveground truthdecoding error with optimized stimulationindependent (relative MSE)different methods (relative MSE)calibration algorithms (using the method in [Shah et al.  2019]) resulted in more accurate stimulus
reconstruction compared to the independent model (Figure 5B C D). Thus  the gains from efﬁcient
characterization of electrical response properties are likely to translate into improved artiﬁcial vision.
7 Summary
This paper presents three novel methods to optimize the function of a neural interface  speciﬁcally  an
artiﬁcial retina for treating blindness. Using large scale multi-electrode recordings from primate retina
as a lab prototype  prior information and closed-loop approaches improved the accuracy and efﬁciency
of spike sorting  response modeling  and stimulus selection. Notably  the computationally expensive
closed-loop stimulation approach exhibited similar performance to a much simpler non-adaptive
approach that uses prior information from previous experiments  highlighting the value of using
large data sets to improve device function. Evaluation of image reconstruction revealed that these
approaches improved overall function in terms of the quality of the visual image transmitted to the
brain.
In principle  similar approaches may be useful in other neural systems (e.g. intra-Cortical micro-
stimulation [Salzman et al.  1990] for proprioceptive feedback in motor prostheses [Salas et al.  2018])
and in other neural interfaces (e.g. optical recording and stimulation [Shababo et al.  2013]). With the
advent of large-scale data sets  as well as the availability of motor and visual prosthesis technologies
in many subjects  the methods developed here may be helpful in capturing similarities and differences
among individuals and experiments.

8 Future work
Future improvements in electrical response calibration are possible by addressing current technical
limitations and incorporating additional priors. For spike sorting  prior information about monotonic
increase of activation probabilities with increasing currents could be incorporated. For wider ap-
plicability  the artifact estimation method should be extended to stimulation patterns that were not
delivered in previous experiments. For response modeling  priors on the relationship between spike
amplitude on multiple electrodes and activation threshold/slope differences between soma and axon
may be useful [Jepson et al.  2013  Fan et al.  2018].
Several enhacements may be important in future work. First  for understanding the impact on artiﬁcial
retina  analysis of linear image reconstruction [Warland et al.  1997  Stanley et al.  1999] could be
extended to exploit more powerful nonlinear methods [Parthasarathy et al.  2017]. Second  it may be
useful to evaluate response modeling  adaptive stimulation  and spike sorting together rather than
independently. Finally  future work could focus on reducing computational cost in addition to the
duration of electrical calibration.

References
A. Atkinson  A. Donev  and R. Tobias. Optimum Experimental Designs  with SAS. 01 2007. ISBN

978-0-19-929659-0.

D. M. Blei  A. Kucukelbir  and J. D. McAuliffe. Variational inference: A review for statisticians.

Journal of the American Statistical Association  112(518):859–877  2017.

J. Dragas  V. Viswam  A. Shadmani  Y. Chen  R. Bounik  A. Stettler  M. Radivojevic  S. Geissler 
M. E. J. Obien  J. Müller  et al.
In vitromulti-functional microelectrode array featuring 59
760 electrodes  2048 electrophysiology channels  stimulation  impedance measurement  and
neurotransmitter detection channels. IEEE journal of solid-state circuits  52(6):1576–1590  2017.

V. H. Fan  L. E. Grosberg  S. S. Madugula  P. Hottowy  W. Dabrowski  A. Sher  A. M. Litke  and
E. Chichilnisky. Epiretinal stimulation with local returns enhances selectivity at cellular resolution.
Journal of neural engineering  2018.

E. S. Frechette  A. Sher  M. I. Grivich  D. Petrusca  A. M. Litke  and E. Chichilnisky. Fidelity of the
ensemble code for visual motion in primate retina. Journal of neurophysiology  94(1):119–135 
2005.

9

M. S. Humayun  J. D. Dorn  L. Da Cruz  G. Dagnelie  J.-A. Sahel  P. E. Stanga  A. V. Cideciyan 
J. L. Duncan  D. Eliott  E. Filley  et al. Interim results from the international trial of second sight’s
visual prosthesis. Ophthalmology  119(4):779–788  2012.

L. H. Jepson  P. Hottowy  K. Mathieson  D. E. Gunning  W. D ˛abrowski  A. M. Litke  and
E. Chichilnisky. Focal electrical stimulation of major ganglion cell types in the primate retina for
the design of visual prostheses. Journal of Neuroscience  33(17):7194–7205  2013.

J. J. Jun  N. A. Steinmetz  J. H. Siegle  D. J. Denman  M. Bauza  B. Barbarits  A. K. Lee  C. A.
Anastassiou  A. Andrei  Ç. Aydın  et al. Fully integrated silicon probes for high-density recording
of neural activity. Nature  551(7679):232  2017.

J. N. Kerr and W. Denk. Imaging in vivo: watching the brain in action. Nature Reviews Neuroscience 

9(3):195  2008.

D. P. Kingma and J. Ba. Adam: A method for stochastic optimization. arXiv preprint arXiv:1412.6980 

2014.

D. P. Kingma and M. Welling. Auto-encoding variational bayes. arXiv preprint arXiv:1312.6114 

2013.

D. R. Kipke  W. Shain  G. Buzsáki  E. Fetz  J. M. Henderson  J. F. Hetke  and G. Schalk. Advanced
neurotechnologies for chronic neural interfaces: new horizons and clinical opportunities. Journal
of Neuroscience  28(46):11830–11838  2008.

J. Lewi  R. Butera  and L. Paninski. Sequential optimal design of neurophysiology experiments.

Neural Computation  21(3):619–687  2009.

A. Litke  N. Bezayiff  E. Chichilnisky  W. Cunningham  W. Dabrowski  A. Grillo  M. Grivich 
P. Grybos  P. Hottowy  S. Kachiguine  et al. What does the eye tell the brain?: Development of
a system for the large-scale recording of retinal output activity. IEEE Transactions on Nuclear
Science  51(4):1434–1440  2004.

H. Lorach  G. Goetz  R. Smith  X. Lei  Y. Mandel  T. Kamins  K. Mathieson  P. Huie  J. Harris 
A. Sher  et al. Photovoltaic restoration of sight with high visual acuity. Nature medicine  21(5):
476  2015.

S. Madugula  G. E. Mena  L. E. Grosberg  V. H. Fan  P. Hottowy  W. Dabrowski  A. Sher  A. Litke 
L. Paninski  and E. Chichilnisky. Large-scale analysis of patterned epiretinal stimulation for
prosthesis design. TEATC  2017.

G. E. Mena  L. E. Grosberg  S. Madugula  P. Hottowy  A. Litke  J. Cunningham  E. Chichilnisky 
and L. Paninski. Electrical stimulus artifact cancellation and neural spike detection on large
multi-electrode arrays. PLoS computational biology  13(11):e1005842  2017.

D. J. O’Shea and K. V. Shenoy. Eraasr: an algorithm for removing electrical stimulation artifacts

from multielectrode array recordings. Journal of neural engineering  15(2):026020  2018.

L. Paninski  J. Pillow  and J. Lewi. Statistical models for neural encoding  decoding  and optimal

stimulus design. Progress in brain research  165:493–507  2007.

N. Parthasarathy  E. Batty  W. Falcon  T. Rutten  M. Rajpal  E. Chichilnisky  and L. Paninski. Neural
networks for efﬁcient bayesian decoding of natural images from retinal neurons. pages 6434–6445 
2017.

E. Richard  G. A. Goetz  and E. Chichilnisky. Recognizing retinal ganglion cells in the dark. In

Advances in Neural Information Processing Systems  pages 2476–2484  2015.

M. A. Salas  L. Bashford  S. Kellis  M. Jafari  H. Jo  D. Kramer  K. Shanﬁeld  K. Pejsa  B. Lee 
C. Y. Liu  et al. Proprioceptive and cutaneous sensations in humans elicited by intracortical
microstimulation. Elife  7:e32904  2018.

C. D. Salzman  K. H. Britten  and W. T. Newsome. Cortical microstimulation inﬂuences perceptual

judgements of motion direction. Nature  346(6280):174  1990.

10

A. B. Schwartz. Cortical neural prosthetics. Annu. Rev. Neurosci.  27:487–507  2004.

B. Shababo  B. Paige  A. Pakman  and L. Paninski. Bayesian inference and online experimental
design for mapping neural microcircuits. In Advances in Neural Information Processing Systems 
pages 1304–1312  2013.

N. P. Shah  S. Madugula  G. Mena  P. Tandon  P. Hottowy  A. Sher  A. Litke  S. Mitra  and
E. Chichilnisky. Optimization of electrical stimulation for a high-ﬁdelity artiﬁcial retina. In-
ternational IEEE EMBS conference on Neuroengineering  2019.

G. B. Stanley  F. F. Li  and Y. Dan. Reconstruction of natural scenes from ensemble responses in the

lateral geniculate nucleus. Journal of Neuroscience  19(18):8036–8042  1999.

K. Stingl  K. U. Bartz-Schmidt  D. Besch  A. Braun  A. Bruckmann  F. Gekeler  U. Greppmaier 
S. Hipp  G. Hörtdörfer  C. Kernstock  et al. Artiﬁcial vision with wirelessly powered subretinal
electronic implant alpha-ims. Proceedings of the Royal Society B: Biological Sciences  280(1757):
20130077  2013.

C. Stosiek  O. Garaschuk  K. Holthoff  and A. Konnerth. In vivo two-photon calcium imaging of
neuronal networks. Proceedings of the National Academy of Sciences  100(12):7319–7324  2003.

M. J. Wainwright  M. I. Jordan  et al. Graphical models  exponential families  and variational

inference. Foundations and Trends R(cid:13) in Machine Learning  1(1–2):1–305  2008.

D. K. Warland  P. Reinagel  and M. Meister. Decoding visual information from a population of retinal

ganglion cells. Journal of neurophysiology  78(5):2336–2350  1997.

B. S. Wilson  C. C. Finley  D. T. Lawson  R. D. Wolford  D. K. Eddington  and W. M. Rabinowitz.

Better speech recognition with cochlear implants. Nature  352(6332):236  1991.

11

9 Appendix

9.1 Details on spike sorting in the presence of stimulation artifacts

Here  the spike sorting procedure presented in Section 2 is discussed in detail.
Let (cid:126)ya r ∈ RL be the recorded waveform of length L. The artifact is approximated in a subspace
learned from previous experiments. For a given amplitude a  and relative distance to recording
electrode d(s  r)  an n dimensional basis is learned Aa d(s r). The artifact is thus reconstructed using
an n dimensional learned parameter (cid:126)b ∈ Rn as Aa d(s r)(cid:126)ba r.
Let (cid:126)xc a ∈ {0  1}L be the spiking activity and Wc r ∈ RL×L be the matrix consisting of shifted
copies of a previously identiﬁed spike waveform recorded on electrode r. The contribution of neural
activity from cell c to the recorded data is given by Wc r(cid:126)xc a.
Each cell has at most one spike during this recording interval  and when it spikes the amplitude is
exactly 1. This constraint is incorporated by parameterizing xc a as a softmax function of real valued
(cid:126)zc a with temperature τ :

(cid:80)

(cid:126)xc a t =

ezc a t/τ

t ezc a t/τ + eqc a/τ

where qc a is an auxiliary parameter. Since only a few cells are activated in response to electrical
stimulation  a sparsity enforcing L1 norm penalty is applied on (cid:126)x.
The artifact parameters (cid:126)b and spike assignments (cid:126)x are estimated by minimizing the penalized
reconstruction error (Lspike-sort) for a particular stimulating electrode e  the recorded voltage traces on
multiple recording electrodes and all the stimulating amplitudes simultaneously:

(cid:88)

a

(cid:88)
r (cid:107)(cid:126)ya r − (Aa d(r e)(cid:126)ba r +

(cid:88)

c

Lspike-sort =

(cid:88)
c (cid:107)(cid:126)xc a(cid:107)1

Wc r(cid:126)xc a)(cid:107)2

2 + λL1

Optimization is performed using Adam (learning rate = 0.01)  with λL1 chosen using cross-validation
and temperature τ is reduced to 0.8 times its previous value every time the loss converges.

9.2 Details on the joint response model

Here  the joint response modeling procedure presented in Section 3.2 is discussed in detail.

9.2.1 Model
The responses are denoted by Rn ∈ {0  1}. Similar to the independent model 

P (Rn = 1) =

1

1 + e−(pen cn (an−qen  cn ))

(7)

where pen cn  qen cn are the parameters of the sigmoidal activation curve for the stimulating electrode
en and cell cn.
For each cell c and electrode e  Ee c ∈ R+ denotes the recorded spike amplitude and Te c denotes
whether the electrode e is recording from the soma or axon  as determined by the spike shape. The
spike threshold qe c is modeled as a Gaussian distribution  with a separate relationship for soma and
axons:

qe c ∼ N (xTe c +

yTe c
Ee c

  ν2)

Further  the prior for {x  y} is modeled with a two dimensional Gaussian
{xT   yT} ∼ N (µT   ΣT ); T ∈ {soma  axon}

12

(8)

(9)

the parameters of the model for electrically evoked responses are given by Θ =

The parameters for prior distribution (µT   ΣT ) are estimated from stimulated electrode and cell pairs
in previous experiments.
Hence 
{{pe c  qe c}e=Ne c=Nc
ΠnP (Rn|an; pen cn  qen cn )Πe cP (qe c|Ee c; xTe c  yTe c   νTe c )Πi∈{soma axon}P (xi  yi|µi  Σi).
9.2.2 Inference

;{xj  yj}j∈{soma axon}  ν} and the resulting model likelihood (Lmodel) is

e=1 c=1

The goal is to estimate the posterior distribution of model parameters given the recorded data
n=1 ). During inference  ν is treated as non-random and other parame-
P (Θ|{Rn  en  an  cn}n=N
ters are estimated by variational approximation [Blei et al.  2017  Wainwright et al.  2008]. Let
zpe c   zqe c  zxi  zyi represent the variational parameters corresponding to parameters in Θ. A mean-
ﬁeld variational approximation of the posterior is learned

P (Θ|{Rn  en  an  cn}n=N

n=1 ) ≈ Πe cq(zpe c )q(zqe c )Πi∈{soma axon}q(zxi)q(zyi).

The parameters of the variational distribution (φ) are estimated by maximizing the evidence lower
bound (ELBO) on the log-likelihood (− log Lmodel):

− log Lmodel ≥ Eq(z) log P (R  Z) + H(q(z)).

(10)

(11)

As shown below  the ﬁrst term of the joint probability corresponds to modeling electrically evoked
spikes  the second term corresponds to modeling spike threshold from spike amplitudes  and the
third term corresponds to the relationship between spike threshold and spike amplitude for all the
cell-electrode pairs within a retina:

n=N(cid:88)

n=1

(cid:88)

e c

+

Eq(z) log P (R  Z) =

Eqφ(zpen  cn ) qφ(zqen  cn ) log P (Rn  zpen cn   zqen  cn|an)

Eqφ(zqe c ) log P (zqe c   zxTe c   zyTe c|Ee c  νTe c ) +

Eqφ(zxi ) qφ(zyi ) log P (zxi  zyi|µi  σi).
(12)

(cid:88)

i

qe c
µ   φ

qe c

µ   φxi

σ2 ); qφ(zxi) = N (φxi

The variational distributions are parameterized as Gaussians: qφ(zpe c ) = N (φ
σ2) and qφ(zyi ) = N (φyi
qφ(zqe c ) = N (φ
the sum of Gaussian entropy corresponding to each variational parameter.
For maximizing the ELBO  the variational parameters are sampled using the re-parametrization
trick [Kingma and Welling  2013]: z = φµ + φσ2    ∼ N (0  I). The empirical approximation of
ELBO is computed by averaging 10 samples for p  q and one sample for x  y. This approximation is
maximized by stochastic gradient descent with norm clipping. At each step of the stochastic gradient
descent  the objective function is evaluated over all samples  resulting in randomness only due to
sampling of variational parameters. Finally  the posterior activation probabilties are estimated by
averaging over 1000 random samples of zp  zq.

pe c
σ2 );
σ2)  with H(q) being

µ   φyi

pe c
µ   φ

9.3 Details on adaptive stimulation

Here  adaptive stimulus selection procedure presented in Section 4 is described in detail.
The goal is to minimize the total uncertainty in activation probability estimates over all electrodes 
amplitudes and cells (γe a c). The adaptive stimulation proceeds in batches  where a total of NeNaT
stimulations must be unevenly divided across electrodes and amplitudes. Let Te a ∈ Z+ denote
the number of stimulations for electrode e and amplitude a in the next phase of the closed loop
experiment. Hence  the optimization problem to be solved after each batch is given by :

(cid:88)

var(γe a c)

Ladapt-stim =

Te a

minimize

subject to (cid:88)

e a

Te a ≤ NeNaT 

Te a ≥ 0 ∀e  a.

13

e a c

(13)

1

Deﬁne Xa = [a  1]   θe c = [pe c −pe cqe c]. Under this notation  the activation probability γe a c =
e a denote the previous number of measurements for electrode
1+exp(−θT
e and amplitude a. The Fisher information of θe c after (Te a + T (cid:48)
e a) stimulations is computed using
the chain rule as

e cXa) = f (−θT

e cXa). Let T (cid:48)

I(θe c) =

(Te a + T

(cid:48)
e a)γe a c(1 − γe a c)XaX T
a .

(cid:88)

a

The asymptotic variance of the maximum likelihood estimate ˆθ is given by the inverse Fisher
information at the true parameter values I(θe c)−1. Finally  the ﬁrst-order expansion of γe a c gives the
variance of individual parameter estimates as var(γe a c) ≈ (f(cid:48))2var(θe c) = QT
e a cvar(θe c)Qe a c 
where Qe a c = γe a c(1 − γe a c)Xa. Normalizing the current levels a between −1 and 1 leads
to better condition number for Fisher information and better approximation of the variance. After
relaxing the integer constraint on Te a  the optimization problem is:

(cid:88)

(cid:48)
Q
e a c[

(cid:88)

e a c

Ladapt-stim =

Te a

minimize

subject to (cid:88)

Te a ≤ NeNaT 

e a

(Te a(cid:48) + T

a(cid:48)
Te a ≥ 0 ∀e  a.

(14)

(15)

(cid:48)
e a(cid:48))γe a(cid:48) c(1 − γe a(cid:48) c)Xa(cid:48)X

(cid:48)
a(cid:48)]

−1Qe a c

As the true parameter values are not unknown  the estimated probabilities in Equation 15 are
used instead. These are estimated either by maximum likelihood on the independent model  or
performing variational inference on the joint model. Re-parameterization of Te a converts the
constrained optimization problem into an unconstrained optimization problem. Speciﬁcally  a
soft-max representation of Te a = (NeNaT )
e(cid:48) /τ is used  where τ = 1000 is
the temperature parameter and δe is an auxillary parameter to allow for loose constraints. After
minimizing the unconstrained problem using Adam optimization [Kingma and Ba  2014]  the exact
integer solution for Te a is obtained by rounding.

ete a /τ
e(cid:48) a(cid:48) /τ
t

(cid:80)

e(cid:48)  a(cid:48) e

+eδ

9.4 Approximation of artifacts in low dimensional space

Figure 6: (A) Recorded artifacts (same as Figure 2A)  (B) Reconstruction of artifacts from a 9
dimensional subspace. The projection retains most of the structure in the variation of artifacts.

14

elec 1elec 2elec 1elec 2elec 1elec 20 microns60 microns120 micronsdistancesprojected artifactsretinaselec 1elec 2elec 1elec 2elec 1elec 20 microns60 microns120 micronsdistancesoriginal artifactsretinasAB9.5 Additional dataset

Figure 7: Results for another retina. (A) Conventions as in Figure 3B. (B-E) Conventions as in Figure
4(B-E).

15

+51015200.000.020.040.060.080.100.120.14independentjointadaptive<(ˆpp)2><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit><latexit sha1_base64="(null)">(null)</latexit>average number of trials-spatial pattern of selected electrodesperformancephase 1: uniformphase 2 - phase 1phase 3 - phase 2phase 4 - phase 3ECBDA,Nishal Shah
Sasidhar Madugula
Pawel Hottowy
Alexander Sher
Alan Litke
Liam Paninski
E.J. Chichilnisky