2018,A Game-Theoretic Approach to Recommendation Systems with Strategic Content Providers,We introduce a game-theoretic approach to the study of recommendation systems with strategic content providers. Such systems should be fair and stable. Showing that traditional approaches fail to satisfy these requirements  we propose the Shapley mediator. We show that the Shapley mediator satisfies the fairness and stability requirements  runs in linear time  and is the only economically efficient mechanism satisfying these properties.,A Game-Theoretic Approach to Recommendation

Systems with Strategic Content Providers

Omer Ben-Porat and Moshe Tennenholtz
Technion - Israel Institute of Technology

Haifa 32000 Israel

{omerbp@campus moshe@ie}.technion.ac.il

Abstract

We introduce a game-theoretic approach to the study of recommendation systems
with strategic content providers. Such systems should be fair and stable. Showing
that traditional approaches fail to satisfy these requirements  we propose the Shap-
ley mediator. We show that the Shapley mediator fulﬁlls the fairness and stability
requirements  runs in linear time  and is the only economically efﬁcient mechanism
satisfying these properties.

1

Introduction

Recommendation systems (RSs hereinafter) have rapidly developed over the past decade. By
predicting a user preference for an item  RSs have been successfully applied in a variety of applications.
Moreover  the amazing RSs offered by giant e-tailers and e-marketing platforms  such as Amazon
and Google  lie at the heart of online commerce and marketing on the web. However  current
signiﬁcant challenges faced by personal assistants (e.g. Cortana  Google Now and Alexa) and mobile
applications go way beyond the practice of predicting the satisfaction levels of a user from a set of
offered items. Such systems have to generate recommendations that satisfy the needs of both the end
users and other parties or stakeholders [8  39]. Consider the following cases:
• When Alice drives her car  her personal assistant runs the default navigation application. When
she makes a stop at a junction  the personal assistant may show Alice advertisements provided by
neighborhood stores  or an update on the stock market status as provided by ﬁnancial brokers. Each of
these pieces of information — the plain navigation content  the local advertisements and the ﬁnancial
information — are served by different content providers. These content providers are all competing
over Alice’s attention at a given point. The personal assistant is aware of Alice’s satisfaction with
each content  and needs to select the right content to show at a particular time.
• Bob is reading news of the day on his mobile application. The application  aware of Bob’s interests 
is presenting news deemed most relevant to him. The news is augmented by advertisements  provided
by competing content providers  as well as articles by independent reporters. The mobile application 
balancing Bob’s taste and the interests of the content providers  determines the mix of content shown
to Bob.
In these contexts  the RS integrates information from various providers  often sponsored content 
which is probably relevant to the user. The content providers are strategic — namely  make decisions
based on the way the RS operates  aiming at maximizing their exposure. For instance  to draw Bob’s
attention  a content provider strategically selects the topic of her news item  aiming at maximizing the
exposure to her item. On the one hand  fair content provider treatment is critical for smooth efﬁcient
use of the system and also to maintained content provider engagement over time. On the other hand 
the strategic behavior of the content providers may lead to instability of the system: a content provider

32nd Conference on Neural Information Processing Systems (NeurIPS 2018)  Montréal  Canada.

might choose to adjust the content she offers in order to increase the expected number of displays to
the users  assuming the others stick to their offered contents.
In this paper  we study ways of overcoming this dilemma using canonical concepts in game theory to
impose two requirements on the RS: fairness and stability. Fairness is formalized as the requirement
of satisfying fairness-related properties  and stability is deﬁned as the existence of a pure Nash
equilibrium. Analyzing RSs that satisfy these two requirements is the main goal of this paper.
Our ﬁrst result is that traditional RSs fail to satisfy both of the above requirements. Traditional RSs
are complete  in the sense that they always show some content to the user  but it turns out that this
completeness property cannot be satisﬁed simultaneously with the fairness and equilibrium existence
requirements. This impossibility result is striking and calls for a search of a fair and stable RS.
To do so  we model the setting as a cooperative game  binding content provider payoffs with user
satisfaction. We resort to a core solution concept in cooperative game theory  the Shapley value [35] 
which is a celebrated mechanism for value distribution in game-theoretic contexts (see  e.g.  [28]).
In our work  it is proposed as a tool for recommendations  namely for setting display probabilities.
Since the Shapley value is employed in countless settings for fair allocation  it is not surprising that
it satisﬁes our fairness properties. In addition  we prove that the related RS  termed the Shapley
mediator  does satisfy the stability requirement. In particular  we show that the Shapley mediator
possesses a potential function [27]  and therefore any better-response learning dynamics converge to
an equilibrium (see  e.g.  [13  17]). Note that this far exceeds our minimal stability requirement from
the RS.
Implementation in commercial products would require the mediator to be computationally tractable.
The mediator interacts with users; hence a fast response is of great importance. In another major
result  we show that the Shapley mediator has a computationally efﬁcient implementation. The
latter is in contrast to the intractability of the Shapley value in classical game-theoretic contexts [14].
Another essential property of the Shapley mediator is economic efﬁciency [36]. Unlike cooperative
games  where the Shapley value can be characterized as the only solution concept to satisfy properties
equivalent to fairness and economic efﬁciency  in our setting the Shapley mediator is not characterized
solely by fairness and economic efﬁciency. Namely  one can ﬁnd other simple mediators that satisfy
these two properties. However  we show that the Shapley mediator is the unique mediator to satisfy
the fairness  economic efﬁciency and stability requirements. Importantly  our study stems from
a rigorous deﬁnition of the minimal requirements from an RS  and so characterizes a unique RS.
Interested in understanding the ramiﬁcation on user utility  we introduce a rigorous analysis of user
utility in (strategic) recommendation systems  and show that the Shapley mediator is not inferior to
traditional approaches.
Due to space constraints  the proofs are deferred to the full version [5].

1.1 Related work

This work contributes to three interacting topics: fairness in general machine learning  multi-
stakeholder RSs and game theory.
The topic of fairness is receiving increasing attention in machine learning [6  12  30  32] and data
mining [23]. A major line of research is discrimination aware classiﬁcation [16  19  21  38]  where
classiﬁcation algorithms must maintain high predictive accuracy without discriminating on the basis
of a variable representing membership in a protected class  e.g. ethnicity. In the context of RSs 
the work of Kamishima et al. [20  22] addresses a different aspect of fairness (or lack thereof): bias
towards popular items. The authors propose a collaborative ﬁltering model which takes into account
viewpoints given by users  thereby tackling the tendency for popular items to be recommended more
frequently  a problem posed in [29]. A related problem is over-specialization  i.e.  the tendency to
recommend items similar to those already purchased or liked in the past  which is addressed in [1].
Zheng [39] surveys multi-stakeholder RSs  and highlights practical applications. Examples include
RSs for sharing economies (e.g. AirBnB  Uber  etc.)  online dating [31]  and recruiting [37]. Burke
[8] discusses fairness in multi-stakeholder RSs  and presents a taxonomy of classes of fairness-aware
RSs. The author distinguishes between user fairness  content provider fairness and pairwise fairness 
and reviews applications for these fairness types. A practical problem concerning fairness in multi-
stakeholder RSs is discussed in [26]. In their work  an online platform is used by users who play two
roles: customers seeking recommendations and content providers aiming for exposure. They report 

2

Table 1: Consider an arbitrary game  a ﬁxed strategy proﬁle X and an arbitrary user ui. TOP
selects uniformly among the players that satisfy ui the most. The Bradley-Terry-Luce mediator
[7  25]  or simply BTL  selects player j w.p. proportional to her satisfaction level over the sum of
satisfaction levels. NONE displays no item  and RAND selects uniformly among players with a
positive satisfaction level. Both TOP and BTL satisfy F  but do not satisfy S. NONE and RAND
satisfy S  but do not satisfy F. The bottom line refers to the Shapley mediator  SM  which is deﬁned
and analyzed in Section 3. In contrast to the other mediators  SM satisﬁes both F and S.

PROBABILITY COMPUTATION

P (M(X  ui) = j)
j∈arg max
1
j(cid:48) )
j(cid:48) σi(X
|arg maxj(cid:48) σi(Xj(cid:48) )|
(cid:80)N
σi(Xj(cid:48) )
0
(cid:80)N

σi(Xj )>0

σi(Xj )

j(cid:48)=1

1
j(cid:48)=1

MEDIATOR

TOP

BTL
NONE
RAND

1

σi(X

j(cid:48) )>0

SM
(SECTION 3)

EQUATION (2)

FAIRNESS (F)
√
√
×
×
√

STABILITY (S)

× (THEOREM 1)
× (THEOREM 1)
√
√

√

(THEOREM 2)

based on empirical evidence  that collaborative ﬁltering techniques tend to create rich-gets-richer
scenarios  and propose a method for re-ranking scores  in order to improve exposure distribution
across the content providers.
Note that all the work above considers traditional machine learning tasks that enforce upon the solution
some form of fairness  as deﬁned speciﬁcally for each task. They suggest additional considerations 
but do not consider that the parties (i.e.  users  content providers) will change their behavior as a
result of the new mechanism  nor examine the game theoretic aspects imposed by the selection of the
RS in a formal manner. To the best of our knowledge  our work is the ﬁrst to suggest a fully grounded
approach to content provider fairness in RSs.
Finally  strategic aspects of classical machine learning tasks were also introduced recently [3  4].
The idea that a recommendation algorithm affects content-provider policy  and as a result must be
accompanied by a game-theoretic study is key to recent works in search/information retrieval [2  33];
so far  however  such work has not dealt with the issue of fairness.

2 Problem formulation

From here on  our ideas will be exempliﬁed in the following motivational example: a mobile applica-
tion (or simply app) is providing users with valuable content. A set of players (advertisers) publish
their items (advertisements) on the app. When a user enters the app  a mediator (RS/advertising
engine) decides whether to display an item to that user or not  and which player’s item to display.
The reader should notice that while we use that motivation for the purpose of exposition  our formal
model and results are applicable to a whole range of RSs with strategic content providers.
Formally  the recommendation game is deﬁned as follows:
• A set of users U = {u1  . . .   un}  a set of players [N ] = {1  . . . N}  and a mediator M.
• The set of items (e.g. possible ad formats/messages to select from) available to player j is denoted
by Lj  which we assume to be ﬁnite. A strategy of player j is an item from Lj.

• Each user ui has a satisfaction function σi : L → [0  1]  where L =(cid:83)N

j=1 Lj is the set of all

available items. In general  σi(l) measures the satisfaction level of ui w.r.t. l.
• When triggered by the app  M decides which item to display  if any. Formally  given the strategy
proﬁle X = (X1  . . .   XN ) and a user ui  M(X  ui) is a distribution over [N ] ∪ {∅}  where ∅
symbolizes maintaining the plain content of the app. That is  displaying no item at all. We refer to

3

P (M(X  ui) = j) as the probability that player j’s item will be displayed to ui under the strategy
proﬁle X.
• Each player gets one monetary unit when her item is displayed to a user. Therefore  the expected
• The social welfare of the players under the strategy proﬁle X is the expected number of displays 

payoff of player j under the strategy proﬁle X is πj(X) =(cid:80)n
V (X) =(cid:80)N

P (M(X  ui) = j).

i=1

j=1 πj(X).

For ease of notation  we shall sometimes refer to σi(X) as the maximum satisfaction level of user ui
from the items in X  i.e.  σi(X) = maxj σi(Xj).
We demonstrate our setting with the following example.
Example 1. Consider a game with two players and three users. Let L1 = {l1  l2} L2 = {l3} such
that the satisfaction levels of the users with respect to the items are

(cid:34) u1

0.1
0.8
0.9

l1
l2
l3

(cid:35)

.

u2
0.9
0.7
0.8

u3
0.2
0.9
0.1

Consider a mediator displaying each user with the most satisfying item to her taste  denoted by TOP.
For example  P(TOP ((l1  l3)  u1) = 2) = 1  since σ1(l3) = 0.9 > σ1(l1) = 0.1. The proﬁle (l1  l3)
will probably be materialized in realistic scenarios  since the payoff of player 1 under the strategy
proﬁle (l2  l3) is π1(l2  l3) = 1  while π1(l1  l3) = 2. Notice that from the users’ perspective 1 this
i=1 σi(l2  l3) = 2.6;

i=1 σi(l1  l3) = 0.9 + 0.9 + 0.2 = 2  while(cid:80)3

proﬁle is not optimal  since(cid:80)3

hence  the users suffer from strategic behavior of the players.

After deﬁning general recommendation games  we now present a few properties that one may desire
from a mediator. First and foremost  a mediator has to be fair. The following is a minimal set of
fairness properties:
Null Player. If σi(Xj) = 0  then it holds that P (M(X  ui) = j) = 0. Informally  an item will not
be displayed to ui if it has zero satisfaction level w.r.t. him.
Symmetry. If ui has the same satisfaction level from two items  they will be displayed with the same
probability. Put differently  if σi(Xj) = σi(Xm)  then P (M(X  ui) = j) = P (M(X  ui) = m).
User-Independence. Given the selected items  the display probabilities depend only on the user: if
user ui(cid:48) is removed from/added to U  P (M(X  ui) = j) will not change  i.e. 
P (M(X  ui) = j) = P (M(X  ui) = j | ui(cid:48) ∈ U) .
Leader Monotonicity. M displays the most satisfying items (w.r.t.
a speciﬁc user) with
higher probability than it displays other items. Formally  if j ∈ arg maxj(cid:48)∈[N ] σi(Xj(cid:48)) and
m /∈ arg maxj(cid:48)∈[N ] σi(Xj(cid:48))  then P (M(X  ui) = j) > P (M(X  ui) = m).
For brevity  we denote the above set of fairness properties by F. In addition  an essential property
in a system with self-motivated participants is that it will be stable. Instability in such systems is
a result of a player aiming to improve her payoff given the items selected by others. A minimal
requirement in this regard is stability against unilateral deviations as captured by the celebrated
pure Nash equilibrium concept  herein denoted PNE. A strategy proﬁle X = (X1  . . .   XN ) is
called a pure Nash equilibrium if for every player j ∈ [N ] and any strategy X(cid:48)
j ∈ Lj it holds that
πj(Xj  X−j) ≥ πj(X(cid:48)
j  X−j)  where X−j denotes the vector X of all strategies  but with the j-th
component deleted. We use the notion of PNE to formalize the stability requirement:

Stability. Under any set of players  available items  users and user satisfaction functions  the game
induced by M possesses a PNE.
For brevity  we denote this property by S. The goal of this paper is to devise a computationally
tractable mediator that satisﬁes both F and S.2

1For a formal deﬁnition of the user utility  see Subsection 6.2.
2One may require the convergence of any better-response dynamics  thereby allowing the players to learn the

environment. In Section 3 we show that our solution satisﬁes this stronger notion of stability as well.

4

2.1

Impossibility of classical approaches

We highlight a few benchmark mediators in Table 1  including TOP  which was introduced informally
in Example 1. Another interesting mediator is BTL  which follows the lines of the Bradley-Terry-
Luce model [7  25]. BTL is addressed here as a representative of a wide family of weight-based
mediators: mediators that distribute display probability according to weights  determined by a
monotonically increasing function of the user satisfaction (e.g.  softmax). Common to TOP  BTL
and any other weight-based mediator  is that an item is displayed to a user with probability 1.3 We
model this property as follows.

Complete. For any recommendation game and any strategy proﬁle X (cid:80)N

P (M(X  ui) = j) =

1.
Since the goal of an RS is to provide useful content to users  satisfying Complete seems justiﬁed.
Although it seems unreasonable to avoid showing any content to a certain user at a certain time  it
turns out that this avoidance is crucial in order to satisfy our requirements.
Theorem 1. No mediator can satisfy F  S and Complete.

j=1

Proof sketch. We construct a game with two players  three users and three strategies  and show that
no mediator can satisfy F  S and Complete. Importantly  our technique can be used to show that any
arbitrary game does not possess a PNE or that a slight modiﬁcation of this game does not possess a
PNE.

Consider the following satisfaction matrix:(cid:34) u1

(cid:35)

 

u2
y
0
x

u3
x
y
0

0
x
y

l1
l2
l3

where (x  y) ∈ (0  1]2. Let L1 = L2 = {l1  l2  l3} (i.e.  a symmetric two-player game). By using
the properties of F we characterize the structure of the induced normal form game. We show that
in this normal form game  a PNE only exists if P (M((l2  l3)  u1) = 1) = 0.5 (and similarly to
the other users and strategy proﬁles  due to User-Independence). Since this holds for every x
and y  the mediator displays a random item for each user under any strategy proﬁle. Recall that a
random selection does not satisfy Leader Monotonicity; hence  no mediator can satisfy F  S and
Complete.

abilities  i.e.  (cid:80)N
(cid:80)N

Moreover  Theorem 1 is not sensitive to the sum of the display probabilities being equal to
1. One can show a similar argument for any mediator that displays items with constant prob-
P (M(X  ui) = j) = c for some 0 < c ≤ 1. Theorem 1 suggests that
P (M(X  ui) = j) should be bounded to the user satisfaction levels. In the next section 

j=1

j=1

we show a novel way of doing so.

3 Our approach: the Shapley mediator

In order to provide a fair and stable mediator  we resort to cooperative game theory. Informally 
a cooperative game consists of two elements: a set of players [N ] and a characteristic function
v : 2[N ] → R  where v determines the value given to every coalition  i.e.  every subset of players.
The analysis of cooperative games focuses on how the collective payoff of a coalition should be
distributed among its members.
One core solution concept in cooperative game theory is the Shapley value [35].
Deﬁnition 1 (Shapley value). Let (v  [N ]) be a cooperative game such that v(∅) = 0. According to
the Shapley value  the amount that player j gets is

(cid:88)

(cid:0)v(P R

1
N !

R∈Π([N ])

j )(cid:1) 

j ∪ {j}) − v(P R

(1)

3Perhaps excluding proﬁles X where σi(X) = 0. We allow M to behave arbitrarily in this case.

5

where Π([N ]) is the set of all permutations of [N ] and P R
j
player j in the permutation R.

is the set of players in [N ] which precede

One way to describe the Shapley value  is by imagining the process in which coalitions are formed:
when player j joins coalition C  she demands her contribution to the collective payoff of the coalition 
namely v(C∪{j})− v(C). Equation (1) is simply summing over all such possible demands  assuming
that all coalitions are equally likely to occur.
For our purposes  we ﬁx a strategy proﬁle X  and focus on an arbitrary user ui. How should a
mediator assign the probabilities of being displayed in a fair fashion? The induced cooperative game
contains the same set of players. For every C ⊆ [N ]  let XC denote the strategy proﬁle where all
players missing from C are removed. We deﬁne the characteristic function of the induced cooperative
game as

vi(C; X) = σi(XC) 

where σi(XC) is the maximal satisfaction level a user ui may obtain from the items chosen by the
members of C. Indeed  this formulation represents a collaborative behavior of the players  when they
aim to maximize the satisfaction of ui. Observe that vi(·; X) : 2[N ] → R is a valid characteristic
function  hence (vi(·; X)  [N ]) is a well deﬁned cooperative game. Note that the selection of a
mediator fully determines the probability of the events M(X  ui) = j  and vice versa. The mediator
that sets the probability of the event M(X  ui) = j according to the Shapley value of the induced
cooperative game (vi(·; X)  [N ]) is hereinafter referred to as the Shapley mediator  or SM for
abbreviation.

3.1 Properties of the Shapley mediator

Since the Shapley value is employed in countless settings for fair allocation  it is not surprising that it
satisﬁes our fairness properties.
Proposition 1. SM satisﬁes F.

function Φ :(cid:81)

j Lj → R such that for any strategy proﬁle X = (X1  . . .   XN ) ∈(cid:81)

We now show that recommendation games with SM possess a PNE. This is done using the notion
of potential games [27]. A non-cooperative game is called an exact potential game if there exists a
j Lj  any player
j and any strategy X(cid:48)
j  the change in her payoff
function equals the change in Φ  i.e. 

j ∈ Lj  whenever player j switches from Xj to X(cid:48)
j  X−j) = πj(Xj  X−j) − πj(X(cid:48)

Φ(Xj  X−j) − Φ(X(cid:48)

j  X−j).

This brings us to the main result of this section:
Theorem 2. Recommendation games with the Shapley mediator are exact potential games.

Thus  due to Monderer and Shapley [27]  any recommendation game with the Shapley mediator
possesses at least one PNE  and the set of pure Nash equilibria corresponds to the set of argmax
points of the potential function; therefore  SM satisﬁes S.
Corollary 1. SM satisﬁes S.

In fact  Theorem 2 proves a much stronger claim than merely the existence of PNE. A better-response
dynamics is a sequential process  where in each iteration an arbitrary player unilaterally deviates to a
strategy which increases her payoff.
Corollary 2. In recommendation games with the Shapley mediator  any better-response dynamics
converges.

This convergence guarantee allows the players to learn which items to pick in order to maximize
their payoffs. Indeed  as has been observed by work on the topic of online recommendation and
advertising systems (e.g. sponsored search [10])  convergence to PNE is essential for system stability 
as otherwise inefﬁcient ﬂuctuations may occur.

4 Linear time implementation

In Section 3 we showed that the Shapley mediator  SM  satisﬁes F and S. Therefore  it fulﬁlls our
requirements stated in Section 2. However  implementation in commercial products would require

6

the mediator to be computationally tractable. The mediator interacts with users; hence a fast response
is of great importance. In general  since Equation (1) includes 2N summands  the computation of the
Shapley value in a cooperative game need not be tractable. Indeed  the computation often involves
marginal contribution nets [11  18]. In the following theorem we derive a closed-form formula for
calculating the display probabilities under the Shapley mediator  which allows it to compute the
display probabilities in linear time.
Theorem 3. Let X be a strategy proﬁle  and let σm
i (X) denote the m’th entry in the result of sorting
(σi(X1)  . . .   σi(XN )) in ascending order  preserving duplicate elements. The Shapley mediator
displays player j’s item to a user ui with probability

P (SM(X  ui) = j) =

i (X) − σm−1
σm
N − m + 1

i

(X)

 

(2)

i (X)(cid:88)

ρj

m=1

where σ0

i (X) = 0  and ρj

i (X) is an index such that σi(Xj) = σρj

i

i (X)

(X).

The Shapley mediator is implemented in Algorithm 1. As an input  it receives a strategy proﬁle and
a user  or equivalently user satisfaction levels from that strategy proﬁle. It outputs a player’s item
with a probability equal to her Shapley value in the cooperative game deﬁned above. Note that the
run-time of Algorithm 1 is linear in the number of players  i.e.  O(N ). A direct result from Theorem
3 and User-Independence (see Section 2) is that player payoffs can be calculated efﬁciently.
Corollary 3. In recommendation games with the Shapley mediator  the payoff of player j under the

strategy proﬁle X is given by πj(X) =(cid:80)n

(cid:80)ρj

i (X)−σm−1
σm
N−m+1

i (X)
m=1

(X)

.

i=1

i

To facilitate understanding of the Shapley mediator and its fast computation  we reconsider Example
1 above.
Example 2. Consider the game given in Example 1. According to the Shapley mediator  the display
probabilities of player 1 under the strategy proﬁle X = (l2  l3) are

P(SM (X  u1) = 1) =

P(SM (X  u2) = 1) =

P(SM (X  u3) = 1) =

2

1 (X) − σ0
σ1
2 (X) − σ0
σ1
3 (X) − σ0
σ1

2

1 (X)

2 (X)

3 (X)

2

=

=

+

= 0.4 

2

0.8 − 0
0.7 − 0
2
3 (X) − σ1
σ2

= 0.35 

3 (X)

1

0.1 − 0

2

+

=

0.9 − 0.1

1

= 0.85.

It follows that π1(l2  l3) = 8
10  and the proﬁle to be materialized is (l2  l3).
Indeed  it can be veriﬁed that this is the unique PNE of the corresponding game. Moreover  while the
unique PNE under TOP (see Example 1 in Section 2) results in a user utility of 2  the unique PNE
under the Shapley mediator results in user utility of

5 while π1(l1  l3) = 7

(σi(l2)P(SM ((l2  l3)  ui) = 1)) + (σi(l3)P(SM ((l2  l3)  ui) = 2)) = 2.145 > 2.

i=1

Hence  the users beneﬁt from the Shapley mediator is greater than from the TOP mediator. This is in
addition to the main property of the Shapley mediator  probabilistic selection according to the central
measure of fair allocation.

3(cid:88)

As analyzed in Subsection 2.1  Theorem 1 suggests that a mediator cannot satisfy both F and S if
P (M(X  ui) = j) is constant. One way of determining

Efﬁciency. The probability of displaying an item to ui is the maximal satisfaction level ui may

P (M(X  ui) = j) = σi(X).

5 Uniqueness of the Shapley mediator

it sets the probabilities such that(cid:80)N
(cid:80)N
obtain from the items chosen in X. Formally (cid:80)N

P (M(X  ui) = j) is deﬁned as follows.

j=1

j=1

j=1

7

Algorithm 1: Shapley Mediator
Input: A strategy proﬁle X = (X1  . . .   XN ) and a user ui
Output: An element from {∅  X1  . . .   XN}
1 Pick Y uniformly at random from (0  1)
2 if Y > maxj∈[N ] σi(Xj) then
3
4 else
5

return ∅
Return an element uniformly at random from {Xj | j ∈ [N ]  σi(Xj) ≥ Y }

Efﬁciency (for brevity  EF) binds player payoffs with the maximum satisfaction level of ui from the
items chosen by the players under X. It is well known [15  35] that the Shapley value is uniquely
characterized by properties equivalent to F and EF  when stated in terms of cooperative games. It is
therefore obvious that the Shapley mediator satisﬁes EF. 4 Thus  one would expect that the Shapley
mediator will be the only mediator that satisﬁes F and EF. This is  however  not the case: consider a
mediator that runs TOP w.p. σi(X) and NONE otherwise. Clearly  it satisﬁes F and EF. In fact 
given a mediator M satisfying F and Complete  we can deﬁne M(cid:48) such that
P (M(cid:48)(X  ui) = j) = P (M(X  ui) = j) · σi(X) 

(3)
thereby obtaining a mediator satisfying F and EF. The question of uniqueness then arises: is S
derived by satisfying F and EF? Or even more broadly  are there mediators that satisfy F  S and EF
besides the Shapley mediator? Had the answer been yes  this recipe for generating new mediators
would have allowed us to seek potentially better mediators  e.g.  one satisfying F  S and EF while
maximizing user utility. However  as we show next  the Shapley mediator is unique in satisfying F  S
and EF.
Theorem 4. The only mediator satisfying F  S and EF is the Shapley mediator.

6

Implications of strategic behavior

In this section we examine the implications of strategic behavior of the players on their payoffs and
user utility. Comprehensive treatment of the integration of multiple stakeholders into recommendation
calculations was discussed only recently [9]  and appears to be challenging. As our work is concerned
with strategic content providers  it is natural to consider the Price of Anarchy [24  34]  a common
inefﬁciency measure in non-cooperative games.

6.1 Player payoffs

scenario and the social welfare of the worst PNE. Formally  if EM ⊆(cid:81)

The Price of Anarchy  herein denoted P oA  measures the inefﬁciency in terms of social welfare  as a
result of selﬁsh behavior of the players. Speciﬁcally  it is the ratio between an optimal dictatorial
j Lj is the set of PNE proﬁles
maxX∈(cid:81)
minX∈EM V (X) ≥ 1. We use the subscript M to stress
induced by a mediator M  then P oAM =
that the P oAM depends on the mediator  through the deﬁnition of social welfare function V and
player payoffs. Notice that the P oA of a mediator that does not satisfy S can be unbounded  as a PNE
may not exist. Quantifying the P oA can be technically challenging; thus we restrict our analysis to
P oASM  the P oA of the Shapley mediator.
Theorem 5. P oASM ≤ 2N−1
Hence  under the Shapley mediator the social welfare of the players can decrease by at most a factor
of 2  when compared to an optimal solution.

N   and this bound is tight.

j Lj

V (X)

6.2 User utility

We now examine the implications of using the Shapley mediator on the users. For that  we shall
assume that the utility of a user from an item is his satisfaction level from that item. Namely  when

4 See the proof of Proposition 1 in the appendix. Leader Monotonicity  as opposed to the other fairness

properties  is not one of Shapley’s axioms but rather a byproduct of Shapley’s characterization.

8

n(cid:88)

N(cid:88)

UM(X) =

n(cid:88)

item l is displayed to ui  his utility is σi(l). As a result  the expected utility of the users under the
strategy proﬁle X and a mediator M is deﬁned by

P (M(X  ui) = j) σi(Xj) +

P (M(X  ui) = ∅) σi(∅).

i=1

j=1

i=1

Note that the ﬁrst term results from the displayed items  and the second term from the plain content of
the app (displaying no item at all). To quantify the inefﬁciency of user utility due to selﬁsh behavior
of the players under M  we deﬁne the User Price of Anarchy 

U P oAM =

maxM(cid:48) X∈ΠN

j=1Lj UM(cid:48)(X)

minX∈EM UM(X)

.

The U P oA serves as our benchmark for inefﬁciency of user utility. The nominator is the best possible
case: the user utility under any mediator M(cid:48) and any strategy proﬁle X. The denominator is the
worst user utility under M  where EM is again the set of PNE proﬁles induced by M. Note that the
nominator is independent of M. We ﬁrst treat users as having zero satisfaction when only the plain
content is displayed  i.e.  σi(∅) = 0  and consider the complementary case afterwards. The following
is a negative result for the Shapley mediator.
Proposition 2. The User PoA of the Shapley mediator  U P oASM  is unbounded.
Proposition 2 questions the applicability of the Shapley mediator. An unavoidable consequence of
its use is a potentially destructive effect on user utility. While content-provider fairness is essential 
users are the driving force of the RS. Therefore  one may advocate for other mediators that perform
better with respect to user utility  albeit not necessarily satisfying S. If S is discarded and a mediator
satisfying Complete adopted  would this result in better user utility? Unfortunately  other mediators
may lead to a similar decrease in user utility due to strategic behavior of the players  so there appears
to be no better solution in this regard.
Proposition 3. The User PoA of TOP  U P oATOP  is unbounded.
Using similar arguments  one can show that U P oABTL is unbounded as well.
In many situations  it is reasonable to assume that when no item is displayed to a user  his utility is
1. Namely  σi(∅) = 1 for every user ui. Indeed  this seems aligned with the ads-in-apps model: the
user is interrupted when an advertisement is displayed. We refer to this scenario as the optimal plain
content case. From here on  we adopt this perspective for upper-bounding the U P oA. Observe that
user utility is therefore maximized when no item is displayed whatsoever. Nevertheless  displaying
no item will also result in zero payoff for the players. Here too  U P oATOP is unbounded  while
U P oANONE = 1. The following lemma bounds the User P oA of the Shapley mediator.
Lemma 1. In the optimal plain content case  it holds that U P oASM ≤ 4.
In fact  numerical calculations show that U P oASM is bounded by 1.76  see the appendix for further
discussion.

7 Discussion

Our results are readily extendable in the following important direction (which is even further elabo-
rated in the appendix). In many online scenarios  content providers typically customize the items they
offer to accommodate speciﬁc individuals. Indeed  personalization is applied in a variety of ﬁelds in
order to improve user satisfaction. Speciﬁcally  consider the case where each player may promote a
set of items  where different items may be targeted towards different users  and the size of this set is
determined exogenously (e.g.  by her budget). In this case  a player selects a set of items which she
then provides to the mediator. Here the Shapley mediator satisﬁes F and S; the game induced by the
Shapley mediator is still a potential game  and the computation of the Shapley mediator still takes
linear time.

Acknowledgments

This project has received funding from the European Research Council (ERC) under the European
Union’s Horizon 2020 research and innovation programme (grant agreement n◦ 740435).

9

References
[1] P. Adamopoulos and A. Tuzhilin. On over-specialization and concentration bias of recommen-
dations: Probabilistic neighborhood selection in collaborative ﬁltering systems. In Proceedings
of the 8th ACM Conference on Recommender systems  pages 153–160. ACM  2014.

[2] R. Ben Basat  M. Tennenholtz  and O. Kurland. The probability ranking principle is not optimal
in adversarial retrieval settings. In Proceedings of the 2015 International Conference on The
Theory of Information Retrieval  pages 51–60. ACM  2015.

[3] O. Ben-Porat and M. Tennenholtz. Best response regression. In Advances in Neural Information

Processing Systems  pages 1498–1507  2017.

[4] O. Ben-Porat and M. Tennenholtz. Multi-unit facility location games. Accepted to Mathematics

of Operations Research  2018. Preliminary version appeared in WINE 2016.

[5] O. Ben-Porat and M. Tennenholtz. A game-theoretic approach to recommendation systems with
strategic content providers. arXiv preprint arXiv:1806.00955  2018. https://arxiv.org/
abs/1806.00955.

[6] E. Bozdag. Bias in algorithmic ﬁltering and personalization. Ethics and information technology 

15(3):209–227  2013.

[7] R. A. Bradley and M. E. Terry. Rank analysis of incomplete block designs: I. the method of

paired comparisons. Biometrika  39(3/4):324–345  1952.

[8] R. Burke. Multisided fairness for recommendation. arXiv preprint arXiv:1707.00093  2017.

[9] R. D. Burke  H. Abdollahpouri  B. Mobasher  and T. Gupta. Towards multi-stakeholder utility

evaluation of recommender systems. In UMAP (Extended Proceedings)  2016.

[10] M. Cary  A. Das  B. Edelman  I. Giotis  K. Heimerl  A. R. Karlin  S. D. Kominers  C. Mathieu 
and M. Schwarz. Convergence of position auctions under myopic best-response dynamics.
ACM Transactions on Economics and Computation  2(3):9  2014.

[11] G. Chalkiadakis  E. Elkind  and M. Wooldridge. Computational aspects of cooperative game
theory. Synthesis Lectures on Artiﬁcial Intelligence and Machine Learning  5(6):1–168  2011.

[12] F. Chierichetti  R. Kumar  S. Lattanzi  and S. Vassilvitskii. Fair clustering through fairlets. In

Advances in Neural Information Processing Systems  pages 5036–5044  2017.

[13] J. Cohen  A. Héliou  and P. Mertikopoulos. Learning with bandit feedback in potential games.
In Proceedings of the 31th International Conference on Neural Information Processing Systems 
2017.

[14] X. Deng and C. H. Papadimitriou. On the complexity of cooperative solution concepts. Mathe-

matics of Operations Research  19(2):257–266  1994.

[15] P. Dubey. On the uniqueness of the shapley value. International Journal of Game Theory  4(3):

131–139  1975.

[16] C. Dwork  M. Hardt  T. Pitassi  O. Reingold  and R. Zemel. Fairness through awareness.
In Proceedings of the 3rd Innovations in Theoretical Computer Science Conference  pages
214–226. ACM  2012.

[17] V. Garg and T. Jaakkola. Learning tree structured potential games. In Advances In Neural

Information Processing Systems  pages 1552–1560  2016.

[18] S. Ieong and Y. Shoham. Marginal contribution nets: a compact representation scheme for
coalitional games. In Proceedings of the 6th ACM Conference on Electronic Commerce  pages
193–202. ACM  2005.

[19] F. Kamiran  T. Calders  and M. Pechenizkiy. Discrimination aware decision tree learning. In
2010 IEEE 10th International Conference on Data Mining (ICDM)  pages 869–874. IEEE 
2010.

10

[20] T. Kamishima  S. Akaho  H. Asoh  and J. Sakuma. Enhancement of the neutrality in recommen-

dation. In Decisions@RecSys  pages 8–14  2012.

[21] T. Kamishima  S. Akaho  H. Asoh  and J. Sakuma. Fairness-aware classiﬁer with prejudice
remover regularizer. Machine Learning and Knowledge Discovery in Databases  pages 35–50 
2012.

[22] T. Kamishima  S. Akaho  H. Asoh  and J. Sakuma. Correcting popularity bias by enhancing

recommendation neutrality. In RecSys Posters  2014.

[23] T. Kamishima  K. Fukuchi  J. Sakuma  S. Akaho  and H. Asoh. Future directions of fairness-
In Invited talk:
aware data mining: Recommendation  causality  and theoretical aspects.
"ICML2015 Workshop: Fairness  Accountability  and Transparency in Machine Learning
(FATML)  pages 51–60  2015.

[24] E. Koutsoupias and C. Papadimitriou. Worst-case equilibria. In Annual Symposium on Theoreti-

cal Aspects of Computer Science  pages 404–413. Springer  1999.

[25] R. D. Luce. Individual choice behavior: A theoretical analysis. Courier Corporation  2005.

[26] N. Modani  D. Jain  U. Soni  G. K. Gupta  and P. Agarwal. Fairness aware recommendations
on behance. In Paciﬁc-Asia Conference on Knowledge Discovery and Data Mining  pages
144–155. Springer  2017.

[27] D. Monderer and L. S. Shapley. Potential games. Games and Economic Behavior  14(1):

124–143  1996.

[28] R. B. Myerson. Graphs and cooperation in games. Mathematics of Operations Research  2(3):

225–229  1977.

[29] E. Pariser. The ﬁlter bubble: What the Internet is hiding from you. Penguin UK  2011.

[30] D. Pedreshi  S. Ruggieri  and F. Turini. Discrimination-aware data mining. In Proceedings of
the 14th ACM SIGKDD International Conference on Knowledge Discovery and Data Mining 
pages 560–568. ACM  2008.

[31] L. Pizzato  T. Rej  T. Chung  I. Koprinska  and J. Kay. Recon: a reciprocal recommender for
online dating. In Proceedings of the Fourth ACM Conference on Recommender Systems  pages
207–214. ACM  2010.

[32] G. Pleiss  M. Raghavan  F. Wu  J. Kleinberg  and K. Q. Weinberger. On fairness and calibration.

In Advances in Neural Information Processing Systems  pages 5684–5693  2017.

[33] N. Raifer  F. Raiber  M. Tennenholtz  and O. Kurland. Information retrieval meets game theory:
The ranking competition between documents’ authors. In Proceedings of the 40th International
ACM SIGIR Conference on Research and Development in Information Retrieval  pages 465–474.
ACM  2017.

[34] T. Roughgarden. Intrinsic robustness of the price of anarchy. In Proceedings of the Forty-First

annual ACM Symposium on Theory of Computing  pages 513–522. ACM  2009.

[35] L. S. Shapley. A value for n-person games. Technical report  DTIC Document  1952.

[36] H. P. Young. Monotonic solutions of cooperative games. International Journal of Game Theory 

14(2):65–72  1985.

[37] H. Yu  C. Liu  and F. ZHANG. Reciprocal recommendation algorithm for the ﬁeld of recruitment.

Journal of Information & Computational Science  8(16):4061–4068  2011.

[38] R. Zemel  Y. Wu  K. Swersky  T. Pitassi  and C. Dwork. Learning fair representations. In
Proceedings of the 30th International Conference on Machine Learning (ICML-13)  pages
325–333  2013.

[39] Y. Zheng. Multi-stakeholder recommendation: Applications and challenges. arXiv preprint

arXiv:1707.08913  2017.

11

,Vladimir Vovk
Ivan Petej
Valentina Fedorova
Omer Ben-Porat
Moshe Tennenholtz