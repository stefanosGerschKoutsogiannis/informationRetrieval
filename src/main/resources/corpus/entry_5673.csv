2014,Transportability from Multiple Environments with Limited Experiments: Completeness Results,This paper addresses the problem of $mz$-transportability  that is  transferring causal knowledge collected in several heterogeneous domains to a target domain in which only passive observations and limited experimental data can be collected. The paper first establishes a necessary and sufficient condition for deciding the feasibility of $mz$-transportability  i.e.  whether causal effects in the target domain are estimable from the information available. It further proves that a previously established algorithm for computing transport formula is in fact complete  that is  failure of the algorithm implies non-existence of a transport formula. Finally  the paper shows that the do-calculus is complete for the $mz$-transportability class.,Transportability from Multiple Environments

with Limited Experiments: Completeness Results

Elias Bareinboim
Computer Science

UCLA

eb@cs.ucla.edu

Judea Pearl

Computer Science

UCLA

judea@cs.ucla.edu

Abstract

This paper addresses the problem of mz-transportability  that is  transferring
causal knowledge collected in several heterogeneous domains to a target domain
in which only passive observations and limited experimental data can be collected.
The paper ﬁrst establishes a necessary and sufﬁcient condition for deciding the
feasibility of mz-transportability  i.e.  whether causal effects in the target domain
are estimable from the information available. It further proves that a previously
established algorithm for computing transport formula is in fact complete  that is 
failure of the algorithm implies non-existence of a transport formula. Finally  the
paper shows that the do-calculus is complete for the mz-transportability class.

1 Motivation

The issue of generalizing causal knowledge is central in scientiﬁc inferences since experiments are
conducted  and conclusions that are obtained in a laboratory setting (i.e.  speciﬁc population  do-
main  study) are transported and applied elsewhere  in an environment that differs in many aspects
from that of the laboratory. If the target environment is arbitrary  or drastically different from the
study environment  no causal relations can be learned and scientiﬁc progress will come to a stand-
still. However  the fact that scientiﬁc experimentation continues to provide useful information about
our world suggests that certain environments share common characteristics and that  owed to these
commonalities  causal claims would be valid even where experiments have never been performed.
Remarkably  the conditions under which this type of extrapolation can be legitimized have not been
formally articulated until very recently. Although the problem has been extensively discussed in
statistics  economics  and the health sciences  under rubrics such as “external validity” [1  2]  “meta-
analysis” [3]  “quasi-experiments” [4]  “heterogeneity” [5]  these discussions are limited to verbal
narratives in the form of heuristic guidelines for experimental researchers – no formal treatment of
the problem has been attempted to answer the practical challenge of generalizing causal knowledge
across multiple heterogeneous domains with disparate experimental data as posed in this paper. The
lack of sound mathematical machinery in such settings precludes one of the main goals of machine
learning (and by and large computer science)  which is automating the process of discovery.
The class of problems of causal generalizability is called transportability and was ﬁrst formally
articulated in [6]. We consider the most general instance of transportability known to date that is
the problem of transporting experimental knowledge from heterogeneous settings to a certain spe-
ciﬁc target. [6] introduced a formal language for encoding differences and commonalities between
domains accompanied with necessary or sufﬁcient conditions under which transportability of em-
pirical ﬁndings is feasible between two domains  a source and a target; then  these conditions were
extended for a complete characterization for transportability in one domain with unrestricted exper-
imental data [7  8]. Subsequently  assumptions were relaxed to consider settings when only limited
experiments are available in the source domain [9  10]  further for when multiple source domains

1

with unrestricted experimental information are available [11  12]  and then for multiple heteroge-
neous sources with limited and distinct experiments [13]  which was called “mz-transportability”.1
Speciﬁcally  the mz-transportability problem concerns with the transfer of causal knowledge from a
heterogeneous collection of source domains Π = {π1  ...  πn} to a target domain π∗. In each domain
πi ∈ Π  experiments over a set of variables Zi can be performed  and causal knowledge gathered.
In π∗  potentially different from πi  only passive observations can be collected (this constraint will
be weakened). The problem is to infer a causal relationship R in π∗ using knowledge obtained in Π.
The problem studied here generalizes the one-dimensional version of transportability with limited
scope and the multiple dimensional with unlimited scope previously studied. Interestingly  while
certain effects might not be individually transportable to the target domain from the experiments in
any of the available sources  combining different pieces from the various sources may enable their
estimation. Conversely  it is also possible that effects are not estimable from multiple experiments in
individual domains  but they are from experiments scattered throughout domains (discussed below).
The goal of this paper is to formally understand the conditions causal effects in the target do-
main are (non-parametrically) estimable from the available data. Sufﬁcient conditions for “mz-
transportability” were given in [13]  but this treatment falls short of providing guarantees whether
these conditions are also necessary  should be augmented  or even replaced by more general ones.
This paper establishes the following results:

• A necessary and sufﬁcient condition for deciding when causal effects in the target domain
are estimable from both the statistical information available and the causal information
transferred from the experiments in the domains.
• A proof that the algorithm proposed in [13] is in fact complete for computing the transport
formula  that is  the strategy devised for combining the empirical evidence to synthesize
the target relation cannot be improved upon.

• A proof that the do-calculus is complete for the mz-transportability class.

2 Background in Transportability
In this section  we consider other transportability instances and discuss the relationship with the
mz-transportability setting. Consider Fig. 1(a) in which the node S represents factors that produce
differences between source and target populations. We conduct a randomized trial in Los Angeles
(LA) and estimate the causal effect of treatment X on outcome Y for every age group Z = z 
denoted by P (y|do(x)  z). We now wish to generalize the results to the population of New York
City (NYC)  but we ﬁnd the distribution P (x  y  z) in LA to be different from the one in NYC (call
the latter P ∗(x  y  z)). In particular  the average age in NYC is signiﬁcantly higher than that in LA.
How are we to estimate the causal effect of X on Y in NYC  denoted R = P ∗(y|do(x))? 2 3
The selection diagram – overlapping of the diagrams in LA and NYC – for this example (Fig. 1(a))
conveys the assumption that the only difference between the two populations are factors determining
age distributions  shown as S → Z  while age-speciﬁc effects P ∗(y|do(x)  Z = z) are invariant
across populations. Difference-generating factors are represented by a special set of variables called
selection variables S (or simply S-variables)  which are graphically depicted as square nodes ((cid:4)).
From this assumption  the overall causal effect in NYC can be derived as follows:

R = (cid:88)
= (cid:88)

z

P ∗(y|do(x)  z)P ∗(z)

P (y|do(x)  z)P ∗(z)

(1)

z

The last line constitutes a transport formula for R; it combines experimental results obtained in
LA  P (y|do(x)  z)  with observational aspects of NYC population  P ∗(z)  to obtain a causal claim
1Traditionally  the machine learning literature has been concerned about discrepancies among domains in
the context  almost exclusively  of predictive or classiﬁcation tasks as opposed to learning causal or counterfac-
tual measures [14  15]. Interestingly  recent work on anticausal learning leverages knowledge about invariances
of the underlying data-generating structure across domains  moving the literature towards more general modal-
ities of learning [16  17].

2We will use Px(y | z) interchangeably with P (y | do(x)  z).
3We use the structural interpretation of causal diagrams as described in [18  pp. 205] (see also Appendix 1).

2

Figure 1: (a) Selection diagram illustrating when transportability of R = P ∗(y|do(x)) between two
domains is trivially solved through simple recalibration. (b) The smallest diagram in which a causal
relation is not transportable. (c d) Selection diagrams illustrating the impossibility of estimating
R through individual transportability from πa and πb even when Z = {Z1  Z2}. If experiments
over {Z2} is available in πa and over {Z1} in πb  R is transportable.
(e f) Selection diagrams
illustrating opposite phenomenon – transportability through multiple domains is not feasible  but if
Z = {Z1  Z2} in one domain is. The selection variables S are depicted as square nodes ((cid:4)).

P ∗(y|do(x)) about NYC. In this trivial example  the transport formula amounts to a simple re-
calibration (or re-weighting) of the age-speciﬁc effects to account for the new age distribution. In
general  however  a more involved mixture of experimental and observational ﬁndings would be
necessary to obtain an unbiased estimate of the target relation R. In certain cases there is no way
to synthesize a transport formula  for instance  Fig. 1(b) depicts the smallest example in which
transportability is not feasible (even with X randomized). Our goal is to characterize these cases.
In real world applications  it may happen that only a limited amount of experimental information can
be gathered at the source environment. The question arises whether an investigator in possession of
a limited set of experiments would still be able to estimate the desired effects at the target domain.
To illustrate some of the subtle issues that mz-transportability entails  consider Fig. 1(c d) which
concerns the transport of experimental results from two sources ({πa  πb}) to infer the effect of X
on Y in π∗  R = P ∗(y|do(x)). In these diagrams  X may represent the treatment (e.g.  cholesterol
level)  Z1 represents a pre-treatment variable (e.g.  diet)  Z2 represents an intermediate variable (e.g. 
biomarker)  and Y represents the outcome (e.g.  heart failure). Assume that experimental studies
randomizing {Z2} can be conducted in domain πa and {Z1} in domain πb. A simple analysis can
show that R cannot be transported from either source alone (even when experiments are available
over both variables) [9]. Still  combining experiments from both sources allows one to determine
the effect in the target through the following transport formula [13]:

P (b)(z2|x  do(Z1))P (a)(y|do(z2))

P ∗(y|do(x)) = (cid:88)

z2

transport

the experimental

formula is a mixture of

(2)
result over {Z1} from πb 
This
P (b)(z2|x  do(Z1))  with the result of the experiment over {Z2} in πa  P (a)(y|do(z2))  and consti-
tute a consistent estimand of the target relation in π∗. Further consider Fig. 1(e f) which illustrates
the opposite phenomenon. In this case  if experiments over {Z2} are available in domain πa and
over {Z1} in πb  R is not transportable. However  if {Z1  Z2} are available in the same domain  say
πa  R is transportable and equals P (a)(y|x  do(Z1  Z2))  independently of the values of Z1 and Z2.
These intriguing results entail two fundamental issues that will be answered throughout this paper.
First  whether the do-calculus is complete relative to such problems  that is  whether it would always
ﬁnd a transport formula whenever such exists. Second  assuming that there exists a sequence of
applications of do-calculus that achieves the reduction required by mz-transportability  to ﬁnd such a
sequence may be computational intractable  so an efﬁcient way is needed for obtaining such formula.
3 A Graphical Condition for mz-transportability
The basic semantical framework in our analysis rests on structural causal models as deﬁned in [18 
pp. 205]  also called data-generating models. In the structural causal framework [18  Ch. 7]  actions
are modiﬁcations of functional relationships  and each action do(x) on a causal model M produces
a new model Mx = (cid:104)U  V  Fx  P (U)(cid:105)  where V is the set of observable variables  U is the set of
unobservable variables  and Fx is obtained after replacing fX ∈ F for every X ∈ X with a new
function that outputs a constant value x given by do(x).
We follow the conventions given in [18]. We denote variables by capital letters and their realized
values by small letters. Similarly  sets of variables will be denoted by bold capital letters  sets

3

YXZ(a)(b)YX(c)XYZ1Z2(d)XYZ1Z21XYZZ2XYZ1Z2(f)(e)of realized values by bold small letters. We use the typical graph-theoretic terminology with the
corresponding abbreviations De(Y)G  P a(Y)G  and An(Y)G  which will denote respectively the
set of observable descendants  parents  and ancestors of the node set Y in G. A graph GY will
denote the induced subgraph G containing nodes in Y and all arrows between such nodes. Finally 
GXZ stands for the edge subgraph of G where all arrows incoming into X and all arrows outgoing
from Z are removed.
Key to the analysis of transportability is the notion of identiﬁability [18  pp. 77]  which expresses
the requirement that causal effects are computable from a combination of non-experimental data P
and assumptions embodied in a causal diagram G. Causal models and their induced diagrams are
associated with one particular domain (i.e.  setting  population  environment)  and this representation
is extended in transportability to capture properties of two domains simultaneously. This is possible
if we assume that the structural equations share the same set of arguments  though the functional
forms of the equations may vary arbitrarily [7]. 4
Deﬁnition 1 (Selection Diagrams). Let (cid:104)M  M∗(cid:105) be a pair of structural causal models relative to
domains (cid:104)π  π∗(cid:105)  sharing a diagram G. (cid:104)M  M∗(cid:105) is said to induce a selection diagram D if D is
constructed as follows: every edge in G is also an edge in D; D contains an extra edge Si → Vi
whenever there might exist a discrepancy fi (cid:54)= f∗
In words  the S-variables locate the mechanisms where structural discrepancies between the two do-
mains are suspected to take place.5 Armed with the concept of identiﬁability and selection diagrams 
mz-transportability of causal effects can be deﬁned as follows [13]:
Deﬁnition 2 (mz-Transportability). Let D = {D(1)  ...  D(n)} be a collection of selection diagrams
relative to source domains Π = {π1  ...  πn}  and target domain π∗  respectively  and Zi (and Z∗)
z(cid:105) be the
be the variables in which experiments can be conducted in domain πi (and π∗). Let (cid:104)P i  I i
P i(v|do(z(cid:48)))  and
pair of observational and interventional distributions of πi  where I i
z(cid:105) be the observational and interventional distributions of π∗. The
in an analogous manner  (cid:104)P ∗  I∗
x(y) is said to be mz-transportable from Π to π∗ in D if P ∗
causal effect R = P ∗
x(y) is uniquely
z(cid:105) ∪ (cid:104)P ∗  I∗
i=1 ... n(cid:104)P i  I i

i or P (Ui) (cid:54)= P ∗(Ui) between M and M∗.

computable from(cid:83)

z(cid:105) in any model that induces D.

z =(cid:83)

Z(cid:48)⊆Zi

z(cid:105) and (cid:104)P i  I i

While this deﬁnition might appear convoluted  it is nothing more than a formalization of the state-
ment “R need to be uniquely computable from the information set IS alone.” Naturally  when IS
has many components (multiple observational and interventional distributions)  it becomes lengthy.
z(cid:105) from all sources has a syntactic image
This requirement of computability from (cid:104)P ∗  I∗
in the do-calculus  which is captured by the following sufﬁcient condition:
Theorem 1 ([13]). Let D = {D(1)  ...  D(n)} be a collection of selection diagrams relative to source
domains Π = {π1  ...  πn}  and target domain π∗  respectively  and Si represents the collection of
z(cid:105) be respectively the pairs
S-variables in the selection diagram D(i). Let {(cid:104)P i  I i
of observational and interventional distributions in the sources Π and target π∗. The effect R =
P ∗(y|do(x)) is mz-transportable from Π to π∗ in D if the expression P (y|do(x)  S1  ...  Sn) is
reducible  using the rules of the do-calculus  to an expression in which (1) do-operators that apply
to subsets of I i

z have no Si-variables or (2) do-operators apply only to subsets of I∗
z .

z(cid:105)} and (cid:104)P ∗  I∗

It is not difﬁcult to see that in Fig. 1(c d) (and also in Fig. 1(e f)) a sequence of applications of
the rules of do-calculus indeed reaches the reduction required by the theorem and yields a transport
formula as shown in Section 2. It is not obvious  however  whether such sequence exists in Fig.
2(a b) when experiments over {X} are available in πa and {Z} in πb  and if it does not exist  it is
also not clear whether this would imply the inability to transport. It turns out that in this speciﬁc
example there is not such sequence and the target relation R is not transportable  which means
that there exist two models that are equally compatible with the data (i.e.  both could generate the
same dataset) while each model entails a different answer for the effect R (violating the uniqueness
requirement of Def. 2). 6 To demonstrate this fact formally  we show the existence of two structural
4As discussed in the reference  the assumption of no structural changes between domains can be relaxed 
but some structural assumptions regarding the discrepancies between domains must still hold (e.g.  acyclicity).
5Transportability assumes that enough structural knowledge about both domains is known in order to sub-
stantiate the production of their respective causal diagrams. In the absence of such knowledge  causal discovery
algorithms might be used to infer the diagrams from data [19  18].

6This is usually an indication that the current state of scientiﬁc knowledge about the problem (encoded in
the form of a selection diagram) does not constraint the observed distributions in such a way that an answer is
entailed independently of the details of the functions and probability over the exogenous.

4

Figure 2: (a b) Selection diagrams in which is not possible to transport R = P ∗(y|do(x)) with
experiments over {X} in πa and {Z} in πb. (c d) Example of diagrams in which some paths need
to be extended for satisfying the deﬁnition of mz∗-shedge.

models M1 and M2 such that the following equalities and inequality between distributions hold 



M2 (X  Z  Y ) 
M2(X  Z  Y ) 

M1 (X  Z  Y ) = P (a)
P (a)
P (b)
M1(X  Z  Y ) = P (b)
M1 (Z  Y |do(X)) = P (a)
P (a)
M1(X  Y |do(Z)) = P (b)
P (b)
M1(X  Z  Y ) = P ∗
P ∗

M2(X  Z  Y ) 

M2 (Z  Y |do(X)) 
M2(X  Y |do(Z)) 

for all values of X  Z  and Y   and
M1(Y |do(X)) (cid:54)= P ∗
P ∗

M2(Y |do(X)) 

(3)

(4)

for some value of X and Y .
Let us assume that all variables in U ∪ V are binary. Let U1  U2 ∈ U be the common causes of X
and Y and Z and Y   respectively; let U3  U4 ∈ U be the random disturbances exclusive to Z and
Y   respectively  and U5  U6 ∈ U be extra random disturbances exclusive to Y . Let Sa and Sb index
the model in the following way: the tuples (cid:104)Sa = 1  Sb = 0(cid:105)  (cid:104)Sa = 0  Sb = 1(cid:105)  (cid:104)Sa = 0  Sb = 0(cid:105)
represent domains πa  πb  and π∗  respectively. Deﬁne the two models as follows:

 X = U1

 X = U1

M1 =

Z = U2 ⊕ (U3 ∧ Sa)
Y = ((X ⊕ Z ⊕ U1 ⊕ U2 ⊕ (U4 ∧ Sb))

∧U5) + (¬U5 ∧ U6)

M2 =

Z = U2 ⊕ (U3 ∧ Sa)
Y = ((Z ⊕ U2 ⊕ (U4 ∧ Sb))
∧U5) ⊕ (¬U5 ∧ U6)

where ⊕ represents the exclusive or function. Both models agree in respect to P (U)  which is
deﬁned as P (Ui) = 1/2  i = 1  ...  6. It is not difﬁcult to evaluate these models and note that the
constraints given in Eqs. (3) and (4) are indeed satisﬁed (including positivity)  the result follows. 7
Given that our goal is to demonstrate the converse of Theorem 1  we collect different examples of
non-transportability  as the previous one  and try to make sense whether there is a pattern in such
cases and how to generalize them towards a complete characterization of mz-transportability.
One syntactic subtask of mz-transportability is to determine whether certain effects are identiﬁable
in some source domains where interventional data is available. There are two fundamental results
developed for identiﬁability that will be relevant for mz-transportability as well. First  we should
consider confounded components (or c-components)  which were deﬁned in [20] and stand for a
cluster of variables connected through bidirected edges (which are not separable through the ob-
servables in the system). One key result is that each causal graph (and subgraphs) induces an unique
C-component decomposition ([20  Lemma 11]). This decomposition was indeed instrumental for
a series of conditions for ordinary identiﬁcation [21] and the inability to recursively decompose a
certain graph was later used to prove completeness.
Deﬁnition 3 (C-component). Let G be a causal diagram such that a subset of its bidirected arcs
forms a spanning tree over all vertices in G. Then G is a C-component (confounded component).

Subsequently  [22] proposed an extension of C-components called C-forests  essentially enforcing
that each C-component has to be a spanning forest and closed under ancestral relations [20].

7To a more sophisticated argument on how to evaluate these models  see proofs in appendix 3.

5

WUXZY(d)WYXZ(c)XY(b)Z(a)XZYDeﬁnition 4 (C-forest). Let G be a causal diagram where Y is the maximal root set. Then G is a
Y-rooted C-forest if G is a C-component and all observable nodes have at most one child.
For concreteness  consider Fig. 1(c) and note that there exists a C-forest over nodes {Z1  X  Z2} and
rooted in {Z2}. There exists another C-forest over nodes {Z1  X  Z2  Y } rooted in {Y }. It is also
the case that {Z2} and {Y } are themselves trivial C-forests. When we have a pair of C-forests as
{Z1  X  Z2} and {Z2} or {Z1  X  Z2  Y } and {Y } – i.e.  the root set does not intersect the treatment
variables; these structures are called hedges and identiﬁability was shown to be infeasible whenever
a hedge exists [22]. Clearly  despite the existence of hedges in Fig. 1(c d)  the effects of interest
were shown to be mz-transportable. This example is an indication that hedges do not capture in an
immediate way the structure needed for characterizing mz-transportability – i.e.  a graph might be a
hedge (or have a hedge as an edge sub–graph) but the target quantity might still be mz-transportable.
Based on these observations  we propose the following deﬁnition that may lead to the boundaries of
the class of mz-transportable relations:
Deﬁnition 5 (mz∗-shedge). Let D = (D(1)  . . .   D(n)) be a collection of selection diagrams rel-
ative to source domains Π = (π1  . . .   πn) and target domain π∗  respectively  Si represents the
collection of S-variables in the selection diagram D(i)  and let D(∗) be the causal diagram of π∗.
Let {(cid:104)P i  I i
z(cid:105)} be the collection of pairs of observational and interventional distributions of {πi} 
z(cid:105) be the observational and
where I i
interventional distributions of π∗  for Zi the set of experimental variables in πi. Consider a pair of
R-rooted C-forests F = (cid:104)F  F (cid:48)(cid:105) such that F (cid:48) ⊂ F   F (cid:48) ∩ X = ∅  F ∩ X (cid:54)= ∅  and R ⊆ An(Y)GX
(called a hedge [22]). We say that the induced collection of pairs of R-rooted C-forests over each
diagram  (cid:104)F (∗) F (1)  ... F (n)(cid:105)  is an mz-shedge for P ∗
z )
z   ...  I n
if they are all hedges and one of the following conditions hold for each domain πi  i = {∗  1  ...  n}:

P i(v|do(z(cid:48)))  and in an analogous manner  (cid:104)P ∗  I∗

x(y) relative to experiments (I∗

z =(cid:83)

Z(cid:48)⊆Zi

z   I 1

1. There exists at least one variable of Si pointing to the induced diagram F (cid:48)(i)  or
2. (F (i) \ F (cid:48)(i)) ∩ Zi is an empty set  or
3. The collection of pairs of C-forests induced over diagrams  (cid:104)F (∗) F (1)  . . .   F (i) \
i =

i   . . .  F (n)(cid:105)  is also an mz-shedge relative to (I∗
Z∗
(F (i) \ F (cid:48)(i)) ∩ Zi.

z )  where Z∗

z   ...  I i

  ...  I n

z   I 1

z\z∗

i

z1 x z2(y).

2 = P ∗

Furthermore  we call mz∗-shedge the mz-shedge in which there exist one directed path from R \
(R ∩ De(X)F ) to (R ∩ De(X)F ) not passing through X (see also appendix 3).
The deﬁnition of mz∗-shedge might appear involved  but it is nothing more than the articulation
of the computability requirement of Def. 2 (and implicitly the syntactic goal of Thm. 1) in a more
explicit graphical fashion. Speciﬁcally  for a certain factor Q∗
i needed for the computation of the
effect Q∗ = P ∗(y|do(x))  in at least one domain  (i) it should be enforced that the S-nodes are
separable from the inducing root set of the component in which Q∗
i belongs  and further  (ii) the
experiments available in this domain are sufﬁcient for solving Q∗
i . For instance  assuming we want
to compute Q∗ = P ∗(y|do(x)) in Fig. 1(c  d)  Q∗ can be decomposed into two factors  Q∗
1 =
P ∗
z1 x(z2) and Q∗
1  (i) holds true in πb and (ii)
the experiments available over Z1 are enough to guarantee the computability of this factor (similar
2) – i.e.  there is no mz∗-shedge and Q∗ is computable from the available data.
analysis applies to Q∗
Def. 5 also asks for the explicit existence of a path from the nodes in the root set R\(R∩ De(X)F )
to (R ∩ De(X)F )  a simple example can help to illustrate this requirement. Consider Fig. 2(c)
and the goal of computing Q = P ∗(y|do(x)) without extra experimental information. There ex-
ists a hedge for Q induced over {X  Z  Y } without the node W (note that {W} is a c-component
itself) and the induced graph G{X Z Y } indeed leads to a counter-example for the computability of
P ∗(z  y|do(x)). Using this subgraph alone  however  it would not be possible to construct a counter-
example for the marginal effect P ∗(y|do(x)). Despite the fact that P ∗(z  y|do(x)) is not computable
from P ∗(x  z  y)  the quantity P ∗(y|do(x)) is identiﬁable in G{X Z Y }  and so any structural model
compatible with this subgraph will generate the same value under the marginalization over Z from
P ∗(z  y|do(x)). Also  it might happen that the root set R must be augmented (Fig. 2(d))  so we
prefer to add this requirement explicitly to the deﬁnition. (There are more involved scenarios that

It is the case that for factor Q∗

6

.]

Zi

V\An(Y)D

Z  P (i)
Zi

.

V\Y P.

or F AIL(D  C0).

P I S W  DAn(Y)).

PROCEDURE TRmz(y  x P I S W  D)
INPUT: x  y: value assignments; P: local distribution relative to domain S (S = 0 indexes π∗) and active
experiments I; W: weighting scheme; D: backbone of selection diagram; Si: selection nodes in πi (S0 = ∅
relative to π∗); [The following set and distributions are globally deﬁned: Zi  P ∗  P (i)
OUTPUT: P ∗

x (y) in terms of P ∗  P ∗

if W (cid:54)= ∅  return TRmz(y  x ∪ w P I S W  D).
V\{Y X}

3 set W = (V \ X) \ An(Y)DX
4
5 if C(D \ X) = {C0} 
6
7
8

1 if x = ∅  returnP
2 if V \ An(Y)D (cid:54)= ∅  return TRmz(y  x ∩ An(Y)D P
if C(D \ X) = {C0  C1  ...  Ck}  returnP
Q
i TRmz(ci  v \ ci P I S W  D).
if C0 ∈ C(D)  returnQ
return TRmz(y  x ∩ C(cid:48) Q
if`(Si ⊥⊥ Y | X)
if |E| > 0  returnP|E|

if C(D) (cid:54)= {D} 
V\V
if (∃C(cid:48))C0 ⊂ C(cid:48) ∈ C(D) 
for {i|Vi ∈ C(cid:48)}  set κi = κi ∪ v(i−1)

else 
if I = ∅  for i = 0  ... |D| 

i|Vi∈C(cid:48) P(Vi|V (i−1)
∧ (Zi ∩ X (cid:54)= ∅)´  Ei = TRmz(y  x \ zi P  Zi ∩ X  i W  D \ {Zi ∩ X}).

∩ C(cid:48)  κi) I S W  C(cid:48)).

11
12
Figure 3: Modiﬁed version of identiﬁcation algorithm capable of recognizing mz-transportability.

else  FAIL(D  C0).

P/P

i=1 w(j)

i Ei.

(i)
D

\ C(cid:48).

P

D

P.

V\V

(i−1)
D

i|Vi∈C0

D

D

(i)
X

9
10



M1 =

we prefer to omit for the sake of presentation.) After adding the directed path from Z to Y that
passes through W   we can construct the following counter-example for Q:

X = U1
Z = U1 ⊕ U2
W = ((Z ⊕ U3) ∨ B) ⊕ (B ∧ (1 ⊕ Z))
Y = ((X ⊕ W ⊕ U2) ∧ A)

⊕ (A ∨ (1 ⊕ X ⊕ W ⊕ U2)) 

M2 =

X = U1
Z = U2
W = ((Z ⊕ U3) ∨ B) ⊕ (B ∧ (1 ⊕ Z))
Y = ((W ⊕ U2) ∧ A)

⊕ (A ∨ (1 ⊕ W ⊕ U2)) 



with P (Ui) = 1/2 ∀i  P (A) = P (B) = 1/2. It is not immediate to show that the two models
produce the desired property. Refer to Appendix 2 for a formal proof of this statement.
Given that the deﬁnition of mz∗-shedge is justiﬁed and well-understood  we can now state the
connection between hedges and mz∗-shedges more directly (the proof can be found in Appendix 3):
z = {}) 
Theorem 2. If there is a hedge for P ∗
there exists an mz∗-shedge for P ∗

x(y) in G and no experimental data is available (i.e.  I∗

x(y) in G.

z   I 1

z   ...  I n

z ) in D  R is not mz-transportable from Π to π∗ in D.

Whenever one domain is considered and no experimental data is available  this result states that a
mz∗-shedge can always be constructed from a hedge  which implies that we can operate with mz∗-
shedges from now on (the converse holds for Z = {}). Finally  we can concentrate on the most
general case of mz∗-shedges with experimental data in multiple domains as stated in the sequel:
Theorem 3. Let D = {D(1)  ...  D(n)} be a collection of selection diagrams relative to source
domains Π = {π1  ...  πn}  and target domain π∗  respectively  and {I i
z}  for i = {∗  1  ...  n}
deﬁned appropriately. If there is an mz∗-shedge for the effect R = P ∗
x(y) relative to experiments
(I∗
This is a powerful result that states that the existence of a mz∗-shedge precludes mz-transportability.
(The proof of this statement is somewhat involved  see the supplementary material for more details.)
For concreteness  let us consider the selection diagrams D = (D(a)  D(b)) relative to domains πa
and πb in Fig. 2(a b). Our goal is to mz-transport Q = P ∗(y|do(x)) with experiments over {X} in
πa and {Z} in πb. It is the case that there exists an mz∗-shedge relative to the given experiments.
To witness  ﬁrst note that F (cid:48) = {Y  Z} and F = F (cid:48) ∪ {X}  and also that there exists a selection
variable S pointing to F (cid:48) in both domains – the ﬁrst condition of Def. 5 is satisﬁed. This is a trivial
graph with 3 variables that can be solved by inspection  but it is somewhat involved to efﬁciently
evaluate the conditions of the deﬁnition in more intricate structures  which motivates the search for
a procedure for recognizing mz∗-shedges that can be coupled with the previous theorem.

7

4 Complete Algorithm for mz-transportability
There exists an extensive literature concerned with the problem of computability of causal relations
from a combination of assumptions and data [21  22  7  13]. In this section  we build on the works
that treat this problem by graphical means  and we concentrate particularly in the algorithm called
TRmz constructed in [13] (see Fig. 3) that followed some of the results in [21  22  7].
The algorithm TRmz takes as input a collection of selection diagrams with the corresponding ex-
perimental data from the corresponding domains  and it returns a transport formula whenever it is
able to produce one. The main idea of the algorithm is to leverage the c-component factorization
[20] and recursively decompose the target relation into manageable pieces (line 4)  so as to try to
solve each of them separately. Whenever this standard evaluation fails in the target domain π∗ (line
6)  TRmz tries to use the experimental information available from the target and source domains
(line 10). (For a concrete view of how TRmz works  see the running example in [13  pp. 7]. )
In a systematic fashion  the algorithm basically implements the declarative condition delineated in
Theorem 1. TRmz was shown to be sound [13  Thm. 3]  but there is no theoretical guarantee on
whether failure in ﬁnding a transport formula implies its non-existence and perhaps  the complete
lack of transportability. This guarantee is precisely what we state in the sequel.
Theorem 4. Assume TRmz fails to transport the effect P ∗
x(y) (exits with failure executing line 12).
Then there exists X(cid:48) ⊆ X  Y(cid:48) ⊆ Y  such that the graph pair D  C0 returned by the fail condition
of TRmz contains as edge subgraphs C-forests F  F’ that span a mz∗-shedge for P ∗

x(cid:48)(y(cid:48)).

Proof. Let D be the subgraph local to the call in which TRmz failed  and R be the root set of D. It
is possible to remove some directed arrows from D while preserving R as root  which result in a R-
rooted c-forest F . Since by construction F (cid:48) = F ∩ C0 is closed under descendents and only directed
arrows were removed  both F  F (cid:48) are C-forests. Also by construction R ⊂ An(Y)GX
together with
the fact that X and Y from the recursive call are clearly subsets of the original input. Before failure 
TRmz evaluated false consecutively at lines 6  10  and 11  and it is not difﬁcult to see that an S-node
points to F (cid:48) or the respective experiments were not able to break the local hedge (lines 10 and 11).
It remains to be showed that this mz-shedge can be stretched to generate a mz∗-shedge  but now the
same construction given in Thm. 2 can be applied (see also supplementary material).

x(y) is mz-transportable from Π to π∗ in D if and

Finally  we are ready to state the completeness of the algorithm and the graphical condition.
Theorem 5 (completeness). TRmz is complete.
Corollary 1 (mz∗-shedge characterization). P ∗
only if there is not mz∗-shedge for Px(cid:48)(y(cid:48)) in D for any X(cid:48) ⊆ X and Y(cid:48) ⊆ Y.
Furthermore  we show below that the do-calculus is complete for establishing mz-transportability 
which means that failure in the exhaustive application of its rules implies the non-existence of a
mapping from the available data to the target relation (i.e.  there is no mz-transport formula)  inde-
pendently of the method used to obtain such mapping.
Corollary 2 (do-calculus characterization). The rules of do-calculus together with standard proba-
bility manipulations are complete for establishing mz-transportability of causal effects.
5 Conclusions
In this paper  we provided a complete characterization in the form of a graphical condition for de-
ciding mz-transportability. We further showed that the procedure introduced in [1] for computing
the transport formula is complete  which means that the set of transportable instances identiﬁed by
the algorithm cannot be broadened without strengthening the assumptions. Finally  we showed that
the do-calculus is complete for this class of problems  which means that ﬁnding a proof strategy in
this language sufﬁces to solve the problem. The non-parametric characterization established in this
paper gives rise to a new set of research questions. While our analysis aimed at achieving unbiased
transport under asymptotic conditions  additional considerations need to be taken into account when
dealing with ﬁnite samples. Speciﬁcally  when sample sizes vary signiﬁcantly across studies  statis-
tical power considerations need to be invoked along with bias considerations. Furthermore  when
no transport formula exists  approximation techniques must be resorted to  for example  replacing
the requirement of non-parametric analysis with assumptions about linearity or monotonicity of cer-
tain relationships in the domains. The nonparametric characterization provided in this paper should
serve as a guideline for such approximation schemes.

8

References
[1] D. Campbell and J. Stanley. Experimental and Quasi-Experimental Designs for Research. Wadsworth

Publishing  Chicago  1963.

[2] C. Manski.

Identiﬁcation for Prediction and Decision. Harvard University Press  Cambridge  Mas-

sachusetts  2007.

[3] L. V. Hedges and I. Olkin. Statistical Methods for Meta-Analysis. Academic Press  January 1985.
[4] W.R. Shadish  T.D. Cook  and D.T. Campbell. Experimental and Quasi-Experimental Designs for Gen-

eralized Causal Inference. Houghton-Mifﬂin  Boston  second edition  2002.

[5] S. Morgan and C. Winship. Counterfactuals and Causal Inference: Methods and Principles for Social
Research (Analytical Methods for Social Research). Cambridge University Press  New York  NY  2007.
[6] J. Pearl and E. Bareinboim. Transportability of causal and statistical relations: A formal approach. In
W. Burgard and D. Roth  editors  Proceedings of the Twenty-Fifth National Conference on Artiﬁcial In-
telligence  pages 247–254. AAAI Press  Menlo Park  CA  2011.

[7] E. Bareinboim and J. Pearl. Transportability of causal effects: Completeness results. In J. Hoffmann and
B. Selman  editors  Proceedings of the Twenty-Sixth National Conference on Artiﬁcial Intelligence  pages
698–704. AAAI Press  Menlo Park  CA  2012.

[8] E. Bareinboim and J. Pearl. A general algorithm for deciding transportability of experimental results.

Journal of Causal Inference  1(1):107–134  2013.

[9] E. Bareinboim and J. Pearl. Causal transportability with limited experiments.

In M. desJardins and
M. Littman  editors  Proceedings of the Twenty-Seventh National Conference on Artiﬁcial Intelligence 
pages 95–101  Menlo Park  CA  2013. AAAI Press.

[10] S. Lee and V. Honavar. Causal transportability of experiments on controllable subsets of variables: z-
transportability. In A. Nicholson and P. Smyth  editors  Proceedings of the Twenty-Ninth Conference on
Uncertainty in Artiﬁcial Intelligence (UAI)  pages 361–370. AUAI Press  2013.

[11] E. Bareinboim and J. Pearl. Meta-transportability of causal effects: A formal approach. In C. Carvalho
and P. Ravikumar  editors  Proceedings of the Sixteenth International Conference on Artiﬁcial Intelligence
and Statistics (AISTATS)  pages 135–143. JMLR W&CP 31  2013.

[12] S. Lee and V. Honavar. m-transportability: Transportability of a causal effect from multiple environments.
In M. desJardins and M. Littman  editors  Proceedings of the Twenty-Seventh National Conference on
Artiﬁcial Intelligence  pages 583–590  Menlo Park  CA  2013. AAAI Press.

[13] E. Bareinboim  S. Lee  V. Honavar  and J. Pearl. Transportability from multiple environments with limited
experiments. In C.J.C. Burges  L. Bottou  M. Welling  Z. Ghahramani  and K.Q. Weinberger  editors 
Advances in Neural Information Processing Systems 26  pages 136–144. Curran Associates  Inc.  2013.

[14] H. Daume III and D. Marcu. Domain adaptation for statistical classiﬁers. Journal of Artiﬁcial Intelligence

Research  26:101–126  2006.

[15] A.J. Storkey. When training and test sets are different: characterising learning transfer. In J. Candela 
M. Sugiyama  A. Schwaighofer  and N.D. Lawrence  editors  Dataset Shift in Machine Learning  pages
3–28. MIT Press  Cambridge  MA  2009.

[16] B. Sch¨olkopf  D. Janzing  J. Peters  E. Sgouritsa  K. Zhang  and J. Mooij. On causal and anticausal
In J Langford and J Pineau  editors  Proceedings of the 29th International Conference on

learning.
Machine Learning (ICML)  pages 1255–1262  New York  NY  USA  2012. Omnipress.

[17] K. Zhang  B. Sch¨olkopf  K. Muandet  and Z. Wang. Domain adaptation under target and conditional
shift. In Proceedings of the 30th International Conference on Machine Learning (ICML). JMLR: W&CP
volume 28  2013.

[18] J. Pearl. Causality: Models  Reasoning  and Inference. Cambridge University Press  New York  2000.

2nd edition  2009.

[19] P. Spirtes  C.N. Glymour  and R. Scheines. Causation  Prediction  and Search. MIT Press  Cambridge 

MA  2nd edition  2000.

[20] J. Tian. Studies in Causal Reasoning and Learning. PhD thesis  Department of Computer Science 

University of California  Los Angeles  Los Angeles  CA  November 2002.

[21] J. Tian and J. Pearl. A general identiﬁcation condition for causal effects. In Proceedings of the Eighteenth
National Conference on Artiﬁcial Intelligence  pages 567–573. AAAI Press/The MIT Press  Menlo Park 
CA  2002.

[22] I. Shpitser and J. Pearl. Identiﬁcation of joint interventional distributions in recursive semi-Markovian
causal models. In Proceedings of the Twenty-First National Conference on Artiﬁcial Intelligence  pages
1219–1226. AAAI Press  Menlo Park  CA  2006.

9

,Jamie Shotton
Toby Sharp
Pushmeet Kohli
Sebastian Nowozin
John Winn
Antonio Criminisi
Elias Bareinboim
Judea Pearl
Tong Yang
Xiangyu Zhang
Zeming Li
Wenqiang Zhang
Jian Sun