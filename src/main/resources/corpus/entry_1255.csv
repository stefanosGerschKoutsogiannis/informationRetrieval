2019,Cross-sectional Learning of Extremal Dependence among Financial Assets,We propose a novel probabilistic model to facilitate the learning of multivariate tail dependence of multiple financial assets. Our method allows one to construct from known random vectors  e.g.  standard normal  sophisticated joint heavy-tailed random vectors featuring not only distinct marginal tail heaviness  but also flexible tail dependence structure. The novelty lies in that pairwise tail dependence between any two dimensions is modeled separately from their correlation  and can vary respectively according to its own parameter rather than the correlation parameter  which is an essential advantage over many commonly used methods such as multivariate $t$ or elliptical distribution. It is also intuitive to interpret  easy to track  and simple to sample comparing to the copula approach. We show its flexible tail dependence structure through simulation. Coupled with a GARCH model to eliminate serial dependence of each individual asset return series  we use this novel method to model and forecast multivariate conditional distribution of stock returns  and obtain notable performance improvements in multi-dimensional coverage tests. Besides  our empirical finding about the asymmetry of tails of the idiosyncratic component as well as the market component is interesting and worth to be well studied in the future.,Cross-sectional Learning of Extremal Dependence

among Financial Assets

Xing Yan

School of Data Science

City University of Hong Kong

yanxing128@gmail.com

Qi Wu∗

School of Data Science

City University of Hong Kong

qiwu55@cityu.edu.hk

Wen Zhang
JD Digits

zhangwen.jd@gmail.com

Abstract

We propose a novel probabilistic model to facilitate the learning of multivariate
tail dependence of multiple ﬁnancial assets. Our method allows one to construct
from known random vectors  e.g.  standard normal  sophisticated joint heavy-
tailed random vectors featuring not only distinct marginal tail heaviness  but also
ﬂexible tail dependence structure. The novelty lies in that pairwise tail dependence
between any two dimensions is modeled separately from their correlation  and
can vary respectively according to its own parameter rather than the correlation
parameter  which is an essential advantage over many commonly used methods
such as multivariate t or elliptical distribution. It is also intuitive to interpret  easy
to track  and simple to sample comparing to the copula approach. We show its
ﬂexible tail dependence structure through simulation. Coupled with a GARCH
model to eliminate serial dependence of each individual asset return series  we use
this novel method to model and forecast multivariate conditional distribution of
stock returns  and obtain notable performance improvements in multi-dimensional
coverage tests. Besides  our empirical ﬁnding about the asymmetry of tails of the
idiosyncratic component as well as the market component is interesting and worth
to be well studied in the future.

1

Introduction

Extreme market movements and rare events  which we call tail risk  play a very important role in
portfolio investments  institutional risk management  and ﬁnancial regulation. For a single asset  there
has been a large body of literature concluding that the asset return follows non-normal distribution
with signiﬁcant heavy tails. A further complication is that the joint multiple asset return often exhibits
nonnegligible tail dependence  which implies a higher chance of extreme co-movements than in the
joint normal case or the independence case. Realizing that much effort has been made on univariate
heavy tail modeling  it is in great need of specially designed models for multivariate tail dependence.
To measure tail dependence  the most common deﬁnition of the down-tail dependence coefﬁcient of
two random variables X and Y is deﬁned as (see [Frahm et al.  2005]):

(1)

λD
X Y = lim
τ→0+

P{X < QX (τ )  Y < QY (τ )}/τ 

where QX (τ ) and QY (τ ) are τ-quantiles of marginal distributions of X and Y respectively. Sim-
X Y = limτ→1− P{X > QX (τ )  Y >
ilarly  the up-tail dependence coefﬁcient is deﬁned as: λU
QY (τ )}/(1 − τ ). The tail dependence coefﬁcient measures the degree of extremal  not typical  co-
movements between two random variables. It is beyond the usual correlation which is a measure of
average dependence. The reason why we should need tail dependence modeling is that the correlation

∗Corresponding author.

33rd Conference on Neural Information Processing Systems (NeurIPS 2019)  Vancouver  Canada.

is limited in assessing extreme dependence risk during ﬁnancial crisis [Poon et al.  2003]. Ignoring
tail dependence will also incur the huge volume of mis-pricing of credit derivatives that may cause
disasters [Peng and Kou  2009]. Actually  researchers have designed a systemic risk indicator using
tail dependence and predicted well crisis-period stock returns [Balla et al.  2014]. Thus it is of great
importance to the regulatory agencies. Besides  tail dependence of multivariate data is a general
problem. It appears not only in ﬁnancial markets  but also in energy markets [Aderounmu and Wolff 
2014]  climatic data [Schoelzel and Friederichs  2008]  and hydrological data [Poulin et al.  2007].
The correlation also affects tail dependence since it is an average measure. But if one can separate
the effect of correlation  should tail dependencies be different for different pairs of assets? Before
ﬁguring out this problem  let us review some existing approaches for modeling tail dependence. First 
two normally distributed random variables with non-zero correlation have no tail dependence (the
up/down-tail dependence coefﬁcient is 0). So multivariate normal distribution may not be appropriate
for modeling ﬁnancial markets. Successful attempts to alleviate this shortcoming include switching
to non-Gaussian multivariate distributions such as t and elliptical  as well as resorting to the copula
approach for constructing non-trivial dependence structures.
Multivariate t is a direct extension of univariate t-distribution. Its parameter  the degrees of freedom 
represents tail heaviness of each individual dimension and controls pairwise tail dependence as well.
Although it is non-zero  the tail dependence coefﬁcient is the same for each pair of dimensions
when removing the correlation  and for up and down sides (see [Chan and Li  2008]). Elliptical
distribution is a more general distribution family than multivariate t is. It covers lots of known
distribution families including multivariate t  Laplace  power exponential  Kotz distribution  etc. From
[Lesniewski et al.  2016]  the tail dependence coefﬁcient of elliptical distribution is mathematically
difﬁcult to be expressed exactly. But like multivariate t  its pairwise tail dependence coefﬁcients vary
only according to pairwise correlations. There are no freedoms for tail dependencies themselves.
Copula approach is ﬂexible enough to describe many tail dependence structures theoretically (see
introductions in [Demarta and McNeil  2005]  [Embrechts et al.  2001]  and [Aas et al.  2009]). There
has been some literature using copula to model tail dependence of ﬁnancial returns  such as [Jondeau
and Rockinger  2006] and [Frahm et al.  2005]. But most of them only deal with two markets or two
assets. This is due to the mathematical complexity of copula when modeling three or more variables.
Some other approaches model tail dependence of assets using non-parametric method or quantile
regression  see [Poon et al.  2003] and [Beine et al.  2010].
So far  no ﬂexible but compact tail dependence model for multiple assets exists. Noticing that joint
extreme events come from not only joint daily ﬂuctuation of asset prices but also some tail shock that
has widespread impacts (e.g.  the collapse of Lehman Brothers)  we realize that it is quite necessary to
model tail dependence separately from the correlation. This is also more realistic if we look at assets
having different ﬁnancial fundamentals  or coming from different sectors or asset classes. While their
pairwise correlations are deﬁnitely different  their pairwise tail dependencies should be different too.
In this paper  we solve the problem by proposing a transformation of some known random vector.
The resulting new random vector has distinct marginal tail heaviness. More importantly  the novelty
lies in that pairwise tail dependence of any two dimensions can vary according to its own parameter
rather than the correlation parameter. So tail dependence is modeled separately from the correlation.
We show its ﬂexible tail dependence structure through simulation. We also propose an intuitive
learning algorithm to ﬁt the novel model with data. Coupled with a GARCH ﬁlter to describe
the conditional multivariate distribution of asset returns  we evaluate our model by doing multi-
dimensional coverage tests on the forecasts of conditional distribution and achieve better performances
than all the competitors do.

2 Lower-triangular Tail Dependence Model

In [Yan et al.  2018]  researchers proposed a novel parametric quantile function to represent a
univariate distribution with asymmetrical heavy tails  and used it to model the time-varying conditional
distribution of single asset returns. It is a monotonically increasing nonlinear transformation of the
quantile function of some known distribution Zτ   τ ∈ (0  1):

Q(τ|µ  σ  u  v) = µ + σZτ

+ 1

+ 1

 

A

(2)

(cid:19)(cid:18) e−vZτ

(cid:19)

(cid:18) euZτ

A

2

(cid:18) uZτ

v−Zτ
A

+

A

(cid:19)

where Zτ can come from standard normal  t-distribution  or some other distribution. The resulting
parametric function Q(τ|µ  σ  u  v) is a quantile function too  meaning its inverse function exists and
is a distribution. u ≥ 0 and v ≥ 0 control its right and left-tail heaviness respectively. If in the usual
case where Zτ is standard normal  this new quantile function has an inverted S-shaped Q-Q plot
against standard normal so that it can represent heavy-tailed distribution. In this paper  we propose a
simpler form:

Q(τ|µ  σ  u  v) = µ + σZτ

+ 1

(3)
Now u ≥ 1 and v ≥ 1 are forced. g is used for simplifying the notation. This produces very similar
heavy tail effects and makes the tail heaviness less sensitive to u and v when they become large 
which is good for numerical computing and analysis.
Then we argue that this is equivalent to making the same transformation to the corresponding known
random variable z: y = µ + σg(z|u  v). The new random variable y has quantile function being
exactly Equation (3)  because of the following lemma:

:= µ + σg(Zτ|u  v).

Lemma 1 If X is a continuous random variable and has continuous quantile function QX (τ ) 
τ ∈ (0  1). Y is a function of X: Y = f (X)  where f is continuous and strictly increasing. Then Y
has quantile function QY (τ ) = f (QX (τ )).

This inspires us to extend the univariate heavy-tailed quantile function in Equation (3) to the multi-
variate case by transforming random variables. Recall that a set of i.i.d. standard normal random
variables z = [z1  . . .   zn](cid:62) can compose any multivariate normal random vector by linear combina-
tion: µ + Bz  where µ is the mean vector and one can restrict B to be a lower triangular matrix with
strictly positive diagonal entries. We make a direct extension to this and propose a new random vector
y = [y1  . . .   yn](cid:62) with individual heavy tails and pairwise tail dependencies by transforming the
latent i.i.d. random variables z = [z1  . . .   zn](cid:62) (zi can follow standard normal  t-distribution  etc.):

y1 = µ1 + σ11g(z1|u11  v11) 
y2 = µ2 + σ21g(z1|u21  v21) + σ22g(z2|u22  v22) 
. . .

yn = µn + σn1g(z1|un1  vn1) + σn2g(z2|un2  vn2) + ··· + σnng(zn|unn  vnn).

(4)

Here σii > 0  uij ≥ 1 and vij ≥ 1. A is a positive constant satisfying A ≥ 3 (see [Wu and
Yan  2019]). We set A = 4 in this paper. Now we have totally n location parameters µ1  . . .   µn 
(n2 +n)/2 usual correlation/scale parameters σ11  σ21  σ22  . . .   σnn  (n2 +n)/2 right-tail parameters
u11  u21  u22  . . .   unn  and (n2 + n)/2 left-tail parameters v11  v21  v22  . . .   vnn. The total number
of parameters is n + 3(n2 + n)/2.
Our transformation is analogous to µ + Bz but we add different tail heaviness for every zj in every
yi  i.e.  zj is replaced by g(zj|uij  vij) in the equation of yi (j ≤ i). Because y1 and y2 both have
the latent variable z1  they are correlated and have tail dependence as well. Intuitively  the new
random vector y has marginally different tail heaviness and distinct pairwise tail dependencies 
which will be veriﬁed by us later. In addition  to make the model robust  sometimes we may want
to reduce the number of parameters in Equation (4). One effective way to achieve this is to force
u11 = ui1  v11 = vi1 ∀i ≥ 1  u22 = ui2  v22 = vi2 ∀i ≥ 2  and so on. Now the total number of
parameters is reduced to 3n + (n2 + n)/2.

2.1 Pairwise Tail Dependencies

We have realized that it is challenging to obtain the exact tail dependence coefﬁcients for pairs of
dimensions of our proposed lower-triangular y. So in this subsection  we qualitatively show that y has
distinct pairwise tail dependencies. To reveal that  we numerically approximate the tail dependencies
of y1 & y2 and y2 & y3  and analyze how they depend on model parameters. Noticing that the
deﬁnition in Equation (1) is a limit  we approximate the down-tail dependence coefﬁcient of yi &
ij (τ ) = P{yi < Qyi(τ )  yj < Qyj (τ )}/τ as the proxy
yj by choosing a very small τ and using λD
down-tail dependence. We set τ = 10−3  simulate 107 observations of yi and yj  and calculate the
empirical value of λD

ij (τ ). The latent z is standard normal in this analysis.

3

Figure 1: The plots of proxy down-tail dependencies (blue lines) and correlations (red lines) against
varying model parameters (only one varies every time). The two subplots above are those of the
pair y1 & y2 and the two blow are those of the pair y2 & y3. We change the parameters σ21 and v21
respectively for the pair y1 & y2 and change the parameters σ32 and v32 for the pair y2 & y3.

12(τ ) and λD

We ﬁrst set µi = 0  σii = 1  σij = 0.5 (i > j)  uii = 1  and vii = 1.5 for a 3-dimensional y of
ours  and then change the value of one of these parameters every time to examine how the proxy
down-tail dependencies λD
23(τ ) change accordingly. To distinguish tail dependence from
usual correlation  we also examine how the usual correlation coefﬁcients change accordingly. The
results are shown in Figure 1. In the ﬁrst subplot of Figure 1  when σ21 varies  λD
12(τ ) varies (blue
line) in a much similar way as the usual correlation of y1 & y2 does (red line). This is a sign that
the varying λD
12(τ ) can be attributed to the effect of varying correlation. So σ21 is the parameter that
determines mainly the usual correlation. In the second subplot where v21 varies  the proxy down-tail
dependence λD
12(τ ) changes nearly from 0 to 1 while the correlation stays nearly the same. This
makes us conclude that v21 is the dominant parameter determining the down-tail dependence of
y1 & y2 separately from the correlation. The same analysis applies to the pair of y2 & y3  whose
results are shown in the third and fourth subplots of Figure 1  where one can see σ32 determines usual
correlation and v32 determines down-tail dependence of y2 & y3.
Our ﬁndings are consistent with our intuition about the tail dependence structure of y. It can be
extended that vij is the parameter that determines mainly the down-tail dependence of yi & yj. It
also applies to the up-tail dependence situation  where uij determines that of yi & yj. Thus  our
lower-triangular tail dependence model has a rather rich structure of tail dependence comparing
to the commonly used multivariate normal  multivariate t  and elliptical distribution. We will also
experimentally verify this in Section 4. Note that vi1  vi2  . . .   vij should all contribute to the down-
tail dependence of yi & yj because they share the same latent z1  . . .   zj. We believe vij is the freest
and dominant one that determines  because others contribute to that of yi & yj−1 as well. Besides 
we neglected an important situation in which the correlation parameter σij is negative. Negative
correlation will lead to negative tail dependence. Different from the positive tail dependence we focus
in this paper  it measures the dependence when one variable goes to positive extreme and the other
goes to negative extreme  or vice versa  which is also common in ﬁnancial markets. But fortunately 
our above analysis also applies well and similar conclusions can be made.

2.2 One-factor Tail Dependence Model

Real world data is usually high-dimensional. In high-dimensional case  normally we need to simplify
the model structure and reduce the number of parameters. This is also the idea behind factor analysis
or principal components analysis. In ﬁnance  there are also factor models for asset returns. In
this subsection  we propose a one-factor version of our tail dependence model for relatively high
dimensional asset returns and we do not consider the asset pricing problem at this moment. Our
one-factor model is a special case of the lower-triangular one in Equation (4).

4

0.511.522.533.544.552100.20.40.60.81Proxy Down Tail Dependence11.21.41.61.822.22.42.62.83v2100.20.40.60.81Proxy Down Tail Dependence0.511.522.533.544.553200.20.40.60.81Proxy Down Tail Dependence11.21.41.61.822.22.42.62.83v3200.20.40.60.81Proxy Down Tail Dependence4:
5:

6:

(7)

(8)

Algorithm 1 Algorithm for learning parameters of our proposed tail dependence model with data.
Input: K observations {y:k}K
Parameters: The positive constant A ≥ 3 and the ﬁne set of probability levels Ψ ⊂ (0  1).
Output: All parameters µi  σij  uij  vij(i ≥ j) in our model.
1: for i = 1  . . .   n do
2:
3:

k=1. yik is the i-th entry of the column vector y:k.

for j = 1  . . .   i − 1 do

Solve the following equation system to get the learned ˆσij  ˆuij  ˆvij:
jkg(zjk|uij  vij) 
zl

jk = σij

yikzl

(cid:88)K

l = 1  3  5.

(6)

1
K

k=1

end for
Let y(cid:48)
regression problem to get the learned ˆµi  ˆσii  ˆuii  ˆvii:

j=1 ˆσijg(zjk|ˆuij  ˆvij)  k = 1  . . .   K. Solve the following quantile

(cid:88)K
ik = yik −(cid:80)i−1

1
K

k=1

K(cid:88)

(cid:88)

k=1

τ∈Ψ

min

µi σii uii vii

1
K

Lτ (y(cid:48)

ik  Q(τ|µi  σii  uii  vii)).

Solve the following equation to obtain realizations of zi  i.e.  zi1  . . .   ziK:

ik = ˆµi + ˆσiig(zik|ˆuii  ˆvii).
y(cid:48)

7: end for
8: return learned parameters ˆµi  ˆσij  ˆuij  ˆvij(i ≥ j).

For a market-wide or common variable yM   and n single-asset or individual variables y1  . . .   yn  we
model them as:

yM = αM + βM g(zM|uM   vM ) 
yi = αi + βig(zM|uM

i

i ) + γig(zi|ui  vi) 
  vM

i = 1  . . .   n.

(5)

zM   z1  . . .   zn are latent i.i.d. random variables  e.g.  standard normal. In ﬁnancial context  yM can
be the market return like S&P 500 (ﬁltered by a GARCH-type model ﬁrst  see our description later) 
and uM or vM represents its up or down heavy tail. zM is the market factor which is shared by every
asset return yi (after ﬁltering too). yi is decomposed into the market component and the idiosyncratic
component. While βi is the average sensitivity of the i-th asset to the market factor  uM
can
be seen as the tail-side sensitivities of the i-th asset. They cause all yi to have correlation-separated
tail dependencies with yM   as well as with each other. An extremal realization of zM will cause more
additional impact on yi that cannot be captured by βi solely  which is an average-type sensitivity. And
increases. The idiosyncratic component γig(zi|ui  vi) of
the tail dependence increases as uM
each asset is also heavy-tailed  and ui  vi represent idiosyncratic heavy tails. In this paper  although
we focus on ﬁnancial modeling  this model can be applied to other ﬁelds too.

i and vM
i

i or vM
i

3 Parameter Learning

We propose a recursive-type learning algorithm to ﬁt the proposed tail dependence model with data.
This algorithm works for any choice of z. It is a combination of quantile regression and method of
moments. Because the one-factor version is a special case of the lower-triangular model  we only
need to consider the learning algorithm for the lower-triangular model. The modiﬁcations we should
make when applying to the one-factor version are straightforward. Suppose we have K observations
{y:k}K
k=1  where y:k is a column vector and yik is its i-th entry. From the y1 equation in Equation
(4)  we can conclude that y1 has quantile function being in the form of Equation (3). So quantile
regression [Koenker and Hallock  2001] can be applied to learn the parameters of y1 when a ﬁne set
of probability levels Ψ ⊂ (0  1) is chosen:

min

µ1 σ11 u11 v11

1
K

K(cid:88)

(cid:88)

k=1

τ∈Ψ

Lτ (y1k  Q(τ|µ1  σ11  u11  v11)).

(9)

5

Here Lτ is the loss function in quantile regression between the observation and τ-quantile:
Lτ (y  q) = (τ − I(y < q))(y − q)  where I is indicator function. Please see [Yan et al.  2018] for an
introduction of multi-quantile regression with a parametric quantile function. In our paper  we set
Ψ = {0.01  0.02  . . .   0.98  0.99} with 99 probability levels. Other smaller set that covers the interval
(0  1) sufﬁciently is also acceptable  e.g.  {0.01  0.05  0.1  . . .   0.9  0.95  0.99} with 21 levels.
After solving the above optimization to get the learned parameters ˆµ1  ˆσ11  ˆu11  ˆv11  one can inverse
the y1 equation in Equation (4) to obtain realizations of z1 from y1k. We denote them by z11  . . .   z1K.
Then  to learn the parameters of y2  we multiply by z1 on both sides of the y2 equation in Equation
(4) and take expectations. Noticing that z1 and z2 are independent and E[z1] = 0  we have
E[y2z1] = σ21E[z1g(z1|u21  v21)]. Replacing expectations by empirical averages leads to:

1
K

y2kz1k = σ21

1
K

k=1

z1kg(z1k|u21  v21).

(10)

This is one equation with three unknowns σ21  u21  v21. If multiplying both sides by z3
instead  we obtain two more equations:

1 and z5
1

(cid:88)K

(cid:88)K

(cid:88)K

k=1

(cid:88)K

k=1

1
K

y2kzl

1k = σ21

1
K

k=1

1kg(z1k|u21  v21) 
zl

l = 3  5.

(11)

Solving the above three equations jointly gives us the learned parameters ˆσ21  ˆu21  ˆv21.
2 = y2− σ21g(z1|u21  v21) = µ2 + σ22g(z2|u22  v22)
After this  we consider a new random variable y(cid:48)
2k = y2k − ˆσ21g(z1k|ˆu21  ˆv21). And its quantile function is exactly in the
whose realizations are y(cid:48)
form of Equation (3)  or speciﬁcally  is Q(τ|µ2  σ22  u22  v22). So we can again apply quantile
regression like in Equation (9) to learn µ2  σ22  u22  v22. Actually  all the remaining parameters of
y3  . . .   yn can be learned one by one following the same procedure. We summarize all the steps
in Algorithm 1. Note that if one wants to reduce the number of parameters and restrict u11 = ui1 
v11 = vi1  ∀i ≥ 1  u22 = ui2  v22 = vi2  ∀i ≥ 2  and so on  there will be only one equation and one
unknown σij in Equation (6).

3.1 Modeling Multivariate Asset Returns

Suppose we have n assets and their returns in T days are rit  i = 1  . . .   n  t = 1  . . .   T . To model
the conditional distribution of [r1t  . . .   rnt](cid:62) using information up to time t − 1  we cannot ignore
the serial dependence of each individual return series. The most recognized serial dependence of
single asset returns is volatility clustering  which can be well captured by a GARCH-type model
[Engle  1982][Bollerslev  1986]. We ﬁrst adopt a AR(1)-GARCH(1 1)-like model to describe each
asset return series individually:

rt = µt + σtεt 
µt = γ0 + γ1rt−1 
σ2
t = β0 + β1(σt−1εt−1)2 + β2σ2

t−1.

(12)

For simplicity  we drop the subscript i in the above equations. So for every time t  there are n
innovations [ε1t  . . .   εnt](cid:62). We model them with our proposed tail dependence model  the lower-
triangular or one-factor version  and suppose they are i.i.d. at time t = 1  . . .   T .
The above model for multivariate asset returns is not easy to ﬁt directly. So we take an indirect
but effective way to do this. First  an AR(1)-GARCH(1 1) with t-distribution innovation is ﬁtted
to each return series. Then we collect all the residuals [ˆε1t  . . .   ˆεnt](cid:62)  t = 1  . . .   T and ﬁt our tail
dependence model with them using Algorithm 1. For comparisons  other methods like multivariate
normal  multivariate t  elliptical distribution  or copula approach can be used instead. We show the
comparison results in Section 5.

4 Simulation Experiment

In this section  we experimentally verify the rich tail dependence structure of our model and compare it
to the most widely used multivariate heavy-tailed distribution  the multivariate t-distribution  through
simulation. On one hand  106 data points are sampled from a 3-dimensional t-distribution with 5
degrees of freedom and then we use this sampled data to ﬁt our lower-triangular model with standard

6

Figure 2: The proxy down-tail dependence λD
ij (τ ) against τ. The ﬁrst subplot is from the 3-
dimensional t-distribution we specify and the second one is from our model ﬁtted using samples from
the t-distribution. Three lines represent three pairs of dimensions.

Figure 3: The proxy down-tail dependence λD
ij (τ ) against τ. The ﬁrst subplot is from our lower-
triangular model and the second one is from the 3-dimensional t-distribution ﬁtted using samples of
our model. Three lines represent three pairs of dimensions.

ij (τ ) = P{yi < Qyi(τ )  yj < Qyj (τ )}/τ for
normal latent z. Then proxy down-tail dependence λD
each pair of dimensions i & j is calculated for both the multivariate t-distribution and our model.
We change τ in [10−3  0.1] and plot λD
ij (τ ) against the varying τ in Figure 2. The ﬁrst subplot of
Figure 2 is from the 3-dimensional t-distribution we specify. The second subplot is from our model
ﬁtted. Lines of different colors represent different pairs of dimensions. We see two models generate
very similar line patterns  indicating that our model does capture the tail dependence structure of the
t-distribution. Different levels of the 3 lines are due to different correlations of pairs.
On the other hand  inversely  106 samples from our lower-triangular model with standard normal
latent z are generated and we ﬁt a multivariate t-distribution using these samples. Again the proxy
down-tail dependencies of every pairs of dimensions of these two models are calculated. We plot
these λD
ij (τ ) against τ in Figure 3  where we can see the 3-dimensional t-distribution (the second
subplot) cannot generate line patterns that are close to those generated by our model (the ﬁrst subplot) 
indicating that the t-distribution cannot capture the tail dependence structure of ours. This proves the
ﬂexible tail dependence structure of our model.

5 Conditional Distribution Forecasts

Our method described in Section 3.1 can forecast the conditional distribution of multiple asset returns
on testing data after training. The training set and testing set are two successive multivariate time
series of daily returns. We use statistical hypothesis testing to evaluate the forecasts. Recall that
for evaluating univariate Value-at-Risk (VaR) forecasts  [Kupiec  1995] proposed an unconditional
coverage test that checks if the proportion of VaR violations in testing period is equal to the probability
level of VaR. Inspired by this  we deﬁne a new type of violation for the two-dimensional case. Given
random variables (X  Y ) and a ﬁxed probability level τ  suppose a τ∗ solves the following equation:
(13)
where QX (τ∗) and QY (τ∗) are τ∗-quantiles of marginal distributions of X and Y respectively. If a
realization of (X  Y ) is located in the area [−∞  QX (τ∗)] × [−∞  QY (τ∗)]  we say it is a violation 
otherwise it is not. The probability of violation is obviously τ. To solve Equation (13) to get τ∗  we
can use bisection method on many samples of (X  Y ) when the analytical distribution is not known.
Suppose for a sequence of pairs {(Xt  Yt)}  we have forecasted its conditional distribution for every
t. Given the realization of {(Xt  Yt)}  i.e.  the observations in the testing set  there is a sequence

P{X < QX (τ∗)  Y < QY (τ∗)} = τ 

7

00.010.020.030.040.050.060.070.080.090.100.20.40.60.81Proxy Down Tail Dependence00.010.020.030.040.050.060.070.080.090.100.20.40.60.81Proxy Down Tail Dependence00.010.020.030.040.050.060.070.080.090.100.20.40.60.81Proxy Down Tail Dependence00.010.020.030.040.050.060.070.080.090.100.20.40.60.81Proxy Down Tail DependenceTable 1: Unconditional coverage test statistic. (a) The ﬁrst stock group: Apple  IBM  Microsoft. (b)
The second: Apple  JP Morgan  Walmart. τ is 0.01 and ∗ represents the hypothesis is rejected at 95%
conﬁdence level. In parentheses it is the number of violations against ideal number of violations.

Method\Pair
Normal

t-distribution

Clayton copula

Gumbel copula

Our model

(a)
1&2
6.96∗
(10/21)
10.33∗
(8/21)
12.38∗
(7/21)
0.83
(25/21)
1.19
(16/21)

1&3
0.39
(18/21)
2.50
(14/21)
3.37
(13/21)
3.66
(30/21)
0.24
(23/21)

2&3
0.83
(25/21)
0.15
(19/21)
2.50
(14/21)
15.54∗
(41/21)
3.66
(30/21)

Method\Pair
Normal

t-distribution

Clayton copula

Gumbel copula

Our model

(b)
1&2
1.16
(19/24)
2.34
(17/24)
2.34
(17/24)
3.00
(33/24)
0.15
(26/24)

1&3
8.98∗
(11/24)
12.53∗
(9/24)
14.62∗
(8/24)
3.99∗
(15/24)
5.01∗
(14/24)

2&3
0.19
(22/24)
0.41
(21/24)
2.34
(17/24)
4.40∗
(35/24)
0.15
(26/24)

of whether the violation happens or not. Ideally  this 0-or-1 sequence should be samples from i.i.d.
Bernoulli distribution with parameter τ. To check if the proportion of violations in this sequence is τ 
Kupiec’s test [Kupiec  1995] for univariate case can be applied. The statistic of Kupiec’s test is:

)m(cid:17) − 2 log(cid:0)(1 − τ )T−mτ m(cid:1)  

(14)

(cid:16)

TK = 2 log

(1 − m
T

)T−m(

m
T

where T is the length of the sequence  and m is the number of violations. This statistic is asymptoti-
cally distributed on [0  +∞) as a chi-square with 1 degree of freedom. A zero of the statistic means
the proportion of violations is exactly τ. A large value of this statistic indicates the failure of forecasts.
At 95% conﬁdence level  the threshold for rejecting the hypothesis is 3.84. In our experiments  we
set τ = 0.01. For more than two assets  we do this test for any pair of assets while the model may be
high-dimensional. From this  we can see if the pairwise tail dependencies are captured by the model.
One needs to notice that the latent z is always standard normal in the experiments.

5.1 Lower-triangular Model

We select two groups of stocks and evaluate our lower-triangular model as well as other competing
methods on them. Each group contains 3 stocks that are representatives in the market. In the ﬁrst
group  3 stocks from IT sector are selected: Apple  IBM  and Microsoft. In the second  3 stocks are
from different sectors: Apple  JP Morgan  and Walmart. The return data of these two groups start
respectively from 14 March 1986 and 15 December 1980  and both end on 20 February 2019. They
have 8 302 and 9 627 observations respectively. We leave the last one-fourth of the time series of
each group as testing set. All returns are calculated by rt = 100 log(Pt/Pt−1)  where Pt is the price.
For comparison  we also try competing methods including multivariate normal  multivariate t  Clayton
copula [Clayton  1978]  and Gumbel copula [Kole et al.  2007]. The two copulas used here are
bivariate. This is feasible when our evaluation is pairwise. We report the test statistic given by each
method as well as the number of violations against the ideal number of violations in Table 1. In
part (a) showing the results of the ﬁrst stock group  we can see that while other methods all get at
least one rejection at one of the three dimension pairs  our model performs without one rejection. It
implies that our model does capture the distinct pairwise tail dependencies. In part (b) showing the
results of the second stock group  our model performs fairly well on dimension pairs 1&2 and 2&3.
The numbers of violations are very close to the ideal ones. Notice that all methods get rejected on
dimension pair 1&3  suggesting the possibility of a regime-switching or similar thing happened from
the training set to the testing set on that dimension pair. Overall  our proposed model does reach its
purpose of design  as veriﬁed by the results shown here.

5.2 One-factor Model

To evaluate our one-factor model  data of 15 representative Dow-Jones stocks are collected such as
AAPL  BA  JPM  and PG. The SP500 return serves as the market-wide variable. The multivariate
return data starts from 1980-12-15 and ends at 2019-05-21 with 9 690 observations. Again the last
one-fourth is left for testing. We use Algorithm 1 with very slight modiﬁcation to ﬁt our one-factor
model with the multivariate data. The modiﬁcation is easy to be obtained by the readers.

8

Table 2: The parameters of every asset in the one-factor model we have learnt (see Equation (5) for
the introduction). SP500 is the market-wide variable and 15 representative stocks are selected into
the model. The market variable SP500 has no parameters γi  ui  vi.

Asset\Parameter
SP500
AAPL
BA
CAT
CVX
DIS
DWDP
IBM
INTC
JNJ
JPM
KO
MMM
NKE
PG
WMT

αi

-0.0098
0.0256
-0.0223
0.0653
0.0368
0.0075
-0.0231
0.0686
0.0410
-0.0091
0.0581
0.0219
0.0037
-0.0083
0.0335
-0.0237

βi

0.6814
0.3295
0.3276
0.3882
0.3322
0.3557
0.3644
0.4330
0.4240
0.3430
0.4070
0.3828
0.4023
0.3627
0.3829
0.3769

uM
i

1.6914
1.0000
1.8424
1.0000
1.0000
1.6818
1.7973
1.0000
1.0000
1.8771
1.0000
1.4783
1.8597
2.4380
1.3750
1.8415

vM
i

1.8241
1.7909
1.8344
1.9623
1.9017
2.0383
1.8581
1.9335
1.6414
2.0107
2.0084
1.9378
1.9330
1.9460
1.9521
1.6061

γi
—

0.6071
0.6043
0.5947
0.5898
0.5651
0.5576
0.5216
0.5443
0.5730
0.5393
0.5759
0.5658
0.7101
0.5998
0.5488

ui
—

2.0504
1.7252
1.9417
1.7723
1.9214
1.9340
2.0673
1.7529
2.1325
1.9392
1.9990
1.9396
3.1765
2.0163
1.8287

vi
—

1.6992
1.4940
1.6630
1.5853
1.6551
1.6005
1.8113
1.5982
1.7065
1.6606
1.6679
1.7124
2.6941
1.7129
1.6256

Our competing methods are one-factor Gaussian and one-factor t  in which we replace g(zM| . . . )
and g(zi| . . . ) in our one-factor Equation (5) by Gaussian/t-distributed zM and zi. The degrees of
freedom of the t-distribution can be different for different assets. Since we have 16 assets totally 
there are C 2
16 = 120 pairs of dimensions. We evaluate these three models by reporting their numbers
of rejections obtained in the 120 tests. Respectively  the one-factor Gaussian  t  and our model obtain
52  43  and 32 rejections. The improvements are consistent with the intuition that when heavy tails
are modeled and when the tails are separately modeled from correlations  the performances are better.
We have some interesting ﬁndings on the asymmetry of tails. In Table 2  we list the parameters of the
15 stocks as well as of SP500. It is not a coincidence when idiosyncratic components of all stocks
are right-skewed  i.e.  ui > vi for all i. In contrast  for most stocks uM
  which means the
market-wide tail impact is greater on the down side. A large SP500 drop will affect nearly all stocks
severely while this is not the case on the up side. Actually  many stocks have uM
i = 1  showing no
tail sensitivity to the market variable on the up side. This deserves to be well studied in the future.

i < vM
i

6 Conclusions

In summary  we propose a novel transformed random vector that is from some known random vector
like standard normal  to learn the correlation-separated multivariate tail dependence structure of
ﬁnancial assets. We design it to let it have not only different marginal tail heaviness but also distinct
pairwise tail dependencies. Our model has a lower-triangular version and a one-factor version. We
also propose an algorithm to ﬁt it with data. It is proved numerically to have distinct pairwise tail
dependencies  which is an essential advantage over many commonly used methods. Combined with a
GARCH-type model  we use it to forecast the conditional distribution of multi-dimensional asset
returns and achieve signiﬁcant performance improvements.
The empirical ﬁndings on the asymmetry of tails are interesting and worth to be well studied in the
future. Many related questions need to be answered by further studies. For example  how to interpret
the source of this idiosyncratic right skewness  what forms the market variable’s left skewness when
each component stock is right-skewed  and what their consequences are for asset pricing  either
theoretically or empirically. Future works also include theoretical analysis on our model  especially
the analytical tail dependence formula and the properties of the ﬁtting algorithm.

Acknowledgements

Qi WU acknowledges the ﬁnancial support from the City University of Hong Kong grant SRG-
Fd 7005300  and the Hong Kong Research Grants Council  particularly the Early Career Scheme

9

24200514 and the General Research Funds 14211316 and 14206117. This work was undertaken in
part while Xing YAN was working with JD Digits.

References

[Aas et al.  2009] Aas  K.  Czado  C.  Frigessi  A.  and Bakken  H. (2009). Pair-copula constructions

of multiple dependence. Insurance: Mathematics and economics  44(2):182–198.

[Aderounmu and Wolff  2014] Aderounmu  A. A. and Wolff  R. (2014). Assessing tail dependence

in electricity markets. Available at SSRN 2373591.

[Balla et al.  2014] Balla  E.  Ergen  I.  and Migueis  M. (2014). Tail dependence and indicators of

systemic risk for large us depositories. Journal of Financial Stability  15:195–209.

[Beine et al.  2010] Beine  M.  Cosma  A.  and Vermeulen  R. (2010). The dark side of global

integration: Increasing tail dependence. Journal of Banking & Finance  34(1):184–192.

[Bollerslev  1986] Bollerslev  T. (1986). Generalized autoregressive conditional heteroskedasticity.

Journal of econometrics  31(3):307–327.

[Chan and Li  2008] Chan  Y. and Li  H. (2008). Tail dependence for multivariate t-copulas and its

monotonicity. Insurance: Mathematics and Economics  42(2):763–770.

[Clayton  1978] Clayton  D. G. (1978). A model for association in bivariate life tables and its appli-
cation in epidemiological studies of familial tendency in chronic disease incidence. Biometrika 
65(1):141–151.

[Demarta and McNeil  2005] Demarta  S. and McNeil  A. J. (2005). The t copula and related copulas.

International statistical review  73(1):111–129.

[Embrechts et al.  2001] Embrechts  P.  Lindskog  F.  and McNeil  A. (2001). Modelling dependence
with copulas. Rapport technique  Département de mathématiques  Institut Fédéral de Technologie
de Zurich  Zurich.

[Engle  1982] Engle  R. F. (1982). Autoregressive conditional heteroscedasticity with estimates of
the variance of united kingdom inﬂation. Econometrica: Journal of the Econometric Society 
pages 987–1007.

[Frahm et al.  2005] Frahm  G.  Junker  M.  and Schmidt  R. (2005). Estimating the tail-dependence

coefﬁcient: properties and pitfalls. Insurance: mathematics and Economics  37(1):80–100.

[Jondeau and Rockinger  2006] Jondeau  E. and Rockinger  M. (2006). The copula-garch model of
conditional dependencies: An international stock market application. Journal of international
money and ﬁnance  25(5):827–853.

[Koenker and Hallock  2001] Koenker  R. and Hallock  K. F. (2001). Quantile regression. Journal

of economic perspectives  15(4):143–156.

[Kole et al.  2007] Kole  E.  Koedijk  K.  and Verbeek  M. (2007). Selecting copulas for risk man-

agement. Journal of Banking & Finance  31(8):2405–2423.

[Kupiec  1995] Kupiec  P. (1995). Techniques for verifying the accuracy of risk measurement models.

FEDS Paper  (95-24).

[Lesniewski et al.  2016] Lesniewski  A.  Sun  H.  and Wu  Q. (2016). Asymptotics of portfolio tail

risk metrics for elliptically distributed asset returns. Available at SSRN 2748970.

[Peng and Kou  2009] Peng  X. and Kou  S. (2009). Default clustering and valuation of collateralized

debt obligations. Working Paper.

10

[Poon et al.  2003] Poon  S.-H.  Rockinger  M.  and Tawn  J. (2003). Extreme value dependence
in ﬁnancial markets: Diagnostics  models  and ﬁnancial implications. The Review of Financial
Studies  17(2):581–610.

[Poulin et al.  2007] Poulin  A.  Huard  D.  Favre  A.-C.  and Pugin  S. (2007). Importance of tail
dependence in bivariate frequency analysis. Journal of Hydrologic Engineering  12(4):394–403.
[Schoelzel and Friederichs  2008] Schoelzel  C. and Friederichs  P. (2008). Multivariate non-
normally distributed random variables in climate research–introduction to the copula approach.
Nonlinear Processes in Geophysics  15(5):761–772.

[Wu and Yan  2019] Wu  Q. and Yan  X. (2019). Capturing deep tail risk via sequential learning of

quantile dynamics. Journal of Economic Dynamics and Control  page 103771.

[Yan et al.  2018] Yan  X.  Zhang  W.  Ma  L.  Liu  W.  and Wu  Q. (2018). Parsimonious quan-
tile regression of ﬁnancial asset tail dynamics via sequential learning. In Advances in Neural
Information Processing Systems  pages 1582–1592.

11

,Xing Yan
Qi Wu
Wen Zhang