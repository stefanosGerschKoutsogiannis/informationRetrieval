2009,Reconstruction of Sparse Circuits Using Multi-neuronal Excitation (RESCUME),One of the central problems in neuroscience is reconstructing synaptic connectivity in neural circuits. Synapses onto a neuron can be probed by sequentially stimulating potentially pre-synaptic neurons while monitoring the membrane voltage of the post-synaptic neuron. Reconstructing a large neural circuit using such a “brute force” approach is rather time-consuming and inefficient because the connectivity in neural circuits is sparse. Instead  we propose to measure a post-synaptic neuron’s voltage while stimulating simultaneously multiple randomly chosen potentially pre-synaptic neurons. To extract the weights of individual synaptic connections we apply a decoding algorithm recently developed for compressive sensing. Compared to the brute force approach  our method promises significant time savings that grow with the size of the circuit. We use computer simulations to find optimal stimulation parameters and explore the feasibility of our reconstruction method under realistic experimental conditions including noise and non-linear synaptic integration. Multiple-neuron stimulation allows reconstructing synaptic connectivity just from the spiking activity of post-synaptic neurons  even when sub-threshold voltage is unavailable. By using calcium indicators  voltage-sensitive dyes  or multi-electrode arrays one could monitor activity of multiple post-synaptic neurons simultaneously  thus mapping their synaptic inputs in parallel  potentially reconstructing a complete neural circuit., 

 

Reconstruction of Sparse Circuits Using 
Multi-neuronal Excitation (RESCUME) 

Tao Hu and Dmitri B. Chklovskii  

Janelia Farm Research Campus  HHMI 
19700 Helix Drive  Ashburn  VA 20147 

hut  mitya@janelia.hhmi.org 

Abstract 

One  of  the  central  problems  in  neuroscience  is  reconstructing  synaptic 
connectivity  in  neural  circuits.  Synapses  onto  a  neuron  can  be  probed  by 
sequentially  stimulating  potentially  pre-synaptic  neurons  while  monitoring 
the  membrane  voltage  of  the  post-synaptic  neuron.  Reconstructing  a  large 
neural circuit using such a “brute force” approach is rather time-consuming 
and inefficient because the connectivity in neural circuits is sparse. Instead  
we  propose  to  measure  a  post-synaptic  neuron’s  voltage  while  stimulating 
sequentially  random  subsets  of  multiple  potentially  pre-synaptic  neurons. 
To  reconstruct  these  synaptic  connections  from  the  recorded  voltage  we 
apply  a  decoding  algorithm  recently  developed  for  compressive  sensing. 
Compared  to  the  brute  force  approach   our  method  promises  significant 
time  savings  that  grow  with  the  size  of  the  circuit.  We  use  computer 
simulations  to  find  optimal  stimulation  parameters  and  explore  the 
feasibility  of  our  reconstruction  method  under  realistic  experimental 
conditions  including  noise  and  non-linear  synaptic  integration.  Multi-
neuronal  stimulation  allows  reconstructing  synaptic  connectivity  just  from 
the  spiking  activity  of  post-synaptic  neurons   even  when  sub-threshold 
voltage is unavailable. By using calcium indicators  voltage-sensitive dyes  
or  multi-electrode  arrays  one  could  monitor  activity  of  multiple  post-
synaptic  neurons  simultaneously   thus  mapping  their  synaptic  inputs  in 
parallel  potentially reconstructing a complete neural circuit. 

 

1  

I n t ro d u c t i o n  

Understanding information processing in neural circuits requires systematic characterization 
of  synaptic  connectivity  [1   2]. The  most  direct  way  to  measure  synapses  between  a  pair  of 
neurons is to stimulate potentially pre-synaptic neuron while recording intra-cellularly from 
the potentially post-synaptic neuron [3-8]. This method can be scaled to reconstruct multiple 
synaptic  connections  onto  one  neuron  by  combining  intracellular  recordings  from  the  post-
synaptic neuron with photo-activation of pre-synaptic neurons using glutamate uncaging [9-
13]  or  channelrhodopsin  [14   15]   or  with  multi-electrode  arrays  [16   17].  Neurons  are 
sequentially  stimulated  to  fire  action  potentials  by  scanning  a  laser  beam  (or  electrode 
voltage) over  a brain  slice   while synaptic  weights are  measured  by recording  post-synaptic 
voltage.  

Although  sequential  excitation  of  single  potentially  pre-synaptic  neurons  could  reveal 
connectivity   such  a  “brute  force”  approach  is  inefficient  because  the  connectivity  among 
neurons  is  sparse.  Even  among  nearby  neurons  in  the  cerebral  cortex   the  probability  of 
connection  is  only  about  ten  percent  [3-8].  Connection  probability  decays  rapidly  with  the 

 

1 

distance  between  neurons  and  falls  below  one  percent  on  the  scale  of  a  cortical  column  [3  
8].  Thus   most  single-neuron  stimulation  trials  would  result  in  zero  response  making  the 
brute force approach slow  especially for larger circuits.  

Another  drawback  of  the  brute  force  approach  is  that  single-neuron  stimulation  cannot  be 
combined  efficiently  with  methods  allowing  parallel  recording  of  neural  activity   such  as 
calcium  imaging  [18-22]   voltage-sensitive  dyes  [23-25]  or  multi-electrode  arrays  [17   26]. 
As  these  techniques  do  not  reliably  measure  sub-threshold  potential  but  report  only  spiking 
activity  they would reveal only the strongest connections that can drive a neuron to fire [27-
30]. Therefore  such combination would reveal only a small fraction of the circuit.  

We  propose  to  circumvent  the  above  limitations  of  the  brute  force  approach  by  stimulating 
multiple  potentially  pre-synaptic  neurons  simultaneously  and  reconstructing  individual 
connections by using a recently developed method called compressive sensing (CS) [31-35]. 
In  each  trial   we  stimulate  F  neurons  randomly  chosen  out  of  N  potentially  pre-synaptic 
neurons  and  measure  post-synaptic  activity.  Although  each  measurement  yields  only  a 
combined  response  to  stimulated  neurons   if  synaptic  inputs  sum  linearly  in  a  post-synaptic 
neuron   one  can  reconstruct  the  weights  of  individual  connections  by  using  an  optimization 
algorithm.  Moreover   if  the  synaptic  connections  are  sparse   i.e.  only  K  <<  N  potentially 
pre-synaptic  neurons  make  synaptic  connections  onto  a  post-synaptic  neuron   the  required 
number of trials M ~ K log(N/K)  which is much less than N [31-35].  

The proposed method can be used even if only spiking activity is available. Because multiple 
neurons  are  driven  to  fire  simultaneously   if  several  of  them  synapse  on  the  post-synaptic 
neuron  they can induce one or  more spikes in that neuron. As quantized spike counts carry 
less  information  than  analog  sub-threshold  voltage  recordings   reconstruction  requires  a 
larger  number  of  trials. Yet   the  method  can  be  used  to  reconstruct  a  complete  feedforward 
circuit from spike recordings.  

Reconstructing neural circuit with multi-neuronal excitation may be compared with mapping 
retinal ganglion cell receptive fields. Typically  photoreceptors are stimulated by white-noise 
checkerboard  stimulus  and  the  receptive  field  is  obtained  by  Reverse  Correlation  (RC)  in 
case  of  sub-threshold  measurements  or  Spike-Triggered Average  (STA)  of  the  stimulus  [36  
37]. Although CS may use the same stimulation protocol  for a limited number of trials  the 
reconstruction quality is superior to RC or STA. 

 
2  

M a p p i n g   s y n a p t i c   i n p u t s   o n t o   o n e   n e u ro n  

We  start  by  formalizing  the  problem  of  mapping  synaptic  connections  from  a  population  of 
N  potentially  pre-synaptic  neurons  onto  a  single  neuron   as  exemplified  by  granule  cells 
synapsing  onto  a  Purkinje  cell  (Figure  1a).  Our  experimental  protocol  can  be  illustrated 
using linear algebra formalism  Figure 1b. We represent synaptic weights as components of a 
column  vector  x   where  zeros  represent  non-existing  connections.  Each  row  in  the 
stimulation  matrix  A  represents  a  trial   ones  indicating  neurons  driven  to  spike  once  and 
zeros  indicating  non-spiking  neurons.  The  number  of  rows  in  the  stimulation  matrix  A  is 
equal  to  the  number  of  trials  M.  The  column  vector  y  represents  M  measurements  of 
membrane voltage obtained by an intra-cellular recording from the post-synaptic neuron: 

y = Ax.                                                                (1) 
In  order  to  recover  individual  synaptic  weights   Eq.  (1)  must  be  solved  for  x.  RC  (or  STA) 
solution to this problem is x = (ATA)-1AT y  which minimizes (y-Ax)2 if M>N. In the case M<N  
the corresponding expression x = AT(AAT)-1y is a solution to the following problem: 

 min

x

l
2

N

= ∑   subject to y = Ax.  

2
x
i

i

=
1

Given  prior  knowledge  that  the  connectivity  is  sparse   we  propose  to  recover  x  by  solving 
instead: 

min 

x

  

0l

subject to y = Ax  

where 

x

0l

is the l0-norm of x or the number of non-zero elements. Under certain conditions 

 

2 

[25-29]  this solution can be obtained by minimizing the l1-norm: 

x

l
1

N

= ∑ using linear 

x

i

i

=
1

programming  [38]  or  by  iterative  greedy  algorithms  [39   40].  In  this  paper   we  used  a 
particularly efficient Compressive Sampling Matching Pursuit (CoSaMP) algorithm [41  42]. 

We  simulate  the  proposed  reconstruction  method  in  silico  by  generating  a  neural  network  
simulating  experimental  measurements   and  recovering  synaptic  weights.  We  draw  unitless 
synaptic  weights  from  a  distribution  derived  from  electrophysiological  measurements  [4   5  
43   44]  containing  a delta-function at zero and an exponential distribution with a unit  mean 
(Figure  2a).  We  generate  an  M-by-N  stimulation  matrix  A  by  setting  F  randomly  chosen 
entries  in  each  row  to  one   and  the  rest  to  zero.  We  compute  the  measurement  vector  y  by 
multiplying  A  and  x.  Then   we  use  the  CoSaMP  algorithm  to  recover  synaptic  weights   xr  
from A and y. Figure 2b compares a typical result of such reconstruction and a result of RC 
with  originally  generated  non-zero  synaptic  weights  x.  Despite  using  fewer  measurements 
than  required  in  the  brute  force  approach   CS  achieves  perfect  reconstruction  while  RC 
yields a worse result [45]. 

(a)

(b)

y

A

x

M

measurements

M   N

K

synaptic

connections

N neurons

 

Figure  1:  Mapping  synapses  onto  one  neuron.  a)  A  potentially  post-synaptic  neuron  (red) 
receives  synaptic  connection  (blue)  from  K  neurons  out  of  N  potentially  pre-synaptic 
neurons. b) Linear algebra representation of the experimental protocol. The column vector x 
contains synaptic weights from N potentially pre-synaptic neurons: K blue squares represent 
existing  connections   white  squares  represent  absent  connections.  The  matrix  A  represents 
the sequence of stimulation: black squares in each row represent stimulated neurons in each 
trial. The column vector y contains measured membrane voltage in the red neuron. 

(b)

synaptic weights
synaptic weights recoverd by CS
synaptic weights recoverd by RC

(a)

K = 30 non-zero synaptic weights
N = 500 potential pre-synaptic neurons
M = 200 trials
F = 50 neurons stimulated per trial

3

2

1

s
t

i

h
g
e
w
 
c
i
t

p
a
n
y
S

1

0.98

0.96

0.94

//

0.92
0.08
Probability

0.06

0.04

0.02

0

100

200

300

400

Potential pre−synaptic neurons

500

 

Figure 2: Reconstruction of synaptic weights onto one neuron. a) Synaptic weights are drawn 
from  the  empirically  motivated  probability  distribution.  b)  Reconstruction  by  CS  (red) 
coincides  perfectly  with  generated  synaptic  weights  (blue)   achieving  60%  improvement  in 
the number of trials over the brute force approach. RC result (green) is significantly worse. 

 
3  
n e t w o r k   s i ze   a n d   s p a r s e n e s s  

M i n i m u m   n u m b e r  o f   m e a s u re m e n t s   a s   a   f u n c t i o n   o f  

In  order  to  understand  intuitively  why  the  number  of  trials  can  be  less  than  the  number  of 
potential  synapses   note  that  the  minimum  number  of  trials   i.e.  information  or  entropy   is 

 

3 

given  by  the  logarithm  of  the  total  number  of  possible  connectivity  patterns.  If  connections 
are binary  the number of different connectivity patterns onto a post-synaptic neuron from N 
neurons is 2N  and hence the minimum number of trials is N. However  prior knowledge that 
only K connections are present reduces the number of possible connectivity patterns from 2N 
N  ~  (N/K)K.  Thus   the  number  of  trials  dramatically  reduces 
to  the  binomial  coefficient   CK
from N to K log(N/K) << N for a sparse circuit. 

In  this  section  we  search  computationally  for  the  minimum  number  of  trials  required  for 
exact  reconstruction  as  a  function  of  the  number  of  non-zero  synaptic  weights  K  out  of  N 
potentially pre-synaptic neurons. First  note that the number of trials depends on the number 
of  stimulated  neurons  F.  If  F  =  1  we  revert  to  the  brute  force  approach  and  the  number  of 
measurements is  N   while  for F =  N   the  measurements are  redundant  and  no  finite  number 
suffices.  As  the  minimum  number  of  measurements  is  expected  to  scale  as  K  logN   there 
must be an optimal F which makes each measurement most informative about x.  

To determine the optimal number of stimulated neurons F for given  K and N  we search  for 
the  minimum  number  of  trials  M   which  allows  a  perfect  reconstruction  of  the  synaptic 
connectivity  x.  For  each  F   we  generate  50  synaptic  weight  vectors  and  attempt 
reconstruction  from  sequentially  increasing  numbers  of  trials.  The  value  of  M   at  which  all 
50  recoveries  are  successful  (up  to  computer  round-off  error)   estimates  the  number  of  trial 
needed  for reconstruction  with  probability  higher  than  98%. By repeating this  procedure  50 
times for each F  we estimate the mean and standard deviation of M. We find that  for given 
N  and  K   the  minimum  number  of  trials   M   as  a  function  of  the  number  of  stimulated 
neurons   F   has  a  shallow  minimum.   As  K  decreases   the  minimum  shifts  towards  larger  F 
because  more  neurons  should  be  stimulated  simultaneously  for  sparser  x.  For  the  explored 
range of simulation parameters  the minimum is located close to 0.1N. 

Next  we set F = 0.1N  and explore how the minimum number of measurements required for 
exact  reconstruction  depends  on  K  and  N.  Results  of  the  simulations  following  the  recipe 
described  above  are  shown  in  Figure  3a.  As  expected   when  x  is  sparse   M  grows 
approximately linearly with K (Figure 3b)  and logarithmically with N (Figure 3c). 

N = 1000

K = 30

 

5
150 250

400

650

1000

Number of potential connections (N)

5

10

15

20

25

30

Number of actual connections (K)

Figure 3: a) Minimum number of measurements M required for reconstruction as a function 
of  the  number of  actual synapses  K  and  the  number  of potential  synapses   N.  b) For  given 
N  we find M ~ K. c) For given K  we find M ~ logN (note semi-logarithmic scale in c).  

 
4  
s i m p l i f y i n g   a s s u m p t i o n s  

R o b u s t n e s s   o f   re c o n s t r u c t i o n s   t o   n o i s e   a n d   v i o l a t i o n   o f  

To  make  our  simulation  more  realistic  we  now  take  into  account  three  possible  sources  of 
noise:  1)  In  reality   post-synaptic  voltage  on  a  given  synapse  varies  from  trial  to  trial  [4   5  
46-52]   an  effect  we  call  synaptic  noise.  Such  noise  detrimentally  affects  reconstructions 
because each row of A is multiplied by a different instantiation of vector x. 2) Stimulation of 
neurons  may  be  imprecise  exciting  a  slightly  different  subset  of  neurons  than  intended 
and/or  firing  intended  neurons  multiple  times.  We  call  this  effect  stimulation  noise.  Such 
noise  detrimentally  affects  reconstructions  because   in  its  presence   the  actual  measurement 
matrix A is different from the one used for recovery. 3) A synapse may fail to release neuro-
transmitter with some probability. 

Naturally   in  the  presence  of  noise   reconstructions  cannot  be  exact.  We  quantify  the 

 

4 

Number of necessary measurements (M)
30

 

(a)

25

20

15

10

(b)

200

180

160

140

120

100

80

220

200

180

160

140

120

100

80

)

M

(
 
s
t

n
e
m
e
r
u
s
a
e
m

 
f

o

 
r
e
b
m
u
N

)

K

(
 
s
n
o
i
t
c
e
n
n
o
c
 
l
a
u
t
c
a
 
f
o
 
r
e
b
m
u
N

220

210

200

190

180

170

160

150

140

130

)

M

(
 
s
t

n
e
m
e
r
u
s
a
e
m

 
f

o

 
r
e
b
m
u
N

120

2
10

(c)

Number of potential connections (N)

 

3

10

reconstruction 

error 

by 

the 

normalized 

l2–error 

x

−

x
r

/

x

l
2

l
2

   where 

x

−

x

r

=

l
2

∑

N

i

=
1

(

x
i

−

x

ri

2

)

.  We  plot  normalized  reconstruction  error  in  brute  force 

approach  (M  =  N  =  500  trials)  as  a  function  of  noise   as  well  as  CS  and  RC  reconstruction 
errors (M = 200  600 trials)  Figure 4. 

For  each  noise  source   the  reconstruction  error  of  the  brute  force  approach  can  be  achieved 
with  60%  fewer  trials  by  CS  method  for  the  above  parameters  (Figure  4).  For  the  same 
number  of  trials   RC  method  performs  worse.  Naturally   the  reconstruction  error  decreases 
with the number of trials. The reconstruction error is most sensitive to stimulation noise and 
least sensitive to synaptic noise.  

|2
|
x
|
|
/

2

|
|
xr
-
x
|
|
 
r
o
r
r
e

 

n
o

i
t
c
u
r
t
s
n
o
c
e
r
 

d
e
z

i
l

a
m
r
o
N

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 

0

(a)

 

RC: M=200
RC: M=600
Brute force method: M=500
CS: M=200
CS: M=600

0.05

0.1

0.15

0.2

0.25

Synaptic noise level

(b)

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

0

0.05

0.1

0.15

0.2

0.25

Stimulation noise level

(c)

1

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 

0

0.05
0.2
Synaptic failure probability

0.15

0.1

 

0.25

 

Figure  4:  Impact  of  noise  on  the  reconstruction  quality  for  N  =  500   K  =  30   F  =  50.  a) 
Recovery error due to trial-to-trial variation in synaptic weight. The response y is calculated 
using the synaptic connectivity x perturbed by an additive Gaussian noise. The noise level is 
given by the coefficient of variation of synaptic weight. b) Recovery error due to stimulation 
noise.  The  matrix  A  used  for  recovery  is  obtained  from  the  binary  matrix  used  to  calculate 
the  measurement  vector y by shifting  in each row  a fraction of ones specified by the noise 
level to random positions. c) Recovery error due to synaptic failures. 

The  detrimental  effect  of  the  stimulation  noise  on  the  reconstruction  can  be  eliminated  by 
monitoring  spiking  activity  of  potentially  pre-synaptic  neurons.  By  using  calcium  imaging 
[18-22]   voltage-sensitive  dyes  [23]  or  multi-electrode  arrays  [17   26]  one  could  record  the 
actual  stimulation  matrix.  Because  most  random  matrices  satisfy  the  reconstruction 
requirements [31  34  35]  the actual stimulation matrix can be used for a successful recovery 
instead of the intended one. 

If  neuronal activity can  be  monitored reliably   experiments can  be done  in  a different  mode 
altogether.  Instead  of  stimulating  designated  neurons  with  high  fidelity  by  using  highly 
localized  and  intense  light   one  could  stimulate  all  neurons  with  low  probability.  Random 
firing  events  can  be  detected  and  used  in  the  recovery  process.  The  light  intensity  can  be 
tuned to stimulate the optimal number of neurons per trial. 

Next   we  explore  the  sensitivity  of  the  proposed  reconstruction  method  to  the  violation  of 
simplifying  assumptions.  First   whereas  our  simulation  assumes  that  the  actual  number  of 
connections   K   is  known   in  reality   connectivity  sparseness  is  known  a  priori  only 
approximately. Will this affect reconstruction results? In principle  CS does not require prior 
knowledge  of  K  for  reconstruction  [31   34   35].  For  the  CoSaMP  algorithm   however   it  is 
important  to  provide  value  K  larger  than  the  actual  value  (Figure  5a).  Then   the  algorithm 
will  find  all  the  actual  synaptic  weights  plus  some  extra  non-zero  weights   negligibly  small 
when  compared  to  actual  ones.  Thus   one  can  provide  the  algorithm  with  the  value  of  K 
safely larger than the actual one and then threshold the reconstruction result according to the 
synaptic noise level. 

Second  whereas we assumed a linear summation of inputs [53]  synaptic integration may be 

non-linear  [54].  We  model  non-linearity  by  setting

   where  yl  represents 
linearly summed synaptic inputs. Results of simulations (Figure 5b) show that although non-
linearity can significantly degrade CS reconstruction quality  it still performs better than RC. 

y

=

y
l

+

2
yα
l

 

5 

(a)

|2
|
x
|
|
/

2

|
|
xr
-
x
|
|
 
r
o
r
r
e
 
n
o
i
t
u
c
r
t
s
n
o
c
e
r
 
d
e
z

i
l

a
m
r
o
N

0.45

0.4

0.35

0.3

0.25

0.2

0.15

0.1

0.05

0

(b)

Actual K = 30

10

20

30

40

50

60

K fed to CoSaMP

|2
|
x
|
|
/

2

|
|
xr
-
x
|
|
 
r
o
r
r
e

 

n
o

i
t
c
u
r
t
s
n
o
c
e
r
 

d
e
z

i
l

a
m
r
o
N

0.9

0.8

0.7

0.6

0.5

0.4

0.3

0.2

0.1

0

 

CS
RC

 
-0.15 -0.12-0.09-0.06-0.03 0 0.03 0.06 0.09 0.12 0.15

Relative strength of the non-linear term α × mean(y

)
l

 

Figure 5: Sensitivity of reconstruction error to the violation of simplifying assumptions for N 
=  500   K =  30   M =  200   F  = 50. a) The quality  of the  reconstruction is  not  affected  if the 
CoSaMP  algorithm  is  fed  with  the  value  of  K  larger  than  actual.  b)  Reconstruction  error 
computed in 100 realizations for each value of the quadratic term relative to the linear term.  

 

5  

M a p p i n g   s y n a p t i c   i n p u t s   o n t o   a   n e u ro n a l   p o p u l a t i o n  

Until  now   we  considered  reconstruction  of  synaptic  inputs  onto  one  neuron  using  sub-
threshold  measurements  of  its  membrane  potential.  In  this  section   we  apply  CS  to 
reconstructing  synaptic  connections  onto  a  population  of  potentially  post-synaptic  neurons. 
Because  in  CS  the  choice  of  stimulated  neurons  is  non-adaptive   by  recording  from  all 
potentially post-synaptic neurons in response to one sequence of trials one can reconstruct a 
complete feedforward network (Figure 6). 

(a)

(d)

(b)

y

        A

      x

100

300

500

700

900

1100

Number of spikes

STA
CS

1

0.8

0.6

0.4

0.2

r
o
r
r
e
 
n
o
i
t
c
u
r
t
s
n
o
c
e
r
 
d
e
z

i
l

a
m
r
o
N

2

2

r

|
|

|
|
x
|
|
/
x
−

|
|
x
|
|
/
x
|
|

r

2

(c)

)
1
=
y
(
p

0

Ax

 

0
1000

3000

5000

7000

9000

Number of trials (M)

 

Figure  6:  Mapping  of  a  complete  feedforward  network.  a)  Each  post-synaptic  neuron  (red) 
receives synapses  from  a  sparse  subset of  potentially pre-synaptic  neurons  (blue). b)  Linear 
algebra representation of the experimental protocol. c) Probability of firing as  a  function of 
synaptic  current.  d)  Comparison  of  CS  and  STA  reconstruction  error  using  spike  trains  for   
N = 500  K = 30 and F = 50.  

Although attractive  such parallelization raises several issues. First  patching a large number 
of  neurons  is  unrealistic  and   therefore   monitoring  membrane  potential  requires  using 
different methods  such as calcium imaging [18-22]  voltage sensitive dyes [23-25] or multi-
electrode  arrays  [17   26].  As  these  methods  can  report  reliably  only  spiking  activity   the 
measurement  is  not  analog  but  discrete.  Depending  on  the  strength  of  summed  synaptic 
inputs  compared  to  the  firing  threshold   the  postsynaptic  neuron  may  be  silent   fire  once  or 
multiple  times. As  a  result   the  measured  response  y  is  quantized  by  the  integer  number  of 
spikes.  Such  quantized  measurements  are less informative than  analog  measurements  of the 
sub-threshold membrane potential. In the extreme case of only two quantization levels  spike 
or  no  spike   each  measurement  contains  only  1  bit  of  information.  Therefore   to  achieve 
reasonable  reconstruction  quality  using  quantized  measurements   a  larger  number  of  trials 
M>>N is required.  

We simulate circuit reconstruction from spike recordings in silico as follows. First  we draw 
synaptic  weights  from  an  experimentally  motivated  distribution.  Second   we  generate  a 

 

6 

random  stimulation  matrix  and  calculate  the  product  Ax.  Third   we  linear  half-wave  rectify 
this product and use the result as the instantaneous firing rate for the Poisson spike generator 
(Figure  6c). We used  a  rectifying threshold  that  results in  10%  of spiking  trials  as typically 
observed  in  experiments.  Fourth   we  reconstruct  synaptic  weights  using  STA  and  CS  and 
compare  the  results  with  the  generated  weights.  We  calculated  mean  error  over  100 
realizations of the simulation protocol (Figure 6d). 

Due  to  the  non-linear  spike  generating  procedure   x  can  be  recovered  only  up  to  a  scaling 
factor. We  propose  to  calibrate  x  with  a  few  brute-force  measurements  of  synaptic  weights. 
Thus  in calculating the reconstruction error using l2 norm  we normalize both the generated 
and  recovered  synaptic  weights.  Such  definition  is  equivalent  to  the  angular  error   which  is 
often used to evaluate the performance of STA in mapping receptive field [37  55].  

Why  is  CS  superior  to  STA  for  a  given  number  of  trials  (Figure  6d)?  Note  that  spikeless 
trials  which typically constitute a majority  also carry information about connectivity. While 
STA discards these trials  CS takes them into account. In particular  CoSaMP starts with the 
STA  solution  as  zeroth iteration and  improves  on  it  by using the results of all  trials  and  the 
sparseness prior.  

 
6  

D i s c u s s i o n  

We have demonstrated that sparse feedforward networks can be reconstructed by stimulating 
multiple  potentially  pre-synaptic  neurons  simultaneously  and  monitoring  either  sub-
threshold  or  spiking  response  of  potentially  post-synaptic  neurons.  When  sub-threshold 
voltage  is  recorded   significantly  fewer  measurements  are  required  than  in  the  brute  force 
approach.  Although  our  method  is  sensitive  to  noise  (with  stimulation  noise  worse  than 
synapse noise)  it is no less robust than the brute force approach or RC.  

The  proposed  reconstruction  method  can  also  recover  inputs  onto  a  neuron  from  spike 
counts   albeit  with  more  trials  than  from  sub-threshold  potential  measurements.  This  is 
particularly  useful  when  intra-cellular  recordings  are  not  feasible  and  only  spiking  can  be 
detected  reliably   for  example   when  mapping  synaptic  inputs  onto  multiple  neurons  in 
parallel. For a given number of trials  our method yields smaller error than STA. 

The  proposed  reconstruction  method  assumes  linear  summation  of  synaptic  inputs  (both 
excitatory and inhibitory) and is sensitive to non-linearity of synaptic integration. Therefore  
it  is  most  useful  for  studying  connections  onto  neurons   in  which  synaptic  integration  is 
close  to  linear.  On  the  other  hand   multi-neuron  stimulation  is  closer  than  single-neuron 
stimulation  to  the  intrinsic  activity  in  the  live  brain  and  can  be  used  to  study  synaptic 
integration under realistic conditions.  

In  contrast  to  circuit  reconstruction  using  intrinsic  neuronal  activity  [56   57]   our  method 
relies  on  extrinsic  stimulation  of  neurons.  Can  our  method  use  intrinsic  neuronal  activity 
instead? We see two major drawbacks of such approach. First  activity of non-monitored pre-
synaptic  neurons  may  significantly  distort  reconstruction  results.  Thus   successful 
reconstruction  would  require  monitoring  all  active  pre-synaptic  neurons   which  is  rather 
challenging.  Second   reliable  reconstruction  is  possible  only  when  the  activity  of  pre-
synaptic  neurons  is  uncorrelated. Yet   their  activity  may  be  correlated   for  example   due  to 
common input.  

We thank Ashok Veeraraghavan for introducing us to CS  Anthony Leonardo for making a retina 
dataset  available  for  the  analysis   Lou  Scheffer  and  Hong  Young  Noh  for  commenting  on  the 
manuscript and anonymous reviewers for helpful suggestions.   

R e f e r e n c e s  
[1]  Luo   L.   Callaway   E.M.  &  Svoboda   K.  (2008)  Genetic  dissection  of  neural  circuits.  Neuron 
57(5):634-660. 
[2]  Helmstaedter   M.   Briggman   K.L.  &  Denk   W.  (2008)  3D  structural  imaging  of  the  brain  with 
photons and electrons. Current opinion in neurobiology 18(6):633-641. 
[3]  Holmgren   C.  Harkany  T.   Svennenfors   B. & Zilberter  Y.  (2003) Pyramidal  cell communication 
within local networks in layer 2/3 of rat neocortex. Journal of Physiology 551:139-153. 
[4] Markram  H. (1997) A network of tufted layer 5 pyramidal neurons. Cerebral Cortex 7(6):523-533. 

 

7 

[5] Markram  H.  Lubke  J.  Frotscher  M.  Roth  A. & Sakmann  B. (1997) Physiology and anatomy of 
synaptic  connections  between  thick  tufted  pyramidal  neurones  in  the  developing  rat  neocortex. 
Journal of Physiology 500(2):409-440. 
[6]  Thomson   A.M.  &  Bannister   A.P.  (2003)  Interlaminar  connections  in  the  neocortex.  Cerebral 
Cortex 13(1):5-14. 
[7]  Thomson   A.M.   West   D.C.   Wang   Y.  &  Bannister   A.P.  (2002)  Synaptic  connections  and  small 
circuits involving excitatory and inhibitory neurons in layers 2-5 of adult rat and cat neocortex: triple 
intracellular recordings and biocytin labelling in vitro. Cerebral Cortex 12(9):936-953. 
[8]  Song   S.   Sjostrom   P.J.   Reigl   M.   Nelson   S.  &  Chklovskii   D.B.  (2005)  Highly  nonrandom 
features of synaptic connectivity in local cortical circuits. Plos Biology 3(3):e68. 
[9]  Callaway   E.M.  &  Katz   L.C.  (1993)  Photostimulation  using  caged  glutamate  reveals  functional 
circuitry  in  living  brain  slices.  Proceedings  of  the  National Academy  of  Sciences  of  the  United  States 
of America 90(16):7661-7665. 
[10]  Dantzker   J.L.  &  Callaway   E.M.  (2000)  Laminar  sources  of  synaptic  input  to  cortical  inhibitory 
interneurons and pyramidal neurons. Nature Neuroscience 3(7):701-707. 
[11]  Shepherd   G.M.  &  Svoboda   K.  (2005)  Laminar  and  columnar  organization  of  ascending 
excitatory  projections  to  layer  2/3  pyramidal  neurons  in  rat  barrel  cortex.  Journal  of  Neuroscience 
25(24):5670-5679. 
[12] Nikolenko  V.  Poskanzer  K.E. & Yuste  R. (2007) Two-photon photostimulation and imaging of 
neural circuits. Nature Methods 4(11):943-950. 
[13]  Shoham   S.   O'connor   D.H.   Sarkisov   D.V.  &  Wang   S.S.  (2005)  Rapid  neurotransmitter 
uncaging in spatially defined patterns. Nature Methods 2(11):837-843. 
[14] Gradinaru  V.  Thompson  K.R.  Zhang  F.  Mogri  M.  Kay  K.  Schneider  M.B. & Deisseroth  K. 
(2007) Targeting and  readout strategies  for  fast  optical neural  control  in vitro and  in  vivo. Journal of 
Neuroscience 27(52):14231-14238. 
[15]  Petreanu   L.   Huber   D.   Sobczyk  A.  &  Svoboda   K.  (2007)  Channelrhodopsin-2-assisted  circuit 
mapping of long-range callosal projections. Nature Neuroscience 10(5):663-668. 
[16]  Na   L.   Watson   B.O.   Maclean   J.N.   Yuste   R.  &  Shepard   K.L.  (2008)  A  256×256  CMOS 
Microelectrode Array  for  Extracellular  Neural  Stimulation  of Acute  Brain  Slices.  Solid-State  Circuits 
Conference  2008. ISSCC 2008. Digest of Technical Papers. IEEE International. 
[17] Fujisawa  S.  Amarasingham  A.  Harrison  M.T. & Buzsaki  G. (2008) Behavior-dependent short-
term assembly dynamics in the medial prefrontal cortex. Nature Neuroscience 11(7):823-833. 
[18] Ikegaya  Y.  Aaron  G.  Cossart  R.  Aronov  D.  Lampl  I.  Ferster  D. & Yuste  R. (2004) Synfire 
chains and cortical songs: temporal modules of cortical activity. Science 304(5670):559-564. 
[19] Ohki  K.  Chung  S.  Ch'ng  Y.H.  Kara  P. & Reid  R.C. (2005) Functional imaging with cellular 
resolution reveals precise micro-architecture in visual cortex. Nature 433(7026):597-603. 
[20]  Stosiek   C.   Garaschuk   O.   Holthoff   K.  &  Konnerth   A.  (2003)  In  vivo  two-photon  calcium 
imaging  of  neuronal  networks. Proceedings of the  National Academy  of  Sciences of the  United States 
of America 100(12):7319-7324. 
[21] Svoboda  K.  Denk  W.  Kleinfeld  D. & Tank  D.W. (1997) In vivo dendritic calcium dynamics in 
neocortical pyramidal neurons. Nature 385(6612):161-165. 
[22]  Sasaki   T.   Minamisawa   G.   Takahashi   N.   Matsuki   N.  &  Ikegaya   Y.  (2009)  Reverse  optical 
trawling for synaptic connections in situ. Journal of Neurophysiology 102(1):636-643. 
[23] Zecevic  D.  Djurisic  M.  Cohen  L.B.  Antic  S.  Wachowiak  M.  Falk  C.X. & Zochowski  M.R. 
(2003)  Imaging  nervous  system  activity  with  voltage-sensitive  dyes.  Current  Protocols 
in 
Neuroscience Chapter 6:Unit 6.17. 
[24]  Cacciatore  T.W.   Brodfuehrer   P.D.   Gonzalez   J.E.   Jiang  T.  Adams   S.R.  Tsien  R.Y.  Kristan  
W.B.   Jr.  &  Kleinfeld   D.  (1999)  Identification  of  neural  circuits  by  imaging  coherent  electrical 
activity with FRET-based dyes. Neuron 23(3):449-459. 
[25]  Taylor  A.L.   Cottrell   G.W.   Kleinfeld   D.  &  Kristan   W.B.   Jr.  (2003)  Imaging  reveals  synaptic 
targets of a swim-terminating neuron in the leech CNS. Journal of Neuroscience 23(36):11402-11410. 
[26]  Hutzler   M.   Lambacher   A.   Eversmann   B.   Jenkner   M.   Thewes   R.  &  Fromherz   P.  (2006) 
High-resolution  multitransistor  array  recording  of  electrical  field  potentials  in  cultured  brain  slices. 
Journal of Neurophysiology 96(3):1638-1645. 
[27]  Egger   V.   Feldmeyer   D.  &  Sakmann   B.  (1999)  Coincidence  detection  and  changes  of  synaptic 
efficacy in spiny stellate neurons in rat barrel cortex. Nature Neuroscience 2(12):1098-1105. 
[28] Feldmeyer  D.  Egger  V.  Lubke  J. & Sakmann  B. (1999) Reliable synaptic connections between 
pairs  of  excitatory  layer  4  neurones  within  a  single  'barrel'  of  developing  rat  somatosensory  cortex. 
Journal of Physiology 521:169-190. 
[29] Peterlin  Z.A.  Kozloski  J.  Mao  B.Q.  Tsiola  A. & Yuste  R. (2000) Optical probing of neuronal 
circuits with calcium indicators. Proceedings of the National Academy of Sciences of the United States 
of America 97(7):3619-3624. 

 

8 

[30]  Thomson   A.M.   Deuchars   J.  &  West   D.C.  (1993)  Large   deep  layer  pyramid-pyramid  single 
axon  EPSPs  in  slices  of  rat  motor  cortex  display  paired  pulse  and  frequency-dependent  depression  
mediated  presynaptically  and  self-facilitation   mediated  postsynaptically.  Journal  of  Neurophysiology 
70(6):2354-2369. 
[31] Baraniuk  R.G. (2007) Compressive sensing. Ieee Signal Processing Magazine 24(4):118-120. 
[32]  Candes   E.J.  (2008)  Compressed  Sensing.  Twenty-Second  Annual  Conference  on  Neural 
Information Processing Systems  Tutorials.  
[33]  Candes   E.J.   Romberg   J.K.  &  Tao   T.  (2006)  Stable  signal  recovery  from  incomplete  and 
inaccurate measurements. Communications on Pure and Applied Mathematics 59(8):1207-1223. 
[34]  Candes   E.J.  & Tao  T.  (2006)  Near-optimal  signal  recovery  from  random  projections:  Universal 
encoding strategies? Ieee Transactions on Information Theory 52(12):5406-5425. 
[35] Donoho  D.L. (2006) Compressed sensing. Ieee Transactions on Information Theory 52(4):1289-
1306. 
[36]  Ringach   D.  &  Shapley   R.  (2004)  Reverse  Correlation  in  Neurophysiology.  Cognitive  Science 
28:147-166. 
[37]  Schwartz   O.   Pillow   J.W.   Rust   N.C.  &  Simoncelli   E.P.  (2006)  Spike-triggered  neural 
characterization. Journal of Vision 6(4):484-507. 
[38] Candes  E.J. & Tao  T. (2005) Decoding by linear programming. Ieee Transactions on Information 
Theory 51(12):4203-4215. 
[39]  Needell   D.  &  Vershynin   R.  (2009)  Uniform  Uncertainty  Principle  and  Signal  Recovery  via 
Regularized Orthogonal Matching Pursuit. Foundations of Computational Mathematics 9(3):317-334. 
[40]  Tropp   J.A.  &  Gilbert   A.C.  (2007)  Signal  recovery  from  random  measurements  via  orthogonal 
matching pursuit. Ieee Transactions on Information Theory 53(12):4655-4666. 
[41]  Dai   W.  &  Milenkovic   O.  (2009)  Subspace  Pursuit  for  Compressive  Sensing  Signal 
Reconstruction. Ieee Transactions on Information Theory 55(5):2230-2249. 
[42]  Needell   D.  &  Tropp   J.A.  (2009)  CoSaMP:  Iterative  signal  recovery  from  incomplete  and 
inaccurate samples. Applied and Computational Harmonic Analysis 26(3):301-321. 
[43]  Varshney   L.R.   Sjostrom   P.J.  &  Chklovskii   D.B.  (2006)  Optimal  information  storage  in  noisy 
synapses under resource constraints. Neuron 52(3):409-423. 
[44]  Brunel   N.   Hakim   V.   Isope   P.   Nadal   J.P.  &  Barbour   B.  (2004)  Optimal  information  storage 
and the distribution of synaptic weights: perceptron versus Purkinje cell. Neuron 43(5):745-757. 
[45]  Napoletani   D.  &  Sauer   T.D.  (2008)  Reconstructing  the  topology  of  sparsely  connected 
dynamical networks. Physical Review E 77(2):026103. 
[46]  Allen   C.  &  Stevens   C.F.  (1994)  An  evaluation  of  causes  for  unreliability  of  synaptic 
transmission.  Proceedings  of  the  National  Academy  of  Sciences  of  the  United  States  of  America 
91(22):10380-10383. 
[47]  Hessler   N.A.   Shirke   A.M.  &  Malinow   R.  (1993)  The  probability  of  transmitter  release  at  a 
mammalian central synapse. Nature 366(6455):569-572. 
[48] Isope  P. & Barbour  B. (2002) Properties of unitary granule cell-->Purkinje cell synapses in adult 
rat cerebellar slices. Journal of Neuroscience 22(22):9668-9678. 
[49] Mason  A.  Nicoll  A. & Stratford  K. (1991) Synaptic transmission between individual pyramidal 
neurons of the rat visual cortex in vitro. Journal of Neuroscience 11(1):72-84. 
[50]  Raastad   M.   Storm   J.F.  &  Andersen   P.  (1992)  Putative  Single  Quantum  and  Single  Fibre 
Excitatory  Postsynaptic Currents  Show Similar Amplitude Range  and Variability  in  Rat  Hippocampal 
Slices. European Journal of Neuroscience 4(1):113-117. 
[51]  Rosenmund   C.   Clements   J.D.  & Westbrook   G.L.  (1993)  Nonuniform  probability  of  glutamate 
release at a hippocampal synapse. Science 262(5134):754-757. 
[52]  Sayer   R.J.   Friedlander   M.J.  &  Redman   S.J.  (1990)  The  time  course  and  amplitude  of  EPSPs 
evoked  at  synapses  between  pairs  of  CA3/CA1  neurons  in  the  hippocampal  slice.  Journal  of 
Neuroscience 10(3):826-836. 
[53]  Cash   S.  & Yuste   R.  (1999)  Linear  summation  of  excitatory  inputs  by  CA1  pyramidal  neurons. 
Neuron 22(2):383-394. 
[54] Polsky  A.  Mel  B.W. & Schiller  J. (2004) Computational subunits in thin dendrites of pyramidal 
cells. Nature Neuroscience 7(6):621-627. 
[55]  Paninski   L.  (2003)  Convergence  properties  of  three  spike-triggered  analysis  techniques. 
Network: Computation in Neural Systems 14(3):437-464. 
[56]  Okatan   M.   Wilson   M.A.  &  Brown   E.N.  (2005)  Analyzing  functional  connectivity  using  a 
network likelihood model of ensemble neural spiking activity. Neural Computation 17(9):1927-1961. 
[57]  Timme   M.  (2007)  Revealing  network  connectivity  from  response  dynamics.  Physical  Review 
Letters 98(22):224101. 

 

9 

,Ignacio Rocco
Mircea Cimpoi
Relja Arandjelović
Akihiko Torii
Tomas Pajdla
Josef Sivic