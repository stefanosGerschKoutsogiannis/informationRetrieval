2013,Causal Inference on Time Series using Restricted Structural Equation Models,Causal inference uses observational data to infer the causal structure of the data generating system. We study a class of restricted Structural Equation Models for time series that we call Time Series Models with Independent Noise (TiMINo). These models require independent residual time series  whereas traditional methods like Granger causality exploit the variance of residuals. This work contains two main contributions: (1) Theoretical: By restricting the model class (e.g. to additive noise) we provide more general identifiability results than existing ones. The results cover lagged and instantaneous effects that can be nonlinear and unfaithful  and non-instantaneous feedbacks between the time series. (2) Practical: If there are no feedback loops between time series  we propose an algorithm based on non-linear independence tests of time series. When the data are causally insufficient  or the data generating process does not satisfy the model assumptions  this algorithm may still give partial results  but mostly avoids incorrect answers. The Structural Equation Model point of view allows us to extend both the theoretical and the algorithmic part to situations in which the time series have been measured with different time delays (as may happen for fMRI data  for example). TiMINo outperforms existing methods on artificial and real data. Code is provided.,Causal Inference on Time Series using Restricted

Structural Equation Models

Jonas Peters∗

Seminar for Statistics

ETH Z¨urich  Switzerland
peters@math.ethz.ch

Dominik Janzing

MPI for Intelligent Systems

T¨ubingen  Germany

Bernhard Sch¨olkopf

MPI for Intelligent Systems

T¨ubingen  Germany

janzing@tuebingen.mpg.de

bs@tuebingen.mpg.de

Abstract

Causal inference uses observational data to infer the causal structure of the data
generating system. We study a class of restricted Structural Equation Models for
time series that we call Time Series Models with Independent Noise (TiMINo).
These models require independent residual time series  whereas traditional meth-
ods like Granger causality exploit the variance of residuals. This work contains
two main contributions: (1) Theoretical: By restricting the model class (e.g. to
additive noise) we provide general identiﬁability results. They cover lagged and
instantaneous effects that can be nonlinear and unfaithful  and non-instantaneous
feedbacks between the time series. (2) Practical: If there are no feedback loops
between time series  we propose an algorithm based on non-linear independence
tests of time series. We show empirically that when the data are causally insuf-
ﬁcient or the model is misspeciﬁed  the method avoids incorrect answers. We
extend the theoretical and the algorithmic part to situations in which the time se-
ries have been measured with different time delays. TiMINo is applied to artiﬁcial
and real data and code is provided.

1

Introduction

We ﬁrst introduce the problem of causal inference on iid data  that is in the case with no time
structure. Let therefore X i  i ∈ V   be a set of random variables and let G be a directed acyclic
graph (DAG) on V describing the causal relationships between the variables. Given iid samples
from P(X i) i∈V   we aim at estimating the underlying causal structure of the variables X i  i ∈ V .
Constraint- or independence-based methods [e.g. Spirtes et al.  2000] assume that the joint distri-
bution is Markov  and faithful with respect to G. The PC algorithm  for example  exploits con-
ditional independences for reconstructing the Markov equivalence class of G (some edges remain
undirected). We say P(X i) i∈V satisﬁes a Structural Equation Model [Pearl  2009] w.r.t. DAG G
if for all i ∈ V we can write X i = fi(PAi  N i)   where PAi are the parents of node i in G. Ad-
ditionally  we require (N i)i∈V to be jointly independent. By restricting the function class one can
identify the bivariate case: Shimizu et al. [2006] show that if P(X Y ) allows for Y = a · X + NY
with NY ⊥⊥ X then P(X Y ) only allows for X = b · Y + NX with NX ⊥⊥ Y if (X  NY ) are jointly
Gaussian ( ⊥⊥ stands for statistical independence). This idea has led to the extensions of nonlin-
ear additive functions f (x  n) = g(x) + n [Hoyer et al.  2009]. Peters et al. [2011b] show how
identiﬁability for two variables generalizes to the multivariate case.

We now turn to the case of time series data. For each i from a ﬁnite V   let therefore(cid:0)X i

(cid:1)

t∈N be
a time series. Xt denotes the vector of time series values at time t. We call the inﬁnite graph that
t as a node the full time graph. The summary time graph contains all #V
contains each variable X i

t

∗Signiﬁcant parts of this research was done  when Jonas Peters was at the MPI T¨ubingen.

1

t−k to X j

components of the time series as vertices and an arrow between X i and X j  i (cid:54)= j  if there is an
t in the full time graph for some k. We are given a sample (X1  . . .   XT )
arrow from X i
of a multivariate time series and estimate the true summary time graph.
I.i.d. methods are not
directly applicable because a common history might introduce complicated dependencies between
contemporaneous data Xt and Yt. Nevertheless several methods dealing with time series data are
motivated by the iid setting (Section 2). Many of them encounter similar problems: when the model
assumptions are violated (e.g.
in the presence of a confounder) the methods draw false causal
conclusions. Furthermore  they do not include nonlinear instantaneous effects. In this work  we
extend the Structural Equation Model framework to time series data and call this approach time
series models with independent noise (TiMINo). These models include nonlinear and instantaneous
effects. They assume Xt to be a function of all direct causes and some noise variable  the collection
of which is supposed to be jointly independent. This model formulation comes with substantial
beneﬁts: In Section 3 we prove that for TiMINo models the full causal structure can be recovered
from the distribution. Section 4 introduces an algorithm (TiMINo causality) that recovers the model
structure from a ﬁnite sample.
If
the data do not satisfy the model assumptions  TiMINo causality remains mostly undecided instead
of drawing wrong causal conclusions. Section 5 deals with time series that have been shifted by
different (unknown) time delays. Experiments on simulated and real data sets are shown in Section 6.

It can be equipped with any algorithm for ﬁtting time series.

2 Existing methods

t−h  h > 0 is independent of X j

t given X k

Linear G-causality considers a VAR model: Xt =(cid:80)p

Granger causality [Granger  1969] (G-causality for the remainder of the article) is based on the
following idea: X i does not Granger cause X j if including the past of X i does not help in pre-
t given the past of all all other time series X k  k (cid:54)= i. In principle  “all other” means all
dicting X j
other information in the world. In practice  one is limited to X k  k ∈ V . The phrase “does not
help” is translated into a signiﬁcance test assuming a multivariate time series model. If the data
follow the assumed model  e.g. the VAR model below  G-causality is sometimes interpreted as test-
t−h  k ∈ V \ {i}  h > 0 [see Florens and
ing whether X i
Mouchart  1982  Eichler  2011  Chu and Glymour  2008  Quinn et al.  2011  and ANLTSM below].
τ =1 A(τ )Xt−τ + Nt   where Xt and Nt are
vectors and A(τ ) are matrices. For checking whether X i G-causes X j one ﬁts a full VAR model
t without using X j (using the constraints
Mfull to Xt and a VAR model Mrestr to Xt that predicts X i
A · i(τ ) = 0 for all 1 ≤ τ ≤ p). One tests whether the reduction of the residual sum of squares
t is signiﬁcant by using the following test statistic: T := (RSSrestr−RSSfull)/(pfull−prestr)
(RSS) of X i
 
where pfull and prestr are the number of parameters in the respective models. For the signiﬁcance
test we use T ∼ Fpfull−prestr N−pfull. G-causality has been extended to nonlinear G-causality  [e.g.
Chen et al.  2004  Ancona et al.  2004]. In this paper we focus on an extension for the bivariate
case proposed by Bell et al. [1996]. It is based on generalized additive models (gams) [Hastie and
Tibshirani  1990]: X i
t   where Nt is a #V dimensional noise
vector. Bell et al. [1996] utilize the same F statistic as above using estimated degrees of freedom.
Following Bell et al. [1996]  Chu and Glymour [2008] introduce additive nonlinear time series mod-
els (ANLTSM for short) for performing relaxed conditional independence tests: If including one
t−2 does not im-
variable  e.g. X 1
prove the predictability of X 2
t−2  X 2
t−2
(if the maximal time lag is 2). Chu and Glymour [2008] propose a method based on constraint-
based methods like FCI [Spirtes et al.  2000] in order to infer the causal structure exploiting those
conditional independence statements. The instantaneous effects are assumed to be linear and the
confounders linear and instantaneous.
TS-LiNGAM [Hyv¨arinen et al.  2008] is based on LiNGAM [Shimizu et al.  2006] from the iid
setting. It allows for instantaneous effects and assumes all relationships to be linear.
Instantaneous effects: G-causality
These approaches encounter some methodological problems.
cannot deal with instantaneous effects. E.g.  when Xt is causing Yt  including any of the two time
series helps for predicting the other and G-causality infers X → Y and Y → X. ANLTSM and
TS-LiNGAM only allow for linear instantaneous effects. Theorem 1 shows that the summary time
graph may still be identiﬁable when the instantaneous effects are linear and the variables are jointly
Gaussian. TS-LiNGAM does not work in these situations. Confounders: G-causality might fail

t that already includes X 2
t−2  X 2
t−1 is said to be independent of X 2

t−1  into a model for X 2
t   then X 1

t = (cid:80)p

τ =1

j=1 fi j τ (X j

t−τ ) + N i

(cid:80)n

RSSfull/(N−pfull)

t−1  and X 1
t given X 2

t−1  X 1

2

when there is a confounder between Xt and Yt+1  say. The path between Xt and Yt+1 cannot be
blocked by conditioning on any observed variables; G-causality infers X → Y . We will see empir-
ically that TiMINo remains undecided instead; Entner and Hoyer [2010] and Janzing et al. [2009]
provide (partial) results for the iid setting. ANLTSM does not allow for nonlinear confounders or
confounders with time structure and TS-LiNGAM may fail  too (Exp. 1). Robustness: Theorem 1
(ii) shows that performing general conditional independence tests sufﬁces. The conditioning sets 
however  are too large and the tests are performed under a simple model (e.g. VAR). If the model is
misspeciﬁed  one may draw wrong conclusions without noticing (e.g. Exp. 3).
For TiMINo (deﬁned below)  Lemma 1 shows that after ﬁtting and checking the model by using
unconditional independence tests  the difﬁcult conditional independences have been checked im-
plicitly. A model check is not new [e.g. Hoyer et al.  2009  Entner and Hoyer  2010] but is thus
an effective tool. We can equip bivariate G-causality with a test for cross-correlations; this is not
straight-forward for multivariate G-causality. Furthermore  using cross-correlation as an indepen-
dence test does not always sufﬁce (see Section 2).

3 Structural Equation models for time series: TiMINo

(cid:0)(PAi

0 ⊆ X V \{i}  PAi
0)t  N i
t

(cid:1)  

Deﬁnition 1 Consider a time series Xt = (X i
t )i∈V whose ﬁnite dimensional distributions are ab-
solutely continuous w.r.t a product measure (e.g. there is a pdf or pmf). The time series satisﬁes a
TiMINo if there is a p > 0 and ∀i ∈ V there are sets PAi

k ⊆ X V   s.t. ∀t

X i

t = fi

1)t−1  (PAi

p)t−p  . . .   (PAi

t jointly independent over i and t and for each i  N i

(1)
with N i
t are identically distributed in t. The
corresponding full time graph is obtained by drawing arrows from any node that appears in the
right-hand side of (1) to X i
t. We require the full time graph to be acyclic. Section 6 shows examples.
Theorem 1 (i) assumes that (1) follows an identiﬁable functional model class (IFMOC). This means
that (I) causal minimality holds  a weak form of faithfulness that assumes a statistical dependence
between cause and effect given all other parents [Spirtes et al.  2000]. And (II)  all fi come from a
function class that is small enough to make the bivariate case identiﬁable. Peters et al. [2011b] give
a precise deﬁnition. Important examples include nonlinear functions with additive Gaussian noise
and linear functions with additive non-Gaussian noise. Due to space constraints  proofs are provided
in the appendix. In the one-dimensional linear case model (1) is time-reversible if and only if the
noise is normally distributed [Peters et al.  2009].

t ) =(cid:83)p

Theorem 1 Suppose that Xt can be represented as a TiMINo (1) with PA(X i
being the direct causes of X i

t and that one of the following holds:

k=0(PAi

k)t−k

(i) Equations (1) come from an IFMOC (e.g. nonlinear functions fi with additive Gaussian
t ). The summary time

t or linear functions fi with additive non-Gaussian noise N i

noise N i
graph can contain cycles.

(ii) Each component exhibits a time structure (PA(X i

t ) contains at least one X i

t−k)  the joint

distribution is faithful w.r.t. the full time graph  and the summary time graph is acyclic.

Then the full time graph can be recovered from the joint distribution of Xt. In particular  the true
causal summary time graph is identiﬁable. (Neither of the conditions (i) and (ii) implies the other.)
t|Xt−p 
Many function classes satisfy (i) [Peters et al.  2013]. To estimate fi from data (E[X i
. . .   Xt−1] for additive noise) we require stationarity and/or α mixing  or geometric ergodicity [e.g.
Chu and Glymour  2008]. Condition (ii) shows how time structure simpliﬁes the causal inference
problem. For iid data the true graph is not identiﬁable in the linear Gaussian case; with time structure
it is. We believe that condition (ii) is more difﬁcult to verify in practice; faithfulness is not required
for (i). In (ii)  the acyclicity prevents the full time graph from being fully connected up to order p.

4 A practical method: TiMINo causality

The algorithm for TiMINo causality is based on the theoretical ﬁnding in Theorem 1. It takes the
time series data as input and outputs either a DAG that estimates the summary time graph or re-
mains undecided. It tries to ﬁt a TiMINo model to the data and outputs the corresponding graph. If

3

no model with independent residuals is found  it outputs “I do not know”. This becomes intractable
for a time series with many components; for time series without feedback loops  we adapt a method
for additive noise models without time structure suggested by Mooij et al. [2009] that avoids enu-
merating all DAGs. Algorithm 1 shows the modiﬁed version. As reported by Mooij et al. [2009] 
the time complexity is O(d2 · f (n  d) · t(n  d))  where d is the number of time series  n the sample
size and f (n  d) and t(n  d) the complexity of the user-speciﬁc regression method and independence
test  respectively. Peters et al. [2013] discuss the algorithm’s correctness. We present our choices
but do not claim their optimality  any other ﬁtting method and independence test can be used  too.

for k in S do

t−1  X i

t−p  . . .   X i

t−1  X i

Fit TiMINo for X k
t−p  . . .   X k
Test if residuals are indep. of X i  i ∈ S.

t using X k

Algorithm 1 TiMINo causality
1: Input: Samples from a d-dimensional time series of length T : (X1  . . .   XT )  maximal order p
2: S := (1  . . .   d)
3: repeat
4:
5:
6:
7:
8:

end for
Choose k∗ to be the k with the weakest dependence. (If there is no k with independence 
break and output: “I do not know - bad model ﬁt”).
S := S \ {k∗}; pa(k∗) := S

9:
10: until length(S)= 1
11: For all k remove all parents that are not required to obtain independent residuals.
12: Output: (pa(1)  . . .   pa(d))

t for i ∈ S \ {k}

t and another time series X i

Depending on the assumed model class  TiMINo causality has to be provided with a ﬁtting method.
Here  we chose the R functions ar for VAR ﬁtting (fi(p1  . . .   pr  n) = ai 1· p1 + . . . + ai r · pr + n) 
gam for generalized additive models (fi(p1  . . .   pr  n) = fi 1(p1)+. . .+fi r(pr)+n) [e.g. Bell et al. 
1996] and gptk for GP regression (fi(p1  . . .   pr  n) = fi(p1  . . .   pr) + n). We call the methods
TiMINo-linear  TiMINo-gam and TiMINo-GP  respectively. For the ﬁrst two AIC determines the
order of the process. All ﬁtting methods are used in a “standard way”. For gam we used the built-in
nonparametric smoothing splines. For the GP we used zero mean  squared exponential covariance
function and Gaussian Likelihood. The hyper-parameters are automatically chosen by marginal
likelihood optimization. Code is available online.
t   i ∈ S 
To test for independence between a residual time series N k
we shift the latter time series up to the maximal order ±p (but at least up to ±4); for each of those
combinations we perform HSIC [Gretton et al.  2008]  an independence test for iid data. One could
also use a test based on cross-correlation that can be derived from Thm 11.2.3. in [Brockwell and
Davis  1991]. This is related to what is done in transfer function modeling [e.g. §13.1 in Brockwell
and Davis  1991]  which is restricted to two time series and linear functions. As opposed to the
iid setting  testing for cross-correlation is often enough in order to reject a wrong model. Only
Experiments 1 and 5 describe situations  in which cross-correlations fail. To reduce the running
time one can use cross-correlation to determine the graph structure and use HSIC as a ﬁnal model
check. For HSIC we used a Gaussian kernel; as in [Gretton et al.  2008]  the bandwidth is chosen
such that the median distance of the input data leads to an exponent of one. Testing for non-vanishing
autocorrelations in the residuals is not included yet.
If the model assumptions only hold in some parts of the summary time graph  we can still try
to discover parts of the causal structure. Our code package contains this option. We obtained
positive results on simulated data but there is no corresponding identiﬁability statement.
Our method has some potential weaknesses. It can happen that one is able to ﬁt a model only in the
wrong direction. This  however  requires an “unnatural” ﬁne tuning of the functions [Janzing and
Steudel  2010] and is relevant only when there are time series without time structure or the data are
non-faithful (see Theorem 1). The null hypothesis of the independence test represents independence 
although the scientiﬁc discovery of a causal relationship should rather be the alternative hypothesis.
This fact may lead to wrong causal conclusions (instead of “I do not know”) on small data sets.The
effect is strengthened by the Bonferroni correction of the HSIC based independence test; one may
require modiﬁcations for a high number of time series components. For large sample sizes  even

4

smallest differences between the true data generating process and the model may lead to rejected
independence tests [discussed by Peters et al.  2011a].

5 TiMINo for Shifted Time Series

t = X i

t = X i

t we are then working with ˜X i

In some applications  we observe the components of the time series with varying time delay. Instead
t−(cid:96)  with 0 ≤ (cid:96) ≤ k. E.g.  in functional magnetic resonance
of X i
imaging brain activity is measured through an increased blood ﬂow in the corresponding area. It
has been reported that these data often suffer from different time delays [e.g. Buxton et al.  1998 
Smith et al.  2011]. Given the (shifted) measurements ˜X i
t  we therefore have to cope with causal
relationships that go backward in time. This is only resolved when going back to the unobserved
t. Measures like Granger causality will fail in these situations. This does not necessarily
true data X i
have to be the case  however. The structure still remains identiﬁable even if we observe ˜X i
t instead
of ˜X i
t (the following theorem generalizes the second part of Theorem 1 and is proved accordingly)1:
t−(cid:96)  where 0 ≤ (cid:96) ≤ k are unknown
Theorem 2 Assume condition (ii) from Theorem 1 with ˜X i
time delays. Then  the full time graph of ˜Xt is identiﬁable from the joint distribution of ˜Xt. In
particular  the summary time graphs of ˜Xt and Xt are identical and therefore identiﬁable.
As opposed to Theorem 1 we cannot identify the full time graph of Xt. It may not be possible  for
example  to distinguish between a lag two effect from X 1 to X 2 and a corresponding lag one effect
with a shifted time series X 2. The method for recovering the network structure stays almost the same
as the one for non-shifted time series. only line 5 of Algorithm 1 has to be updated: we additionally
t+(cid:96) for 0 ≤ (cid:96) ≤ k for all i ∈ S \ {k}. While TiMINo exploits an asymmetry between
include X i
cause and effect emerging from restricted structural equations  G-causality exploits the asymmetry
of time. The latter asymmetry is broken when considering shifted time series.

6 Experiments

6.1 Artiﬁcial Data

We always included instantaneous effects  ﬁtted models up to order p = 2 or p = 6 and set α = 0.05.
Experiment 1: Confounder with time lag. We simulate 100 data sets (length 1000) from Zt =
a · Zt−1 + NZ t  Xt = 0.6 · Xt−1 + 0.5 · Zt−1 + NX t  Yt = 0.6 · Yt−1 + 0.5 · Zt−2 + NY t  with a
between 0 and 0.95 and N· t ∼ 0.4·N (0  1)3. Here  Z is a hidden common cause for X and Y . For
all a  Xt contains information about Zt−1 and Yt+1 (see Figure 1); G-causality and TS-LiNGAM
wrongly infer X → Y . For large a  Yt contains additional information about Xt+1  which leads
to the wrong arrow Y → X. TiMINo causality does not decide for any a. The nonlinear methods
perform very similar (not shown). For a = 0  a cross-correlation test is not enough to reject X → Y .
Further  all methods fail for a = 0 and Gaussian noise. (Similar results for non-linear confounder.)
Experiment 2: Linear  Gaussian with instantaneous effects. We sample 100 data sets (length
2000) from Xt = A1 · Xt−1 + NX t  Wt = A2 · Wt−1 + A3 · Xt + NW t  Yt = A4 · Yt−1 + A5 ·
Wt−1 + NY t  Zt = A6· Zt−1 + A7· Wt + A8· Yt−1 + NZ t and N· t ∼ 0.4·N (0  1) and Ai iid from
U([−0.8 −0.2] ∪ [0.2  0.8]). We regard the graph containing X → W → Y → Z and W → Z as
correct. TS-LiNGAM and G-causality are not able to recover the true structure (see Table 1). We
obtain similar results for non-linear instantaneous interactions.
Experiment 3: Nonlinear  non-Gaussian without instantaneous effects. We simulate 100 data
sets (length 500) from Xt = 0.8Xt−1 + 0.3NX t  Yt = 0.4Yt−1 + (Xt−1 − 1)2 + 0.3NY t  Zt =
0.4Zt−1 + 0.5 cos(Yt−1) + sin(Yt−1) + 0.3NZ t  with N· t ∼ U([−0.5  0.5]) (similar results for
other noise distributions  e.g. exponential). Thus  X → Y → Z is the ground truth. Nonlinear
G-causality fails since the implementation is only pairwise and it thus always infers an effect from
X to Z. Linear G-causality cannot remove the nonlinear effect from Xt−2 to Zt by using Yt−1. Also
TiMINo-linear assumes a wrong model but does not make any decision. TiMINo-gam and TiMINo-
GP work well on this data set (Table 2). This speciﬁc choice of parameters show that a signiﬁcant

1We believe that a corresponding statement for condition (i) holds  too.

5

Xt−2

Zt−2

Yt−2

a

Xt−1

Zt−1

Yt−1

a

Xt

Zt

Yt

a

Xt+1

Zt+1

Yt+1

Figure 1: Exp.1: Part of the causal full time graph with hidden common cause Z (top left). TiMINo
causality does not decide (top right)  whereas G-causality and TS-LiNGAM wrongly infer causal
connections between X and Y (bottom).

DAG
correct
wrong
no dec.

G-causal.

linear
13%
87%
0%

TiMINo
linear
83%
7%
10%

TS-

LiNGAM

19%
81%
0%

Table 1: Exp.2: Gaussian data and linear
instantaneous effects: only TiMINo mostly
discovers the correct DAG.

Figure 2: Exp.4: TiMINo-GP (blue) works reli-
ably for long time series. TiMINo-linear (red) and
TiMINo-gam (black) mostly remain undecided.

difference in performance is possible. For other parameters (e.g. less impact of the nonlinearity) 
G-causality and TS-LiNGAM still assume a wrong model but make fewer mistakes.

Table 2: Exp.3: Since the data are nonlinear  linear G-causality and TS-LiNGAM give wrong an-
swers  TiMINo-lin does not decide. Nonlinear G-causality fails because it analyzes the causal struc-
ture between pairs of time series.

DAG
correct
wrong
no dec.

Grangerlin Grangernonlin

TiMINolin

TiMINogam

TiMINoGP

TS-LiNGAM

69%
31%
0%

0%

100%

0%

0%
0%

100%

95%
1%
4%

94%
1%
5%

12%
88%
0%

Experiment 4: Non-additive interaction. We simulate 100 data sets with different lengths from
Xt = 0.2· Xt−1 + 0.9NX t  Yt = −0.5 + exp(−(Xt−1 + Xt−2)2) + 0.1NY t  with N· t ∼ N (0  1).
Figure 2 shows that TiMINo-linear and TiMINo-gam remain mainly undecided  whereas TiMINo-
GP performs well. For small sample sizes  one observes two effects: GP regression does not obtain
accurate estimates for the residuals  these estimates are not independent and thus TiMINo-GP re-
mains more often undecided. Also  TiMINo-gam makes more correct answers than one would ex-
pect due to more type II errors. Linear G-causality and TS-LiNGAM give more than 90% incorrect
answers  but non-linear G-causality is most often correct (not shown). Bad model assumptions do
not always lead to incorrect causal conclusions.
Experiment 5: Non-linear Dependence of Residuals. In Experiment 1  TiMINo equipped with a
cross-correlation inferred a causal edge  although there were none. The opposite is also possible:
t−1 + NY t and N· t ∼ 0.4·N (0  1) (length 1000).
Xt = −0.5· Xt−1 + NX t  Yt = −0.5· Yt−1 + X 2
TiMINo-gam with cross-correlation infers no causal link between X and Y   whereas TiMINo-gam
with HSIC correctly identiﬁes X → Y .
Experiment 6: Shifted Time Series. We simulate 100 random DAGs with #V = 3 nodes by
choosing a random ordering of the nodes and including edges with a probability of 0.6. The struc-
tural equations are additive (gam). Each component is of the form f (x) = a · max(x −0.1) + b ·

sign(x)(cid:112)|x|  with a  b iid from U([−0.5 −0.2] ∪ [0.2  0.5]). We sample time series (length 1000)

from Gaussian noise and observe the sink node time series with a time delay of three. This makes all

6

00.10.20.30.40.50.60.70.80.9confounder parameter aTS−LiNGAM0.00.40.8noneY −> XbothX −> Y00.10.20.30.40.50.60.70.80.9TiMINo (linear)0.00.40.8no decisionnoneY −> XX −> Y00.10.20.30.40.50.60.70.80.9confounder parameter aG−caus. (linear)0.00.40.8noneY −> XbothX −> Y10030050070090000.51length of time seriesprop. of correct (−)and incorrect (−.)answerstraditional methods inapplicable. The performance of linear G-causality  for example  drops from
an average Structural Hamming Distance (SHD) of 0.38 without time delay to 1.73 with time delay.
TiMINo-gam causality recognizes the wrong model assumption. The SHD increases from 0.13 (17
undecided cases) to 0.71 (79 undecided cases). Adjusting for a time delay (Section 5) yields an
SHD of 0.70 but many more decisions (18 undecided cases). Although it is possible to adjust for
time delays  the procedure enlarges the model space  which makes rejecting all wrong models more
difﬁcult. Already #V = 5 leads to worse average SHD: G-causality: 4.5  TiMINo-gam: 1.5 (92
undecided cases) and TiMINo-gam with time delay adjustment: 2.4 (38 undecided cases).

6.2 Real Data

We ﬁtted up to order 6 and included instantaneous effects. For TiMINo  “correct” means that
TiMINo-gam is correct and TiMINo-linear is correct or undecided. TiMINo-GP always remains
undecided because there are too few data points to ﬁt such a general model. Again  α is set to 0.05.
Experiment 7: Gas Furnace. [Box et al.  2008  length 296]  Xt describes the input gas rate and
Yt the output CO2. We regard X → Y as being true. TS-LiNGAM  G-causality  TiMINo-lin
and TiMINo-gam correctly infer X → Y . Disregarding time information leads to a wrong causal
conclusion: The method described by Hoyer et al. [2009] leads to a p-value of 4.8% in the correct
and 9.1% in the false direction.
Experiment 8: Old Faithful. [Azzalini and Bowman  1990  length 194] Xt contains the duration
of an eruption and Yt the time interval to the next eruption of the Old Faithful geyser. We regard
X → Y as the ground truth. Although the time intervals [t  t + 1] do not have the same length for all
t  we model the data as two time series. TS-LiNGAM and TiMINo give correct answers  whereas
linear G-causality infers X → Y   and nonlinear G-causality infers Y → X.
Experiment 9: Abalone (no time structure). The abalone data set [Asuncion and Newman  2007]
contains (among others that lead to similar results) age Xt and diameter Yt of a certain shell ﬁsh.
If we model 1000 randomly chosen samples as time series  G-causality (both linear and nonlinear)
infers no causal relation as expected. TS-LiNGAM wrongly infers Y → X  which is probably due
to the nonlinear relationship. TiMINo gives the correct result.
Experiment 10: Diary (confounder). We consider 10 years of weekly prices for butter Xt and
cheddar cheese Yt (length 522  http://future.aae.wisc.edu/tab/prices.html) We
expect their strong correlation to be due to the (hidden) milk price Mt: X ← M → Y . TiMINo
does not decide  whereas TS-LiNGAM and G-causality wrongly infer X → Y . This may be due to
different time lags of the confounder (cheese has longer storing and maturing times than butter).
Experiment 11: Temperature in House. We placed temperature sensors in six rooms (1 - Shed 
2 - Outside  3 - Kitchen Boiler  4 - Living Room  5 - WC  6 - Bathroom) of a house in the black
forest and recorded the temperature on an hourly basis (length 7265). This house is not inhabited
for most of the year  and lacking central heating; the few electric radiators start if the temperatur
drops close to freezing. TiMINo does not decide since the model leads to dependent residuals.
Although we do not provide any theory for the following steps  we analyze the model leading to
the “least dependent” residuals by setting the test level α to zero. TiMINo causality then outputs
a causal ordering of the variables. We applied TiMINo-lin and TiMINo-gam to the data sets using
lags up to twelve (half a day) and report the proportion in which node i precedes node j (see matrix).
This procedure reveals a sensible causal structure (we -
arbitrarily- refer to entries larger than 0.5 as causation). 2
(outside) causes all other readings  and none of the other
temperatures causes 2. 1 (shed) causes all other readings
except for 2. This is wrong  but not surprising since the
shed’s temperature is rather close to the outside temper-
ature. 4 (living room) does not cause any other reading 
but every other reading does cause it (the living room is
the only room without any heating). The links 5 → 3 and 6 → 3 appear spurious  and come with
numbers close to 0.5. These might be erroneous  however  they might also be due to the fact that
sensor 3 is sitting on top of the kitchen boiler  which acts as a heat reservoir that delays temperature
changes. The link 6 → 5 comes with a large number  but it is plausible since unlike the WC  the



0.25
0.67
0.67

0.83
0.83

0.75
0.17

1
1

0
1
1

1
1

0
0
1

1
1

0
0
0

0.75

0.33

0.33

0

0
0
0

0

0
0
0

0.25

0.17

0



7

bathroom has a window and is thus affected directly by outside temperature  causing fast regulation
of its radiator  which is placed on a thin wooden wall facing the WC.
The phase slope index [Nolte et al.  2008] performed well in Exp. 7  in all other experiments it either
gave wrong results or did not decide. Due to space constraints we omit details about this method.
We did not ﬁnd any code for ANLTSM.

7 Conclusions and Future Work

This paper shows how causal inference on time series beneﬁts from the framework of Structural
Equation Models. The identiﬁability statement is more general than existing results. The algorithm
is based on unconditional independence tests and is applicable to multivariate  linear  nonlinear
and instantaneous interactions. It contains the option of remaining undecided. While methods like
Granger causality are built on the asymmetry of time direction  TiMINo additionally takes into ac-
count identiﬁability emerging from restricted structural equation models. This leads to a straightfor-
ward way of dealing with (unknown) time delays in the different time series. Although an extensive
evaluation on real data sets is still required  we believe that our results emphasize the potential use
of causal inference methods. They may provide guidance for future interventional experiments.
As future work one may use heteroscedastic models [Chen et al.  2012] and systematically prepro-
cess the data (removing trends  periodicities  etc.). This may reduce the number of cases where
TiMINo causality is undecided. TiMINo causality evaluates a model ﬁt by checking independence
of the residuals. As suggested in Mooij et al. [2009]  Yamada and Sugiyama [2010]  one may make
the independence of the residuals as a criterion for the ﬁtting process or at least for order selection.

8 Appendix

t−k → X 2

t )i∈V satisfy a TiMINo model  each

0(in G) = PAi

0(in G(cid:48)) ∀i. Wlog  there is some k > 0 and an edge X 1

t . Applied to G  causal minimality leads to a contradiction: X 1

k)t−k and Eq. (1) we get X i

t ) for an s
t is a function of all noise variables from its ancestors and
(cid:3)

t is conditionally independent of each of its non-descendants given its parents.
t|S=s = fi(s  N i
t given S = s. This is the only time we assume t ∈ N in this paper.

Lemma 1 (Markov Condition for TiMINo) If Xt = (X i
variable X i
Proof . With S := PA(X i
with p(s) > 0. Any non-descendant of X i
is thus independent of X i
Proof of Theorem 1 Suppose that Xt allows for two TiMINo representations that lead to different
full time graphs G and G(cid:48).
(i) Assume that G and G(cid:48) do not differ in the instantaneous effects:
PAi
t   say  that is in
t−l  1 ≤ l ≤
t−k ⊥⊥ X 2
G but not in G(cid:48). From G(cid:48) and Lemma 1 we have that X 1
p  i ∈ V } ∪ NDt) \ {X 1
t }  and NDt are all X i
t that are non-descendants (wrt instantaneous
t |S . Now 
effects) of X 2
t−l  1 ≤ l ≤ p  i ∈ V }. For
let G and G(cid:48) differ in the instantaneous effects and choose S = {X i
i
each s and i we have: X i
0 are all instantaneous parents of X i
conditioned on S = s. All X i
t|S=s with the instantaneous effects describe two different structures
t
of an IFMOC. This contradicts the identiﬁability results by Peters et al. [2011b]. (ii) Because of
Lemma 1 and faithfulness G and G(cid:48) only differ in the instantaneous effects. But each instantaneous
t−k cannot be connected with
arrow X i
(cid:3)
t since this introduces a cycle in the summary time graph.
X i
Proof of Theorem 2 Two full time graphs G and G(cid:48) for ˜Xt can differ only in the directions of edges
t+k in G(cid:48). Choose the largest k
between time series. Assume X i
possible. Then there is a v-structure X i
t+k for some (cid:96). A connection between X i
t−(cid:96)
(cid:3)
and X j

t ← X j
t+k would lead to a pair as above with a larger k.

t |S   where S = ({X i
t−k (cid:54)⊥⊥ X 2

t → X j

t+k in G and X i

t ← X j

t forms a v-structure together with X j

t|S=s = fi(s  ( ˜PA

i

0)t)  where ˜PA

t → X j

t−k → X j

t ; X j

t ) =(cid:83)p

k=0(PAi

t−k  X 2

t−(cid:96) → X i

References
N. Ancona  D. Marinazzo  and S. Stramaglia. Radial basis function approach to nonlinear Granger causality of

time series. Phys. Rev. E  70(5):056221  2004.

8

A. Asuncion and D. J. Newman. UCI repository. http://archive.ics.uci.edu/ml/  2007.
A. Azzalini and A. W. Bowman. A look at some data on the Old Faithful Geyser. Applied Statistics  39(3):

357–365  1990.

D. Bell  J. Kay  and J. Malley. A non-parametric approach to non-linear causality testing. Economics Letters 

51(1):7–18  1996.

G. E. P. Box  G. M. Jenkins  and G. C. Reinsel. Time series analysis: forecasting and control. Wiley series in

probability and statistics. John Wiley  2008.

P. J. Brockwell and R. A. Davis. Time Series: Theory and Methods. Springer  2nd edition  1991.
R. B. Buxton  E. C. Wong  and L. R. Frank. Dynamics of blood ﬂow and oxygenation changes during brain

activation: The balloon model. Magnetic Resonance in Medicine  39(6):855–864  1998.

Y. Chen  G. Rangarajan  J. Feng  and M. Ding. Analyzing multiple nonlinear time series with extended Granger

causality. Physics Letters A  324  2004.

Z. Chen  K. Zhang  and L. Chan. Causal discovery with scale-mixture model for spatiotemporal variance

dependencies. In NIPS 25  2012.

T. Chu and C. Glymour. Search for additive nonlinear time series causal models. Journal of Machine Learning

Research  9:967–991  2008.

M. Eichler. Graphical modelling of multivariate time series. Probability Theory and Related Fields  2011.
D. Entner and P. Hoyer. Discovering unconfounded causal relationships using linear non-Gaussian models. In

JSAI-isAI Workshops  2010.

J. P. Florens and M. Mouchart. A note on noncausality. Econometrica  50(3):583–591  1982.
C. W. J. Granger. Investigating causal relations by econometric models and cross-spectral methods. Economet-

rica  37(3):424–38  July 1969.

A. Gretton  K. Fukumizu  C. H. Teo  L. Song  B. Sch¨olkopf  and A. Smola. A kernel statistical test of indepen-

dence. In NIPS 20  Canada  2008.

T. J. Hastie and R. J. Tibshirani. Generalized additive models. London: Chapman & Hall  1990.
P. Hoyer  D. Janzing  J. Mooij  J. Peters  and B. Sch¨olkopf. Nonlinear causal discovery with additive noise

models. In NIPS 21  Canada  2009.

A. Hyv¨arinen  S. Shimizu  and P. Hoyer. Causal modelling combining instantaneous and lagged effects: an

identiﬁable model based on non-gaussianity. In ICML 25  2008.

D. Janzing and B. Steudel. Justifying additive-noise-model based causal discovery via algorithmic information

theory. Open Systems and Information Dynamics  17:189–212  2010.

D. Janzing  J. Peters  J.M. Mooij  and B. Sch¨olkopf. Identifying confounders using additive noise models. In

UAI 25  2009.

J. Mooij  D. Janzing  J. Peters  and B. Sch¨olkopf. Regression by dependence minimization and its application

to causal inference. In ICML 26  2009.

G. Nolte  A. Ziehe  V. Nikulin  A. Schl¨ogl  N. Kr¨amer  T. Brismar  and K.-R. M¨uller. Robustly Estimating the

Flow Direction of Information in Complex Physical Systems. Physical Review Letters  100  2008.

J. Pearl. Causality: Models  reasoning  and inference. Cambridge Univ. Press  2nd edition  2009.
J. Peters  D. Janzing  A. Gretton  and B. Sch¨olkopf. Detecting the dir. of causal time series. In ICML 26  2009.
J. Peters  D. Janzing  and B. Sch¨olkopf. Causal inference on discrete data using additive noise models. IEEE

Trans. Pattern Analysis Machine Intelligence  33(12):2436–2450  2011a.

J. Peters  J. Mooij  D. Janzing  and B. Sch¨olkopf. Identiﬁability of causal graphs using functional models. In

UAI 27  2011b.

J. Peters  J. Mooij  D. Janzing  and B. Sch¨olkopf. Causal discovery with continuous additive noise models 

2013. arXiv:1309.6779.

C. Quinn  T. Coleman  N. Kiyavash  and N. Hatsopoulos. Estimating the directed information to infer causal
relationships in ensemble neural spike train recordings. Journal of Comp. Neuroscience  30(1):17–44  2011.
S. Shimizu  P. Hoyer  A. Hyv¨arinen  and A. J. Kerminen. A linear non-Gaussian acyclic model for causal

discovery. Journal of Machine Learning Research  7:2003–2030  2006.

S. M. Smith  K. L. Miller  G. Salimi-Khorshidi  M. Webster  C. F. Beckmann  T. E. Nichols  J. D. Ramsey  and

M. W. Woolrich. Network modelling methods for FMRI. NeuroImage  54(2):875 – 891  2011.

P. Spirtes  C. Glymour  and R. Scheines. Causation  Prediction  and Search. MIT Press  2nd edition  2000.
M. Yamada and M. Sugiyama. Dependence minimizing regression with model selection for non-linear causal

inference under non-Gaussian noise. In AAAI. AAAI Press  2010.

9

,Jonas Peters
Dominik Janzing
Bernhard Schölkopf
Zohar Karnin
Oren Anava
Bingzhe Wu
Shiwan Zhao
Chaochao Chen
Haoyang Xu
Li Wang
Xiaolu Zhang
Guangyu Sun
Jun Zhou