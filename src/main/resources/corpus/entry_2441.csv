2009,Hierarchical Mixture of Classification Experts Uncovers Interactions between Brain Regions,The human brain can be described as containing a number of functional regions. For a given task  these regions  as well as the connections between them  play a key role in information processing in the brain. However  most existing multi-voxel pattern analysis approaches either treat multiple functional regions as one large uniform region or several independent regions  ignoring the connections between regions. In this paper  we propose to model such connections in an Hidden Conditional Random Field (HCRF) framework  where the classifier of one region of interest (ROI) makes predictions based on not only its voxels but also the classifier predictions from ROIs that it connects to. Furthermore  we propose a structural learning method in the HCRF framework to automatically uncover the connections between ROIs. Experiments on fMRI data acquired while human subjects viewing images of natural scenes show that our model can improve the top-level (the classifier combining information from all ROIs) and ROI-level prediction accuracy  as well as uncover some meaningful connections between ROIs.,Hierarchical Mixture of Classiï¬cation Experts
Uncovers Interactions between Brain Regions

Bangpeng Yao1

Dirk B. Walther2

Diane M. Beck2 3âˆ—

Li Fei-Fei1âˆ—

1Computer Science Department  Stanford University  Stanford  CA 94305

2Beckman Institute  University of Illinois at Urbana-Champaign  Urbana  IL 61801

3Psychology Department  University of Illinois at Urbana-Champaign  Champaign  IL 61820
{bangpeng feifeili}@cs.stanford.edu {walther dmbeck}@illinois.edu

Abstract

The human brain can be described as containing a number of functional regions.
These regions  as well as the connections between them  play a key role in in-
formation processing in the brain. However  most existing multi-voxel pattern
analysis approaches either treat multiple regions as one large uniform region or
several independent regions  ignoring the connections between them. In this paper
we propose to model such connections in an Hidden Conditional Random Field
(HCRF) framework  where the classiï¬er of one region of interest (ROI) makes
predictions based on not only its voxels but also the predictions from ROIs that it
connects to. Furthermore  we propose a structural learning method in the HCRF
framework to automatically uncover the connections between ROIs. We illus-
trate this approach with fMRI data acquired while human subjects viewed images
of different natural scene categories and show that our model can improve the
top-level (the classiï¬er combining information from all ROIs) and ROI-level pre-
diction accuracy  as well as uncover some meaningful connections between ROIs.

1 Introduction

In recent years  machine learning approaches for analyzing fMRI data have become increasingly
popular [15  24  18  16].
In these multi-voxel pattern analysis (MVPA) approaches  patterns of
voxels are associated with particular stimuli  leading to veriï¬able predictions about independent
test data. Voxels are extracted from previously known regions of interest (ROIs) [15  31]  selected
from the brain by some statistical criterion [24]  or deï¬ned by a sliding window (â€œsearchlightâ€)
positioned at each location in the brain in turn [20]. All of these methods  however  ignore the
highly interconnected nature of the brain.
Neuroanatomical evidence from macaque monkeys [10] indicates that brain regions involved in
visual processing are indeed highly interconnected. Since research on human subjects is largely
limited to non-invasive procedures  considerably less is known about interactions between visual
areas in the human brain. Here we demonstrate a method of learning the interactions between
regions from fMRI data acquired while human subjects view images of natural scenes.
Determining the category of a natural scene (e.g. classifying a scene as a beach  or a forest) is impor-
tant for many human activities such as navigation or object perception [30]. Despite the large variety
of images within and across categories  humans are very good at categorizing natural scenes [27  9].
In our recent study of natural scene categorization in humans with functional magnetic resonance
imaging (fMRI)  we discovered that information about natural scene categories is represented in pat-
terns of activity in the parahippocampal place area (PPA)  the retrosplenial cortex (RSC)  the lateral
occipital complex (LOC)  and the primary visual cortex (V1) [31]. We demonstrated that this infor-
mation can be read out from fMRI activity with a linear support vector machine (SVM) classiï¬er.

âˆ—

Diane M. Beck and Li Fei-Fei contributed equally to this work.

1

Given the highly interconnected nature of the brain  however  it is unlikely that these regions encode
natural scene categories independently of each other.
As previous ROI-based MVPA methods studies  in [31] we built predictors for each ROI indepen-
dently  ignoring their interactions. The method in [31] neither explores connections among the ROIs
nor uses the connections to build a classiï¬er on top of all ROIs. In this work  we propose a method
for simultaneously learning the voxel patterns associated with natural scene categories in sev-
eral ROIs and their interactions in a Hidden Conditional Random Field (HCRF) [28] frame-
work. In our model  the classiï¬er of each ROI makes predictions based on not only its voxels  but
also the prediction results of the ROIs that it connects to. Using the same fMRI data set  we also ex-
plore a mutual information based method to discover functional connectivity [5]. Our current model
differs from [5]  however  by applying a generative model to concurrently estimate the structure of
connectivity as well as maximize the end behavioral task (in this case  a scene classiï¬cation task).
Furthermore  we propose a structural learning method to automatically uncover the structure
of the interactions between ROIs for natural scene categorization  i.e.
to decide which ROIs
should be and which ones should not be connected. Unlike existing models for functional connec-
tivity  which mostly rely on the correlation of time courses of voxels [23]  our approach makes use of
the patterns of activity in ROIs as well as the category labels of the images presented to the subjects.
Built in the hierarchical framework of HCRF  our structural learning method utilizes information in
the voxel values at the bottom layer of the network as well as categorical labels at the top layer. In
our method  the connections between each pair of ROIs are evaluated for their potential to improve
prediction accuracy  and only those that show improvement will be added to the ï¬nal structural map.
In the remaining part of this paper  we ï¬rst elaborate on our model and structural learning approach
in Section 2. We discuss related work on MVPA and connectivity analysis in Section 3. Finally  we
present experimental results in Section 4 and conclude the paper in Section 5.

2 Modeling Interactions of Brain Regions: a HCRF Representation

The brain is highly interconnected  and the nature of the connections determines to a large extent
how information is processed in the brain. We model the connections of brain regions in a Hid-
den Conditional Random Field (HCRF) framework for the task of natural scene categorization and
propose a structural learning method to uncover the pattern of connectivity. In the ï¬rst part of this
section we assume that the structural connections between brain regions are already known. We will
discuss in Section 2.2 how these connections are automatically learned.

2.1

Integrating Information across Brain Regions

Suppose we are given a set of regions of interest (ROIs) and connections between these regions (see
the intermediate layer of Fig.1). Existing ROI-based MVPA approaches build a classiï¬er for each
ROI independently [15  24  18  16  31]  neglecting the connections between ROIs. It is our objective
here to explore the structure of the connections between ROIs to improve prediction accuracy for
decoding viewed scene category from fMRI data.
In order to achieve these goals  we propose a Hidden Conditional Random Field (HCRF) model
(Fig.1) to allow each ROI to be inï¬‚uenced by the ROIs that it connects to and build a top-level
classiï¬er which makes use of information in all ROIs. In this framework  the classiï¬er for one ROI
makes prediction based on the voxels in this region as well as the results of the classiï¬ers of its
connected ROIs  thereby improving the accuracy of each ROI. In the absence of evidence about
the directionality of connections  we assume them to be symmetric  i.e.  to allow the information
between two ROIs to go in both directions to the same extent. On the technical side  using an
undirected model avoids the difï¬culties of deï¬ning a coherent generative process for graph structures
in directed models  thereby giving us more ï¬‚exibility in representing complex patterns [29].
Our model starts with independently trained classiï¬ers for each ROI as in [31] (the bottom layer of
Fig.1). Consider an fMRI data set whose individual brain acquisitions are associated with one of
ğ¶ class labels. For an acquisition sample ğ‘–  the decision values of the ğ¶ independent classiï¬ers are
represented as ğ’³ ğ‘– = {Xğ‘–
ğ‘š ğ¶}
are the decision values for the ğ‘š-th ROI  where ğ‘¥ğ‘–
ğ‘š ğ‘ is the probability that region ğ‘š assigns sample
ğ‘– to the ğ‘-th class  irrespective of the information in any other ROI.

ğ‘€}  where ğ‘€ is the number of ROIs. Xğ‘–

1 â‹…â‹…â‹…   Xğ‘–

ğ‘š = {ğ‘¥ğ‘–

ğ‘š 1 â‹…â‹…â‹…   ğ‘¥ğ‘–

2

Illustration of

Figure 1:
the HCRF
model for modeling connections between
ROIs. Four ROIs  placed ï¬guratively on a
schematic brain  are shown here for illustra-
tion of the model. Superscripts indexing dif-
ferent samples are omitted in the ï¬gure. ğ‘
is the category label predicted from all ROIs.
ğ‘Œğ‘š  the hidden variable of the model  is the
prediction result of the classiï¬er of ROI ğ‘š.
Xğ‘š is the output of an independently trained
classiï¬er for ROI ğ‘š. Section 2.1 gives de-
tails about the three types of connections.
In the ï¬gure thicker lines represent stronger
connections 
thinner lines weaker connec-
tions. The weights of all connections and
connectivity pattern of the type-II potentials
are estimated by the model.

ğ‘š as input  the classiï¬er for ROI ğ‘š can directly predict sample ğ‘– as belonging to the ğ‘âˆ—-th
Given Xğ‘–
class if ğ‘¥ğ‘–
ğ‘š ğ‘âˆ— is the largest component of Xğ‘–
ğ‘š. However  this method ignores the dependencies
between ROIs. To remedy this  our model allows collaborative error-correction over the ROIs by
using the given structure of connections (the intermediate layer of Fig.1). Denoting the prediction
results of the ROI classiï¬ers as ğ’´ = {ğ‘Œ1 â‹…â‹…â‹…   ğ‘Œğ‘€}  where ğ‘Œğ‘š âˆˆ {1 â‹…â‹…â‹…   ğ¶} is the classiï¬er output
for ROI ğ‘š  our model allows for the predictions ğ‘Œğ‘š and ğ‘Œğ‘™ to interact if ROIs ğ‘š and ğ‘™ are connected
in the given structure (the intermediate layer in Fig.1).
Based on the ROI-level prediction results ğ’´  our model outputs the category label of sample ğ‘–: ğ‘ ğ‘– âˆˆ
{1 â‹…â‹…â‹…   ğ¶} (the top layer of Fig.1). Furthermore  because we cannot directly observe the prediction
of each ROI when acquiring the fMRI data  we treat ğ’´ as hidden variables. The underlying graphical
model is shown in Fig.1. To estimate the overall classiï¬cation probability given the observed voxel
values  we marginalize over all possible values of ğ’´. The HCRF model is therefore deï¬ned as

ğ‘(ğ‘ ğ‘–âˆ£ğ’³ ğ‘–; ğœ½) =

ğ‘(ğ‘ ğ‘– ğ’´âˆ£ğ’³ ğ‘–; ğœ½) =

ğ’´

(1)
where ğœ½ are the parameters of the model  and Î¨(ğ‘ ğ’´ ğ’³ ; ğœ½) is a potential function parameterized by
ğœ½. We deï¬ne the potential function Î¨(ğ‘ ğ’´ ğ’³ ; ğœ½) as the weighted sum of edge potential functions
deï¬ned on every edge ğ‘’ (2-clique) of the model:
Î¨(ğ‘ ğ’´ ğ’³ ; ğœ½) =

âˆ‘

ğœƒğ‘’ğœ“ğ‘’(ğ‘ ğ’´ ğ’³ )

(2)

âˆ‘

âˆ‘
âˆ‘
âˆ‘
ğ’´ exp(Î¨(ğ‘ ğ‘– ğ’´ ğ’³ ğ‘–; ğœ½))
ğ’´ exp(Î¨(ğ‘ ğ’´ ğ’³ ğ‘–; ğœ½))

ğ‘

ğ‘’

As shown in Fig.1  there are three types of potentials which describe different edges in the model:
Type-I Potential
ğ‘’ = (Xğ‘š  ğ‘Œğ‘š). Such edges model the distribution of class labels of different
ROIs conditioned on the observations Xğ‘š. The edge connects an Xğ‘š node and a ğ‘Œğ‘š node where
ğ‘š = 1 â‹…â‹…â‹…   ğ‘€. The edge potential function is deï¬ned by:

ğœ“ğ‘’(ğ‘ ğ’´ ğ’³ ) = ğ‘“ğ‘¦ğ‘¥(ğ‘Œğ‘š  Xğ‘š) = ğ‘¥ğ‘š ğ‘Œğ‘š

(3)
where ğ‘¥ğ‘š ğ‘Œğ‘š is the ğ‘Œğ‘š-th component of the vector Xğ‘š. A large weight for (Xğ‘š  ğ‘Œğ‘š) implies that
the independent classiï¬er trained on voxels of ROI ğ‘š is effective in giving correct predictions.
Type-II Potential
that not all pairs of ROIs are connected. The edge potential function is deï¬ned by:

ğ‘’ = (ğ‘Œğ‘š  ğ‘Œğ‘™). Such edges model the dependencies between the ROIs. Note

{

ğœ“ğ‘’(ğ‘ ğ’´ ğ’³ ) = ğ‘“ğ‘¦ğ‘¦(ğ‘Œğ‘š  ğ‘Œğ‘™) =

ğ›¼  ğ‘Œğ‘š = ğ‘Œğ‘™
0  ğ‘Œğ‘š âˆ•= ğ‘Œğ‘™

(4)

where ğ›¼ > 0. If two ROIs are connected  they tend to make similar predictions. A large weight for
(ğ‘Œğ‘š  ğ‘Œğ‘™) means the connection between ğ‘Œğ‘š and ğ‘Œğ‘™ is strong.
Type-III Potential
ğ‘’ = (ğ‘  ğ‘Œğ‘š). Such edges deï¬ne a joint distribution over the class label and the
prediction result of each ROI. The edge connects a ğ‘Œğ‘š node and the ğ‘ node where ğ‘š = 1 â‹…â‹…â‹…   ğ‘€.

3

Y1Y2Y3Y41234ZTop-layerIntermediate-layerBottom-layerType-IType-IIType-IIIPotentialsPotentialsPotentialsThe edge potential function is deï¬ned by:

ğœ“ğ‘’(ğ‘ ğ’´ ğ’³ ) = ğ‘“ğ‘¦ğ‘§(ğ‘Œğ‘š  ğ‘) =

{

ğ›½  ğ‘Œğ‘š = ğ‘
0  ğ‘Œğ‘š âˆ•= ğ‘

(5)

where ğ›½ > 0. A large weight for (ğ‘  ğ‘Œğ‘š) means ROI ğ‘š has a big contribution to the top-level
prediction of the brain.
Allowing connected ROIs to interact with each other makes our model signiï¬cantly different from
existing MVPA methods [15  24  18  16]  and can improve the prediction accuracy of each ROI.
Intuitively  if the values of all components in Xğ‘–
ğ‘š are similar  then ROI ğ‘š is likely to have incorrect
predictions if its classiï¬er merely relies on Xğ‘–
ğ‘š. In such situations it is possible for the classiï¬er for
one ROI to make better predictions if it can use the information in its connected ROIs.

2.2 Learning the Structural Connections of the Hidden Layer in HCRF Model

We have described a method that models the connections between ROIs to build a classiï¬cation
predictor on top of all ROIs. However  for many tasks (e.g. scene categorization)  one critical sci-
entiï¬c goal is to uncover which ROIs are functionally connected for that task. Automatic learning
of the structures of graphical models is a difï¬cult problem in machine learning. To illustrate the
difï¬culty  let us assume that we have 4 ROIs and that we want to explore all possible models of
connectivity between them. There are 6 possible connections between the ROIs  so in order to in-
vestigate whether all possible combinations of connections are present  we need to evaluate 26 = 64
different models. For 5 ROIs we have 10 potential connections  leading to 210 = 1024. In general 
given ğ‘€ ROIs  there are 2ğ‘€ (ğ‘€âˆ’1)/2 possible combinations of connections. In situations with many
ROIs  evaluating all possible structures quickly becomes impractical because of the computational
constraints. Approximate approaches to learn the structures of directed graphs use the generative
process in the model [21  19  32]. For undirected graphs  it is usually assumed that the structures are
pre-deï¬ned [29]. Some incremental approaches [26  22] were proposed for random ï¬elds construc-
tion. However the computational complexity of these approaches is still high.
In our model shown in Fig.1  the potentials represented by solid lines are ï¬xed (type-I and type-III).
That is to say  each ROI always makes predictions based on the information in its voxels  and the
response at the top level is always inï¬‚uenced by the prediction results of all ROIs. That leaves the
dependencies between ROIs (type-II edges  the dashed line in Fig.1) to be learned. Therefore  our
structural learning starts from a graphical model containing only type-I and type-III potentials  with-
out any interactions between ROIs. Based on this initial model  we evaluate each type-II potential
respectively to decide if it should be added to the model.
As we have described in Section 1  connections among ROIs play a key role in information process-
ing. Executing a speciï¬c task (e.g.  scene categorization) activates certain ROIs as well as rely on
connections between some of them. Inspired by this fact  we evaluate whether two ROIs  say ROIs
ğ‘š and ğ‘™  should be connected by comparing two models with and without an edge between ğ‘Œğ‘š and

Figure 2: An illustration for evaluating if ROIs 2 and 4 should be connected. All other ROIs are omitted. We
compare the performance of two modes with (left) and without (right) interactions between ROIs 2 and 4.

4

Y1Y2Y3Y41234ZTraining accuracy: cPTraining accuracy: nP24Connect  and YYIf and only if cnPP>Y1Y2Y3Y41234ZInput: ğ‘€ ROIs and their feature vectors ğ’³ = {X1 â‹…â‹…â‹…   Xğ‘€}. A HCRF model ğ’¢ with nodes ğ‘ 
ğ‘Œ1 â‹…â‹…â‹…   ğ‘Œğ‘€   X1 â‹…â‹…â‹…   Xğ‘€   and edges (ğ‘Œ1  X1) â‹…â‹…â‹…  (ğ‘Œğ‘€   Xğ‘€ )  (ğ‘  ğ‘Œ1) â‹…â‹…â‹…   (ğ‘  ğ‘Œğ‘€ ).
foreach pair of ROIs ğ‘š and ğ‘™ do

(ğ‘  ğ‘Œğ‘™)  (ğ‘Œğ‘š  ğ‘Œğ‘™). Obtain training accuracy ğ‘ƒğ‘;

Train an HCRF model with nodes ğ‘  ğ‘Œğ‘š  ğ‘Œğ‘™ ğ’³ğ‘š ğ’³ğ‘™  and edges (ğ‘Œğ‘š  Xğ‘š)  (ğ‘Œğ‘™  Xğ‘™)  (ğ‘  ğ‘Œğ‘š) 
Train an HCRF model with nodes ğ‘  ğ‘Œğ‘š  ğ‘Œğ‘™ ğ’³ğ‘š ğ’³ğ‘™  and edges (ğ‘Œğ‘š  Xğ‘š)  (ğ‘Œğ‘™  Xğ‘™)  (ğ‘  ğ‘Œğ‘š) 
if ğ‘ƒğ‘ > ğ‘ƒğ‘› then Add edge (ğ‘Œğ‘š  ğ‘Œğ‘™) to the input model ğ’¢;

(ğ‘  ğ‘Œğ‘™). Obtain training accuracy ğ‘ƒğ‘›;

Output: The updated model ğ’¢.

Algorithm 1: The algorithm for uncovering structural connections between ROIs in the HCRF model.

ğ‘Œğ‘™. If allowing interactions between ROIs ğ‘š and ğ‘™ helps to improve top-level recognition perfor-
mance  thus more closely approximating human performance  then ğ‘š and ğ‘™ should be connected.
Furthermore  we ignore information in all other ROIs when evaluating the connection between ROIs
ğ‘š and ğ‘™ (Fig.2). So the model will only contain 5 nodes: ğ‘  ğ‘Œğ‘š  ğ‘Œğ‘™  Xğ‘š  and Xğ‘™. Although some
useful information might be lost compared to evaluating all possible combinations of connections 
approximating the algorithm in this way can enable the evaluation of many possible connections in
a reasonable amount of time  making this algorithm much more practical.
The structural learning algorithm is shown in Algorithm 1  and an illustration of evaluating the
connection between ROI 2 and 4 is in Fig.2.

2.3 Model Learning and Inference

Learning In the step of structural learning  we need to estimate model parameters to compare the
models with or without a type-II connection (see Fig.2 for an illustration). Once we have determined
which ROIs should interact  i.e. which type-II potentials should be set  we would like to ï¬nd out the
strength of these connections as well as type-I and III potentials. Here the parameters ğœ½ = {ğœƒğ‘’}ğ‘’ are
learned by maximizing the conditional log-likelihood of class label ğ‘ on training data ğ’³ :

âˆ‘

ğœ½âˆ— = arg max

ğœ½

= arg max

ğœ½

âˆ‘

ğ‘–

ğ¿(ğœ½) = arg max

ğœ½

âˆ‘
log ğ‘(ğ‘ ğ‘–âˆ£ğ’³ ğ‘–; ğœ½)
âˆ‘
âˆ‘
ğ’´ exp(Î¨(ğ‘ ğ‘– ğ’´ ğ’³ ğ‘–; ğœ½))
ğ’´ exp(Î¨(ğ‘ ğ’´ ğ’³ ğ‘–; ğœ½))

ğ‘

ğ‘–

log

(6)

(8)

(9)

The objective function is not concave due to the hidden variables ğ’´. Although ï¬nding the global
optimum is difï¬cult  we can still ï¬nd a local optimum by iteratively updating the values of ğœ½ using
the gradient descent method. To be speciï¬c  we ï¬rst set ğœ½ to be initial values ğœ½(0)  and for each
iteration we adopt the following formula to update ğœ½(ğ‘›) to ğœ½(ğ‘›+1):

ğœ½(ğ‘›+1) = ğœ½(ğ‘›) âˆ’

G(ğœ½(ğ‘›))âŠ¤G(ğœ½(ğ‘›))

G(ğœ½(ğ‘›))âŠ¤H(ğœ½(ğ‘›))G(ğœ½(ğ‘›))

G(ğœ½(ğ‘›))

(7)

where G(ğœ½) and H(ğœ½) are the gradient vector and Hessian matrix of ğ¿(ğœ½) respectively. This it-
erative updating continues until reaching a maximum number of iterations or âˆ¥G(ğœ½)âˆ¥ is smaller
than a threshold. When the number of ROIs is large  marginalizing over all possible values of ğ’´ is
time-consuming. In such situations we can use Gibbs sampling to compute the gradient vector and
Hessian matrix of ğ¿(ğœ½). In the case of natural scene categorization  evidence from neuroscience
studies have postulated that 7 regions are likely to play critical roles in this task [31]. We therefore
consider 7 ROIs in our experiment  allowing us to marginalize over all possible values of Y.
Inference Given the model parameters ğœ½âˆ— and a sample ğ’³   the top-level prediction result is

ğ‘âˆ— = arg max

ğ‘

ğ‘(ğ‘âˆ£ğ’³ ; ğœ½âˆ—)

After ğ‘âˆ— is obtained  we can get the prediction results corresponding to each ROI by

ğ’´âˆ— = arg maxğ’´ ğ‘(ğ‘âˆ— ğ’´âˆ£ğ’³ ; ğœ½âˆ—)

5

3 Related Work

In this paper  we model the dependencies between ROIs in an HCRF framework  which improves
the ROI-level as well as the top-level decoding accuracy by allowing ROIs to exchange information.
Other approaches to inferring connections between brain regions from fMRI data can be broadly
separated into effective connectivity and functional connectivity [11]. Models for effective connec-
tivity  such as Granger causality mapping [14] and dynamic causal modeling [13]  model directed
connections between brain regions. These approaches were developed to account for biological tem-
poral dependencies  which is not the case in this work. Functional connectivity refers to undirected
connections  which can be either model-driven or data-driven [23]. Model-driven methods usually
test a prior hypothesis by correlating the time courses of a seed voxel and a target voxel [12]. Data-
driven methods  such as Independent Component Analysis [8]  are typically used to identify spatial
modes of coherent activity in the brain at rest.
None of these methods  however  has the ability to use the speciï¬c relation between the patterns
of voxel activations inside ROIs and the ground truth of the experimental condition. The structural
learning method proposed in this paper offers an entirely new way to assess the interactions between
brain regions based on the exchange of information between ROIs so that the accuracy of decoding
experimental conditions from the data is improved. Furthermore in contrast with the conventional
model comparison approaches of trying to optimize the evidence of each model [2]  our method
relates the connectivity structure to observed brain activities as well as the classes of stimuli that
elicited the activities. Therefore the model proposed here provides a novel and natural way to model
the implicit dependencies between different ROIs.

4 Experimental Evaluation

4.1 Data Set and Experimental Design

In order to evaluate the proposed method we re-analyze the fMRI data set from our work in [31].
In this experiment  5 subjects were presented with color images of 6 scene categories: beaches 
buildings  forests  highways  industry  and mountains. Photographs were chosen to capture the high
variability within each scene category. Images were presented in blocks of 10 images of the same
category lasting for 16 seconds (8 brain acquisitions). Each subject performed 12 runs  with each
run containing one block for each of the six categories. Please refer to [31] for more details.
We use 7 ROIs that are likely to play critical roles for natural scene categorization. They were
determined in separate localizer scans: V1  left/right LOC  left/right PPA  left/right RSC. The data
for two subjects were excluded  because not all of the ROIs could be found in the localizer scans
for these subjects. For the analysis we use two nested cross validations over the 12 runs for each
subject. In the outer loop we cross-validate on each subject to test the performance of the proposed
method. For each subject  11 runs out of 12 are selected as training samples and the remaining
run is used as the testing set. For each subject this procedure is repeated 12 times  in turn leaving
each run out for testing once. Average accuracy of the 36 experiments across all subjects is used to
evaluate the performance of the model. In the inner loop  we use 10 of the 11 training runs to train
an SVM classiï¬er for each ROI and each subject  and the remaining run to learn the connections
between ROIs and train the HCRF model by using outputs of the SVM classiï¬ers. We repeat this
procedure 11 times  giving us 11 models. Results of the 11 models on the test data in the inner loop
are combined using bagging [4]. We empirically set both ğ›¼ in Equ.(4) and ğ›½ in Equ.(5) to 0.5.

4.2 Scene Classiï¬cation Results and Analysis

In order to comprehensively evaluate the performance of the proposed structural learning and mod-
eling approach  we consider different settings of the intermediate layer of our HCRF model. While
always keeping all type-I and type-III potentials connected  we consider ï¬ve different dependencies
between the ROIs as shown in Fig.3. The setting in Fig.3(e) possesses all properties of our method:
the connections between ROIs are determined by structural learning  and the weights of the connec-
tions are obtained by estimating model parameters in Equ.(6). In order to estimate the effectiveness
of our structural learning method  we compare this setting with the situations where no connections
exists between any of the ROIs (Fig.3(a))  and all ROIs are fully connected (Fig.3(b c)). In each con-
nectivity situation  we either use the same (Fig.3(b d)) or different (Fig.3(c e)) weights for type-II

6

Figure 3: Various settings of the intermediate layer of our model. Dashed lines represent type-II potentials.
In each setting we keep all type-I and III potentials connected. For simplicity  we omit the visualizations of
type-I and III potentials here. Different line widths represent different potential weights. (a) No connection
exists between any pair of ROIs. (b c) The ROIs are fully connected. (d e) The connections between ROIs are
obtained by structural learning. (b d) All type-II potentials have equal weights. (c e) The weights of different
type-II potentials can be different. Note that (e) is the full model in this paper.

Table 1: Recognition accuracy for predicting natural scene categories with different methods (chance is 1/6).
â€œOverall classiï¬cationâ€ means the accuracy for predicting the categories by the top-level node in Fig.1. We
carry out experiments on the HCRF models with different settings of the type-II potentials  as shown in Fig.3.
Note that we always learn the weights of type-I and type-III potentials. We also list classiï¬cation results of
the SVM classiï¬ers independently trained on each ROI as the baseline. The bolded numbers indicate superior
performance compared to all other settings for each ROI.

Method

Overall classiï¬cation

ROI

V1

left LOC
right LOC
left PPA
right PPA
left RSC
right RSC

SVM Fig.3(a)
31%âˆ—
N/A
21%
22%
23%
22%
24%
25%
27%
27%
28%âˆ—
26%
30%âˆ—
30%
26%âˆ—
27%

âˆ—ğ‘ < 0.01;
Fig.3(b)
29%âˆ—
25%
27%
27%
26%
28%âˆ—
30%âˆ—
29%âˆ—

âˆ—âˆ—ğ‘ < 0.005.
Fig.3(c)
33%âˆ—âˆ—
24%
29%âˆ—
30%âˆ—
28%âˆ—
31%âˆ—
32%âˆ—
30%âˆ—

Fig.3(d)
34%âˆ—âˆ—
27%
31%âˆ—
29%âˆ—
31%âˆ—
31%âˆ—
33%âˆ—âˆ—
30%âˆ—

Fig.3(e)
36%âˆ—âˆ—
28%âˆ—
32%âˆ—âˆ—
33%âˆ—âˆ—
31%âˆ—
32%âˆ—âˆ—
35%âˆ—âˆ—
32%âˆ—âˆ—

potentials. Note that the type-II potentials of the models in Fig.3(b d) are also obtaining by learning.
Classiï¬cation accuracy of the ï¬ve different HCRF models  along with individual SVM classiï¬cation
accuracy for each ROI  is shown in Tbl.1. Note that the model with no type-II potentials (Fig.3(a))
is different from independent SVM classiï¬ers because of the type-I potentials.
From Table 1 it becomes clear that learning both the structure of the connections and their strengths
leads to more improvement in decoding accuracy than either one of these alone. The overall  top-
level classiï¬cation rate increases from 31% for the variant of the model without any connections
(Fig.3(a)) to 36% for the variant with the structure of the model as well as the connection strengths
learned (Fig.3(e)). We see similar improvements for the individual ROIs: 4-5% for PPA and RSC 
6% for V1  and 9% for LOC. The fact that decoding from LOC beneï¬ts most from interacting with
other ROIs is interesting and signiï¬cant. We will discuss this ï¬nding in more detail below.

4.3 Structural Learning Results and Analysis

Having established that our full HCRF model outperforms other comparison models in the recogni-
tion task  we now investigate how our model can shed light on learning connectivity between brain
regions. In the nested cross validation procedure  12Ã—11=132 structural maps are learned for each
subject. Tbl.2 reports for each subject which connections are present in what fraction of these struc-
tural maps. A connection is regarded as a strong connection for a subject if it presents in at least
half of the models learned for this subject. In Tbl.2 we use larger font size to denote the connections
which are strong on more subjects. Connections that are strong for all subjects are marked in bold.
We see that both LOC and PPA show strong interactions between the contralateral counterparts 
which makes sense for integrating information across the visual hemiï¬elds. We also observe strong
interactions between PPA and RSC across hemispheres  which underscores the importance of across-
hemiï¬eld integration of visual information. We see a similar effect in the interactions between LOC
and PPA: strong contralateral interactions. Left LOC also interacts strongly with right RSC.

7

Y1Y2Y3Y4Y1Y2Y3Y4Y1Y2Y3Y4Y1Y2Y3Y4Y1Y2Y3Y4Table 2: Statistics of structural connections. For each subject we have 132 learned structural maps (12-fold
cross-validation  each one has 11 models). This table shows the percentage of the times that the corresponding
connection is learned in the 132 experiments. Larger font size denotes connections that are strong on more
subjects. Connections that are strong on all subjects are marked in bold.

V1-leftLOC

V1-rightLOC

Connection

V1-leftPPA
V1-rightPPA
V1-leftRSC
V1-rightRSC

Sbj.1
0.67
0.50
0.44
0.38
0.29
0.36
leftLOC-rightLOC 0.66
0.46
0.75
0.41
0.75

leftLOC-rightRSC

leftLOC-rightPPA

leftLOC-leftRSC

leftLOC-leftPPA

Sbj.2
0.25
0.29
0.29
0.33
0.30
0.29
0.88
0.64
0.96
0.78
0.83

Sbj.3
0.33
0.54
0.36
0.69
0.23
0.59
0.71
0.76
0.65
0.61
0.76

Connection

rightLOC-leftRSC
rightLOC-rightRSC

Sbj.1
rightLOC-leftPPA 0.58
0.36
rightLOC-rightPPA
0.63
0.36
0.99
0.97
0.61
0.67
0.93
0.65

leftPPA-rightRSC
rightPPA-leftRSC
rightPPA-rightRSC

leftPPA-rightPPA

leftRSC-rightRSC

leftPPA-leftRSC

Sbj.2
0.58
0.58
0.38
0.30
0.56
0.34
0.53
0.74
0.74
0.20

Sbj.3
0.66
0.89
0.31
0.87
0.78
0.46
0.40
0.51
0.41
0.45

The strong interactions between PPA and RSC are not surprising  since both are typically associated
with the processing of natural scenes [25]  albeit with slightly different roles [7]. The interactions
between LOC and PPA are somewhat more surprising  since LOC is usually associated with the
processing of isolated objects. Together with the strong improvement of decoding accuracy for
natural scene categories from LOC when it is allowed to interact with other ROIs (see above)  this
suggests a role for LOC in scene categorization. It is conceivable that the detection of typical objects
(e.g.  a car) helps with determining the scene category (e.g.  highway)  as has been shown in [17 
6]. On the other hand  it is also possible that information ï¬‚ows the other way  that scene-speciï¬c
information in PPA and RSC feeds into LOC to bias object detection based on the scene category
(see [3  1])  and that the classiï¬er decodes this bias signal in LOC. Fig.4 shows the connections
which are strong on at least two subjects.

Figure 4: Schematic illustration of the connec-
tions between the seven ROIs obtained by our
structural learning method. Activated regions for
the seven ROIs are marked in red. The connec-
tions shown in this ï¬gure are strong on at least
two of the three subjects. Connections that are
strong for all three subjects (marked with bold
in Table 2) are marked with thicker lines in this
ï¬gure.

5 Conclusion

In this paper we modeled the interactions between brain regions in an HCRF framework. We also
presented a structural learning method to automatically uncover the connections between ROIs.
Experimental results showed that our approach can improve the top-level as well as ROI-level pre-
diction accuracy  as well as uncover some meaningful connections between ROIs. One direction for
future work is to use an exploratory â€œsearchlightâ€ approach [20] to automatically discover ROIs  and
apply our structural learning and modeling method to those ROIs.

Acknowledgements
This work is funded by National Institutes of Health Grant 1 R01 EY019429 (to L.F.-F.  D.M.B. 
D.B.W.)  a Beckman Postdoctoral Fellowship (to D.B.W.)  a Microsoft Research New Faculty Fel-
lowship (to L.F.-F.)  and the Frank Moss Gift Fund (to L.F-F.). The authors would like to thank
Barry Chai  Linjie Luo  and Hao Su for helpful comments and discussions.

8

right LOCV1left LOCright PPAleft PPAleftrightRSCRSCReferences
[1] M. Bar. Visual objects in context. Nature Rev Neurosci  5(8):617â€“629  2004.
[2] D. Barber and C. M. Bishop. Bayesian model comparison by monte carlo chaining. In NIPS  1997.
[3] I. Biederman. Perceiving real-world scenes. Science  177(4043):77â€“80  1972.
[4] L. Breiman. Bagging predictors. Mach Learn  24:123â€“140  1996.
[5] B. Chai
â€  âˆ—

brain using multivariate information analysis. In NIPS  2009. (

indicates equal contribution).

â€ 
  D. B. Walther

  and L. Fei-Fei

  D. M. Beck

. Exploring functional connectivities of the human

â€ 

âˆ—

âˆ—

[6] J. L. Davenport and M. C. Potter. Scene consistency in object and background perception. Psychol Sci 

15(8):559â€“564  2004.

[7] R. A. Epstein and J. S. Higgins. Differential parahippocampal and retrosplenial involvement in three types

of scene recognition. Cereb Cortex  17:1680â€“1693  2007.

[8] F. Esposito  E. Formisano  E. Seifritz  R. Geobel  R. Morrone  G. Tedeschi  and F. D. Salle. Spatial
independent component analysis of functional MRI time-series: To what extent do results depend on the
algorithm used. Hum Brain Mapp  16:146â€“157  2002.

[9] L. Fei-Fei  A. Iyer  C. Koch  and P. Perona. What do we perceive in a glance of a real-world scene? J

Vision  7(1):1â€“29  2007.

[10] D. J. Felleman and D. C. van Essen. Distributed hierarchical processing in the primate cerebral cortex.

Cereb Cortex  1:1â€“47  1991.

[11] K. J. Friston. Functional and effective connectivity in neuroimaging: a synthesis. Hum Brain Mapp 

2:56â€“78  1995.

[12] K. J. Friston  C. Frith  F. P. Liddle  and R. Frackowiak. Functional connectivity: The principal-component

analysis of large (PET) data sets. J Cerebr Blood F Met  13:5â€“14  1993.

[13] K. J. Friston  L. Harrison  and W. Penny. Dynamic causal modeling. NeuroImage  19:1273â€“1302  2003.
[14] R. Goebel  A. Roebroeck  D.-S. Kim  and E. Formisano. Investigating directed cortical interactions in
time-resolved fMRI data using vector autoregressive modeling and granger causality mapping. Magn
Reson Imaging  21:1251â€“1261  2003.

[15] J. V. Haxby  M. I. Gobbini  M. L. Furey  A. Ishai  J. Schouten  and P. Pietrini. Distributed and overlapping

representations of faces and objects in ventral temporal cortex. Science  293(5539):2425â€“2430  2001.

[16] J.-D. Haynes and G. Rees. Predicting the orientation of invisible stimuli from activity in human primary

visual cortex. Nat Neurosci  8:686â€“691  2005.

[17] A. Hollingworth and J. M. Henderson. Accurate visual memory for previously attended objects in natural

scenes. J Exp Psychol Human  28:113â€“136  2002.

[18] Y. Kamitani and F. Tong. Decoding the visual and subjective contents of the human brain. Nat Neurosci 

8:679â€“685  2005.

[19] C. Kemp and J. B. Tenenbaum. The discovery of structural form. P Natl Acad Sci USA  105(31):10687â€“

10692  2008.

[20] N. Kriegeskorte  R. Goebel  and P. Bandettini. Information-based functional brain mapping. P Natl Acad

Sci USA  103(10):3863â€“3868  2006.

[21] W. Lam and F. Bacchus. Learning Bayesian belief networks: An approach based on the mdl principle.

Comput Intell  10(4):269â€“293  1994.

[22] S. Lee  V. Ganapahthi  and D. Koller. Efï¬cient structure learning of markov networks using ğ‘™1-

regularization. In NIPS  2006.

[23] K. Li  L. Guo  J. Nie  G. Li  and T. Liu. Review of methods for functional brain connectivity detection

using fmri. Comput Med Imag Grap  33:131â€“139  2009.

[24] D. Neill  A. Moore  F. Pereira  and T. Mitchell. Detecting signiï¬cant multidimensional spatial clusters.

In NIPS  2004.

[25] K. Oâ€™Craven and N. Kanwisher. Mental imagery of faces and places activates corresponding stimulus-

speciï¬c brain regions. J Cognitive Neurosci  12:1013â€“1023  2000.

[26] S. D. Pietra  V. D. Pietra  and J. Lafferty.

19(4):380â€“393  1997.

Inducing features of random ï¬elds.

IEEE T Pattern Anal 

[27] M. C. Potter. Short-term conceptual memory for pictures. J Exp Psychol - Hum L  2(5):509â€“522  1976.
[28] A. Quattoni  S. Wang  L.-P. Morency  M. Collins  and T. Darrell. Hidden conditional random ï¬elds. IEEE

T Pattern Anal  29(10):1848â€“1852  2007.

[29] B. Taskar  P. Abbeel  and D. Koller. Discriminative probabilistic models for relational data. In UAI  2002.
[30] B. Tversky and K. Hemenway. Categories of scenes. Cognitive Psychol  15:121â€“149  1983.
[31] D. B. Walther  E. Caddigan  L. Fei-Fei

  and D. M. Beck

âˆ—

âˆ—

. Natural scene categories revealed in dis-
indicates

âˆ—

tributed patterns of activity in the human brain. J Neurosci  29(34):10573â€“10581  2009. (
equal contribution).

[32] M. L. Wong  W. Lam  and K. S. Leung. Using evoluntionary programming and minimum description

length principle for data mining of bayesian networks. IEEE T Pattern Anal  21(2):174â€“178  1999.

9

,Minhyung Cho
Chandra Dhir
Jaehyung Lee
Pulkit Tandon
Yash Malviya
Bipin Rajendran