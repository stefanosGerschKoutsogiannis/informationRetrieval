2016,Dueling Bandits: Beyond Condorcet Winners to General Tournament Solutions,Recent work on deriving $O(\log T)$ anytime regret bounds for stochastic dueling bandit problems has considered mostly Condorcet winners  which do not always exist  and more recently  winners defined by the Copeland set  which do always exist. In this work  we consider a broad notion of winners defined by tournament solutions in social choice theory  which include the Copeland set as a special case but also include several other notions of winners such as the top cycle  uncovered set  and Banks set  and which  like the Copeland set  always exist. We develop a family of UCB-style dueling bandit algorithms for such general tournament solutions  and show $O(\log T)$ anytime regret bounds for them. Experiments confirm the ability of our algorithms to achieve low regret relative to the target winning set of interest.,DuelingBandits:BeyondCondorcetWinnerstoGeneralTournamentSolutionsSiddarthaRamamohanIndianInstituteofScienceBangalore560012 Indiasiddartha.yr@csa.iisc.ernet.inArunRajkumarXeroxResearchBangalore560103 Indiaarun_r@csa.iisc.ernet.inShivaniAgarwalUniversityofPennsylvaniaPhiladelphia PA19104 USAashivani@seas.upenn.eduAbstractRecentworkonderivingO(logT)anytimeregretboundsforstochasticduelingbanditproblemshasconsideredmostlyCondorcetwinners whichdonotalwaysexist andmorerecently winnersdeﬁnedbytheCopelandset whichdoalwaysexist.Inthiswork weconsiderabroadnotionofwinnersdeﬁnedbytournamentsolutionsinsocialchoicetheory whichincludetheCopelandsetasaspecialcasebutalsoincludeseveralothernotionsofwinnerssuchasthetopcycle uncoveredset andBanksset andwhich liketheCopelandset alwaysexist.WedevelopafamilyofUCB-styleduelingbanditalgorithmsforsuchgeneraltournamentsolutions andshowO(logT)anytimeregretboundsforthem.Experimentsconﬁrmtheabilityofouralgorithmstoachievelowregretrelativetothetargetwinningsetofinterest.1IntroductionTherehasbeensigniﬁcantinterestandprogressinrecentyearsindevelopingalgorithmsforduelingbanditproblems[1–11].HerethereareKarms;oneachtrialt oneselectsapairofarms(it jt)forcomparison andreceivesabinaryfeedbacksignalyt∈{0 1}indicatingwhicharmwaspreferred.Mostworkonduelingbanditsisinthestochasticsettingandassumesastochasticmodel–apreferencematrixPofpairwisecomparisonprobabilitiesPij–fromwhichthefeedbacksignalsytaredrawn;aswithstandardstochasticmulti-armedbandits thetargethereisusuallytodesignalgorithmswithO(lnT)regretbounds andwherepossible O(lnT)anytime(or‘horizon-free’)regretbounds forwhichthealgorithmdoesnotneedtoknowthehorizonornumberoftrialsTinadvance.EarlyworkonduelingbanditsoftenassumedstrongconditionsonthepreferencematrixP suchasexistenceofatotalorder underwhichthereisanaturalnotionofa‘maximal’elementwithrespecttowhichregretismeasured.RecentworkhassoughttodesignalgorithmsunderweakerconditionsonP;mostwork however hasassumedtheexistenceofaCondorcetwinner whichisanarmithatbeatseveryotherarmj(Pij>12∀j6=i) andwhichreducestothemaximalelementwhenatotalorderexists.Unfortunately theCondorcetwinnerdoesnotalwaysexist andthishasmotivatedasearchforothernaturalnotionsofwinners suchasBordawinnersandtheCopelandset(seeFigure1).1Amongthese theonlyworkthatoffersanytimeO(lnT)regretboundsistherecentworkofZoghietal.[11]onCopelandsets.Inthiswork weconsiderdeﬁningwinnersinduelingbanditsviathenaturalnotionoftournamentsolutionsusedinsocialchoicetheory ofwhichtheCopelandsetisaspecialcase.Wedevelopgeneralupperconﬁdencebound(UCB)styleduelingbanditalgorithmsforanumberoftournamentsolutionsincludingthetopcycle uncoveredset andBanksset andproveO(lnT)anytimeregretboundsforthem wheretheregretismeasuredrelativetothetournamentsolutionofinterest.Ourprooftechniqueismodularandcanbeusedtodevelopalgorithmswithsimilarboundsforanytournamentsolutionforwhicha‘selectionprocedure’satisfyingcertain‘safetyconditions’canbedesigned.Experimentsconﬁrmtheabilityofouralgorithmstoachievelowregretrelativetothetargetwinningsetofinterest.1Recently Dudiketal.[10]alsostudiedvonNeumannwinners althoughtheydidsoinadifferent(contextual)setting leadingtoO(T1/2)andO(T2/3)regretbounds.30thConferenceonNeuralInformationProcessingSystems(NIPS2016) Barcelona Spain.AlgorithmConditiononPTargetWinnerAnytime?MultiSBM[5]U-LinCondorcetwinnerXIF[1]TO+SST+STICondorcetwinner×BTMB[2]TO+RST+STICondorcetwinner×RUCB[6]CWCondorcetwinnerXMergeRUCB[7]CWCondorcetwinnerXRMED[9]CWCondorcetwinnerXSECS[8]UBWBordawinner×PBR-SE[4]DBSBordawinner×PBR-CO[4]AnyPwithouttiesCopelandset×SAVAGE-BO[3]AnyPwithouttiesBordawinner×SAVAGE-CO[3]AnyPwithouttiesCopelandset×CCB SCB[11]AnyPwithouttiesCopelandsetXUCB-TCAnyPwithouttiesTopcycleXUCB-UCAnyPwithouttiesUncoveredsetXUCB-BAAnyPwithouttiesBankssetXFigure1:SummaryofalgorithmsforstochasticduelingbanditproblemsthathaveO(lnT)regretbounds togetherwithcorrespondingconditionsontheunderlyingpreferencematrixP targetwinnersusedindeﬁningregret andwhethertheregretboundsare"anytime".TheﬁgureontheleftshowsrelationsbetweensomeofthecommonlystudiedconditionsonP(seeTable1fordeﬁnitions).Thealgorithmsinthelowerpartofthetable(showninred)areproposedinthispaper.2DuelingBandits TournamentSolutions andRegretMeasuresDuelingBandits.Wedenoteby[K]={1 ... K}thesetofKarms.Oneachtrialt thelearnerselectsapairofarms(it jt)∈[K]×[K](withitpossiblyequaltojt) andreceivesfeedbackintheformofacomparisonoutcomeyt∈{0 1} withyt=1indicatingitwaspreferredoverjtandyt=0indicatingthereverse.Thegoalofthelearneristoselectasoftenaspossiblefromasetof‘good’or‘winning’arms whichweformalizebelowasatournamentsolution.ThepairwisefeedbackoneachtrialisassumedtobegeneratedstochasticallyaccordingtoaﬁxedbutunknownpairwisepreferencemodelrepresentedbyapreferencematrixP∈[0 1]K×KwithPij+Pji=1∀i j:wheneverarmsiandjarecompared iispreferredtojwithprobabilityPij andjtoiwithprobabilityPji=1−Pij.Thusforeachtrialt wehaveyt∼Bernoulli(Pitjt).Weassumethroughoutthispaperthatthereareareno“ties”betweendistinctarms i.e.thatPij6=12∀i6=j.2WedenotebyPKthesetofallsuchpreferencematricesoverKarms:PK=(cid:8)P∈[0 1]K×K:Pij+Pji=1∀i j;Pij6=12∀i6=j(cid:9).Foranypairofarms(i j) wewilldeﬁnethemarginof(i j)w.r.t.Pas∆Pij=|Pij−12|.PreviousworkonduelingbanditshasconsideredavarietyofconditionsonP;seeTable1andFigure1.OurinteresthereisindesigningalgorithmsthathaveregretguaranteesunderminimalrestrictionsonP.Tothisend wewillconsidergeneralnotionsofwinnersthatarederivedfromanaturaltournamentassociatedwithP andthatarealwaysguaranteedtoexist.Wewillsayanarmibeatsanarmjw.r.t.PifPij>12;wewillexpressthisasabinaryrelation(cid:31)Pon[K]:i(cid:31)Pj⇐⇒Pij>12.ThetournamentassociatedwithPisthensimplyTP=([K] EP) whereEP={(i j):i(cid:31)Pj}.Twofrequentlystudiednotionsofwinnersinpreviousworkonduelingbandits bothofwhicharederivedfromthetournamentTP(andwhicharethetargetsofpreviousanytimeregretbounds) aretheCondorcetwinnerwhenitexists andtheCopelandsetingeneral:Deﬁnition1(Condorcetwinner).LetP∈PK.Ifthereexistsanarmi∗∈[K]suchthati∗(cid:31)Pj∀j6=i∗ theni∗issaidtobeaCondorcetwinnerw.r.t.P.Deﬁnition2(Copelandset).LetP∈PK.TheCopelandsetw.r.t.P denotedCO(P) isdeﬁnedasthesetofallarmsin[K]thatbeatthemaximalnumberofarmsw.r.t.P:CO(P)=argmaxi∈[K]Pj6=i1(cid:0)i(cid:31)Pj(cid:1).HereweareinterestedinmoregeneralnotionsofwinningsetsderivedfromthetournamentTP.2Theassumptionofnotieswasalsomadeinderivingregretboundsw.r.t.totheCopelandsetin[3 4 11] andexistsimplicitlyin[1 2]aswell.2Table1:CommonlystudiedconditionsonthepreferencematrixP.ConditiononPPropertysatisﬁedbyPUtility-basedwithlinearlink(U-Lin)∃u∈[0 1]K:Pij=1−(ui−uj)2∀i jTotalorder(TO)∃σ∈Sn:Pij>12⇐⇒σ(i)<σ(j)Strongstochastictransitivity(SST)Pij>12 Pjk>12=⇒Pik≥max(Pij Pjk)Relaxedstochastictransitivity(RST)∃γ≥1:Pij>12 Pjk>12=⇒Pik−12≥1γmax(Pij−12 Pjk−12)Stochastictriangleinequality(STI)Pij>12 Pjk>12=⇒Pik≤Pij+Pjk−12Condorcetwinner(CW)∃i:Pij>12∀j6=iUniqueBordawinner(UBW)∃i:Pk6=iPik>Pk6=jPjk∀j6=iDistinctBordascores(DBS)Pk6=iPik6=Pk6=jPjk∀i6=jTC UC/BA 4 5 3 CO 2 1 P_5 TC UC BA CO 5 6 7 4 1 2 3 8 9 10 11 12 13 Hudry TC Tennis UC/BA 4 5 3 CO 7 1 6 2 8 Figure2:Examplesofvarioustournamentstogetherwiththeircorrespondingtournamentsolutions.Edgesthatarenotexplicitlyshownaredirectedfromlefttoright;edgesthatareincidentonsubsetsofnodes(roundedrectangles)applytoallnodeswithin.Left:Atournamenton5nodeswithgraduallydiscriminatingtournamentsolutions.Middle:TheHudrytournamenton13nodeswithdisjointCopelandandBankssets.Right:Atournamenton8nodesbasedonATPtennismatchrecords.TournamentSolutions.TournamentsolutionshavelongbeenusedinsocialchoiceandvotingtheorytodeﬁnewinnersingeneraltournamentswhennoCondorcetwinnerexists[12 13].Speciﬁcally atournamentsolutionisanymappingthatmapseachtournamentonKnodestoasubsetof‘winning’nodesin[K];forourpurposes wewilldeﬁneatournamentsolutiontobeanymappingS:PK→2[K]thatmapseachpreferencematrixP(viatheinducedtournamentTP)toasubsetofwinningarmsS(P)⊆[K].3TheCopelandsetisonesuchtournamentsolution.Weconsiderthreeadditionaltournamentsolutionsinthispaper:thetopcycle theuncoveredset andtheBanksset allofwhichofferothernaturalgeneralizationsoftheCondorcetwinner.Thesetournamentsolutionsaremotivatedbydifferentconsiderations(rangingfromdominancetocoveringtodecompositionintoacyclicsubtournaments)andhavegradeddiscriminativepower andcanthereforebeusedtomatchtheneedsofdifferentapplications;see[12]foracomprehensivesurvey.Deﬁnition3(Topcycle).LetP∈PK.Thetopcyclew.r.t.P denotedTC(P) isdeﬁnedasthesmallestsetW⊆[K]forwhichi(cid:31)Pj∀i∈W j/∈W.Deﬁnition4(Uncoveredset).LetP∈PK.Anarmiissaidtocoveranarmjw.r.t.Pifi(cid:31)Pjand∀k:j(cid:31)Pk=⇒i(cid:31)Pk.Theuncoveredsetw.r.t.P denotedUC(P) isdeﬁnedasthesetofallarmsthatarenotcoveredbyanyotherarmw.r.t.P:UC(P)=(cid:8)i∈[K]:6∃j∈[K]s.t.jcoversiw.r.t.P(cid:9).Deﬁnition5(Banksset).LetP∈PK.AsubtournamentT=(V E)ofTP whereV⊆[K]andE=EP|V×V issaidtobemaximalacyclicif(i)Tisacyclic and(ii)noothersubtournamentcontainingTisacyclic.DenotebyMAST(P)thesetofallmaximalacyclicsubtournamentsofTP andforeachT∈MAST(P) denotebym∗(T)themaximalelementofT.ThentheBankssetw.r.t.P denotedBA(P) isdeﬁnedasthesetofmaximalelementsofallmaximalacyclicsubtournamentsofTP:BA(P)=(cid:8)m∗(T):T∈MAST(P)(cid:9).ItisknownthatBA(P)⊆UC(P)⊆TC(P)andCO(P)⊆UC(P)⊆TC(P).Ingeneral BA(P)andCO(P)mayintersect althoughtheycanalsobedisjoint.WhenPcontainsaCondorcetwinneri∗ allfourtournamentsolutionsreducetojustthesingletonset{i∗}.SeeFigure2forexamples.3Strictlyspeaking themappingSmustbeinvariantunderpermutationsofthenodelabels.3RegretMeasures.WhenPadmitsaCondorcetwinneri∗ theindividualregretofanarmiisusuallydeﬁnedasrCWP(i)=∆Pi∗ i andthecumulativeregretoverTtrialsofanalgorithmAthatselectsarms(it jt)ontrialtisthengenerallydeﬁnedasRCWT(A)=PTt=1rCWP(it jt) wherethepairwiseregretrCWP(i j)iseithertheaverageregret12(cid:0)rCWP(i)+rCWP(j)(cid:1) thestrongregretmax(cid:0)rCWP(i) rCWP(j)(cid:1) ortheweakregretmin(cid:0)rCWP(i) rCWP(j)(cid:1)[1 2 6 7 9].4WhenthetargetwinnerisatournamentsolutionS wecansimilarlydeﬁneasuitablenotionofindividualregretofanarmiw.r.t.S andthenusethistodeﬁnepairwiseregretsasabove.Inparticular forthethreetournamentsolutionsdiscussedabove wewilldeﬁnethefollowingnaturalnotionsofindividualregret:rTCP(i)=(maxi∗∈TC(P)∆Pi∗ iifi/∈TC(P)0ifi∈TC(P);rUCP(i)=(maxi∗∈UC(P):i∗coversi∆Pi∗ iifi/∈UC(P)0ifi∈UC(P);rBAP(i)=(maxT∈MAST(P):Tcontainsi∆Pm∗(T) iifi/∈BA(P)0ifi∈BA(P).InthespecialcasewhenPadmitsaCondorcetwinneri∗ thethreeindividualregretsaboveallreducetotheCondorcetindividualregret rCWP(i)=∆Pi∗ i.Ineachcaseabove thecumulativeregretofanalgorithmAoverTtrialswillthenbegivenbyRST(A)=PTt=1rSP(it jt) wherethepairwiseregretrSP(i j)canbetheaverageregret12(cid:0)rSP(i)+rSP(j)(cid:1) thestrongregretmax(cid:0)rSP(i) rSP(j)(cid:1) ortheweakregretmin(cid:0)rSP(i) rSP(j)(cid:1).Ourregretboundswillholdforeachoftheseformsofpairwiseregret.Infact ourregretboundsholdforanymeasureofpairwiseregretrSP(i j)thatsatisﬁesthefollowingthreeconditions:(i)rSP(· ·)isnormalized:rSP(i j)∈[0 1]∀i j;(ii)rSP(· ·)issymmetric:rSP(i j)=rSP(j i)∀i j;and(iii)rSP(· ·)isproperw.r.t.S:i j∈S(P)=⇒rSP(i j)=0.Itiseasytoverifythatforthethreetournamentsolutionsabove theaverage strongandweakpairwiseregretsaboveallsatisfytheseconditions.5 63UCB-TS:GenericDuelingBanditAlgorithmforTournamentSolutionsAlgorithm.InAlgorithm1weoutlineagenericduelingbanditalgorithm whichwecallUCB-TS foridentifyingwinnersfromageneraltournamentsolution.ThealgorithmcanbeinstantiatedtospeciﬁctournamentsolutionsbydesigningsuitableselectionproceduresSELECTPROC-TS(moredetailsbelow).ThealgorithmmaintainsamatrixUt∈RK×K+ofupperconﬁdencebounds(UCBs)UtijontheunknownpairwisepreferenceprobabilitiesPij.TheUCBsareconstructedbyaddingaconﬁdencetermtothecurrentempiricalestimateofPij;theexplorationparameterα>12controlstheexplorationrateofthealgorithmviathesizeoftheconﬁdencetermsused.Oneachtrialt thealgorithmselectsapairofarms(it jt)basedonthecurrentUCBmatrixUtusingtheselectionprocedureSELECTPROC-TS;onobservingthepreferencefeedbackyt thealgorithmthenupdatestheUCBsforallpairsofarms(i j)(theUCBsofallpairs(i j)growslowlywithtsothatpairsthathavenotbeenselectedforawhilehaveanincreasingchanceofbeingexplored).InordertoinstantiatetheUCB-TSalgorithmtoaparticulartournamentsolutionS thecriticalstepisindesigningtheselectionprocedureSELECTPROC-TSinamannerthatyieldsgoodregretboundsforasuitableregretmeasurew.r.t.S.BelowweidentifygeneralconditionsonSELECTPROC-TSthatallowforO(lnT)anytimeregretboundstobeobtained(wewilldesignproceduressatisfyingtheseconditionsforthethreetournamentsolutionsofinterestinSection4).4Thenotionofregretusedin[5]wasslightlydifferent.5Itisalsoeasytoverifythatdeﬁningtheindividualregretsastheminimumoraveragemarginrelativetoallrelevantarmsinthetournamentsolutionofinterest(insteadofthemaximummarginasdoneabove)alsopreservestheseproperties andthereforeourregretboundsholdfortheresultingvariantsofregretaswell.6Onecanalsoconsiderdeﬁningtheindividualregretssimplyintermsofmistakesrelativetothetargettournamentsolutionofinterest e.g.rTCP(i)=1(i/∈TC(P)) anddeﬁneaverage/strong/weakpairwiseregretsintermsofthese;ourboundsalsoapplyinthiscase.4Algorithm1UCB-TS1:Require:SelectionprocedureSELECTPROC-TS2:Parameter:Explorationparameterα>123:Initialize:∀(i j)∈[K]×[K]:N1ij=0//#times(i j)hasbeencompared;W1ij=0//#timesihaswonagainstj;U1ij=(cid:26)12ifi=j1otherwise//UCBforPij.4:Fort=1 2 ...do:5:•Select(it jt)←SELECTPROC-TS(Ut)6:•Receivepreferencefeedbackyt∈{0 1}7:•Updatecounts:∀(i j)∈[K]×[K]:Nt+1ij=(cid:26)Ntij+1if{i j}={it jt}Ntijotherwise;Wt+1ij=Wtij+ytif(i j)=(it jt)Wtij+(1−yt)if(i j)=(jt it)Wtijotherwise.8:•UpdateUCBs:∀(i j)∈[K]×[K]:Ut+1ij=12ifi=j1ifi6=jandNt+1ij=0Wt+1ijNt+1ij+qαlntNt+1ijotherwise.RegretAnalysis.WeshowherethatiftheselectionprocedureSELECTPROC-TSsatisﬁestwonaturalconditionsw.r.t.atournamentsolutionS namelythesafeidentical-armsconditionw.r.t.Sandthesafedistinct-armsconditionw.r.t.S thentheresultinginstantiationoftheUCB-TSalgorithmhasanO(lnT)regretboundforanyregretmeasurethatisnormalized symmetric andproperw.r.tS.TheﬁrstconditionensuresthatiftheUCBmatrixUgivenasinputtoSELECTPROC-TSinfactformsanelement-wiseupperboundonthetruepreferencematrixPandSELECTPROC-TSreturnstwoidenticalarms(i i) thenimustbeinthewinningsetS(P).ThesecondconditionensuresthatifUupperboundsPandSELECTPROC-TSreturnstwodistinctarms(i j) i6=j theneitherbothi jareinthewinningsetS(P) ortheUCBsUij Ujiarestillloose(and(i j)shouldbeexploredfurther).Deﬁnition6(Safeidentical-armscondition).LetS:PK→2[K]beatournamentsolution.WewillsayaselectionprocedureSELECTPROC-TS:RK×K+→[K]×[K]satisﬁesthesafeidentical-armsconditionw.r.t.SifforallP∈PK U∈RK×K+suchthatPij≤Uij∀i j wehaveSELECTPROC-TS(U)=(i i)=⇒i∈S(P).Deﬁnition7(Safedistinct-armscondition).LetS:PK→2[K]beatournamentsolution.WewillsayaselectionprocedureSELECTPROC-TS:RK×K+→[K]×[K]satisﬁesthesafedistinct-armsconditionw.r.t.SifforallP∈PK U∈RK×K+suchthatPij≤Uij∀i j wehaveSELECTPROC-TS(U)=(i j) i6=j=⇒(cid:8)(i j)∈S(P)×S(P)(cid:9)or(cid:8)Uij+Uji≥1+∆Pij(cid:9).Inwhatfollows forK∈Z+ α>12 andδ∈(0 1] wedeﬁneC(K α δ)=(cid:16)(4α−1)K2(2α−1)δ(cid:17)1/(2α−1).Thisquantity whichalsoappearsintheanalysisofRUCB[6] actsasaninitialtimeperiodbeyondwhichalltheUCBsUijupperboundPijw.h.p.Wehavethefollowingresult(proofinAppendixA):Theorem8(RegretboundforUCB-TSalgorithm).LetS:PK→2[K]beatournamentsolution andsupposetheselectionprocedureSELECTPROC-TSusedintheUCB-TSalgorithmsatisﬁesboththesafeidentical-armsconditionw.r.t.Sandthesafedistinct-armsconditionw.r.t.S.LetP∈PK andletrSP(i j)beanynormalized symmetric properregretmeasurew.r.t.S.Letα>12andδ∈(0 1].Thenwithprobabilityatleast1−δ(overthefeedbackytdrawnrandomlyfromPandanyinternalrandomnessinSELECTPROC-TS) thecumulativeregretoftheUCB-TSalgorithmwithexplorationparameterαisupperboundedasRST(cid:0)UCB-TS(α)(cid:1)≤C(K α δ)+4α(lnT)(cid:18)Xi<j:(i j)/∈S(P)×S(P)rSP(i j)(∆Pij)2(cid:19).5Figure3:InferencesaboutthedirectionofpreferencebetweenarmsiandjunderthetruepreferencematrixPbasedontheUCBsUij Uji assumingthatPij PjiareupperboundedbyUij Uji.4DuelingBanditAlgorithmsforTopCycle UncoveredSet andBanksSetBelowwegiveselectionproceduressatisfyingboththesafeidentical-armsconditionandthesafedistinct-armsconditionabovew.r.t.thetopcycle uncoveredset andBanksset whichimmediatelyyieldduelingbanditalgorithmswithO(lnT)regretboundsw.r.t.thesetournamentsolutions.AninstantiationofourframeworktotheCopelandsetisalsodiscussedinAppendixE.Theselectionprocedureforeachtournamentsolutioniscloselyrelatedtothecorrespondingwinnerdeterminationalgorithmforthattournamentsolution;however whileastandardwinnerdeterminationalgorithmwouldhaveaccesstotheactualtournamentTP theselectionprocedureswedesigncanonlyguess(withhighconﬁdence)thepreferencedirectionsbetweensomepairsofarmsbasedontheUCBmatrixU.Inparticular iftheentriesofUactuallyupperboundthoseofP thenforanypairofarmsiandj oneofthefollowingmustbetrue(seealsoFigure3):•Uij<12 inwhichcasePij≤Uij<12andthereforej(cid:31)Pi;•Uji<12 inwhichcasePji≤Uji<12andthereforei(cid:31)Pj;•Uij≥12andUji≥12 inwhichcasethedirectionofpreferencebetweeniandjinTPisunresolved.Theselectionprocedureswedesignmanagetheexploration-exploitationtradeoffbyadoptinganoptimismfollowedbypessimismapproach similartothatusedinthedesignoftheRUCBandCCBalgorithms[6 11].Speciﬁcally ourselectionproceduresﬁrstoptimisticallyidentifyapotentialwinningarmabasedontheUCBsU(byoptimisticallysettingdirectionsofanyunresolvededgesinTPinfavorofthearmbeingconsidered;seeFigure3).Onceaputativewinningarmaisidentiﬁed theselectionproceduresthenpessimisticallyﬁndanarmbthathasthegreatestchanceofinvalidatingaasawinningarm andselectthepair(a b)forcomparison.4.1UCB-TC:DuelingBanditAlgorithmforTopCycleTheselectionprocedureSELECTPROC-TC(Algorithm2) wheninstantiatedintheUCB-TStemplate yieldstheUCB-TCduelingbanditalgorithm.Intuitively SELECTPROC-TCconstructsanoptimisticestimateAofthetopcyclebasedontheUCBsU(line2) andselectsapotentialwinningarmafromA(line3);ifthereisnounresolvedarmagainsta(line5) thenitreturns(a a)forcomparison elseitselectsthebest-performingunresolvedopponentb(line8)andreturns(a b)forcomparison.Wehavethefollowingresult(seeAppendixBforaproof):Theorem9(SELECTPROC-TCsatisﬁessafetyconditionsw.r.t.TC).SELECTPROC-TCsatisﬁesboththesafeidentical-armsconditionandthesafedistinct-armsconditionw.r.t.TC.ByvirtueofTheorem8 thisimmediatelyyieldsthefollowingregretboundforUCB-TC:Corollary10(RegretboundforUCB-TCalgorithm).LetP∈PK.Letα>12andδ∈(0 1].Thenwithprobabilityatleast1−δ thecumulativeregretofUCB-TCw.r.t.thetopcyclesatisﬁesRTCT(cid:0)UCB-TC(α)(cid:1)≤C(K α δ)+4α(lnT)(cid:18)Xi<j:(i j)/∈TC(P)×TC(P)rTCP(i j)(∆Pij)2(cid:19).4.2UCB-UC:DuelingBanditAlgorithmforUncoveredSetTheselectionprocedureSELECTPROC-UC(Algorithm3) wheninstantiatedintheUCB-TStemplate yieldstheUCB-UCduelingbanditalgorithm.SELECTPROC-UCreliesonthepropertythatanuncoveredarmbeatseveryotherarmeitherdirectlyorviaanintermediary[12].SELECTPROC-UCoptimisticallyidentiﬁessuchapotentiallyuncoveredarmabasedontheUCBsU(line5);ifitcanberesolvedthataisindeeduncovered(line7) thenitreturns(a a) elseitselectsthebest-performingunresolvedopponentbwhenavailable(line11) oranarbitraryopponentbotherwise(line13) andreturns(a b).Wehavethefollowingresult(seeAppendixCforaproof):6Algorithm2SELECTPROC-TC1:Input:UCBmatrixU∈RK×K+2:LetA⊆[K]beanyminimalsetsatisfyingUij≥12∀i∈A j/∈A3:Selectanya∈argmaxi∈Aminj6∈AUij4:B←{i6=a:Uai≥12∧Uia≥12}5:ifB=∅then6:Return(a a)7:else8:Selectanyb∈argmaxi∈BUia9:Return(a b)10:endifAlgorithm3SELECTPROC-UC1:Input:UCBmatrixU∈RK×K+2:fori=1toKdo3:y(i)←Pj1(Uij≥12)+Pj k1(Uij≥12∧Ujk≥12)4:endfor5:Selectanya∈argmaxiy(i)6:B←{i6=a:Uai≥12∧Uia≥12}7:if(cid:0)∀i6=a:(Uia<12)∨(∃j:Uij<12∧Uja<12)(cid:1)then8:Return(a a)9:else10:ifB6=∅then11:Selectanyb∈argmaxi∈BUia12:else13:Selectanyb6=a14:endif15:Return(a b)16:endifAlgorithm4SELECTPROC-BA1:Input:UCBmatrixU∈RK×K+2:Selectanyj1∈[K]3:J←{j1}//InitializecandidateBankstrajectory4:s←1//InitializesizeofcandidateBankstrajectory5:traj_found=FALSE6:whileNOT(traj_found)do7:C←{i/∈J:Uij>12∀j∈J}8:ifC=∅then9:traj_found=TRUE10:break11:else12:js+1∈argmaxi∈C(minj∈JUij)13:J←J∪{js+1}14:s←s+115:endif16:endwhile17:if(cid:0)∀1≤q<r≤s:Ujq jr<12(cid:1)then18:a←js19:Return(a a)20:else21:Selectany(eq er)∈argmax(q r):1≤q<r≤sUjq jr22:(a b)←(jeq jer)23:Return(a b)24:endifTheorem11(SELECTPROC-UCsatisﬁessafetyconditionsw.r.t.UC).SELECTPROC-UCsatis-ﬁesboththesafeidentical-armsconditionandthesafedistinct-armsconditionw.r.t.UC.Again byvirtueofTheorem8 thisimmediatelyyieldsthefollowingregretboundforUCB-UC:Corollary12(RegretboundforUCB-UCalgorithm).LetP∈PK.Letα>12andδ∈(0 1].Thenwithprobabilityatleast1−δ thecumulativeregretofUCB-UCw.r.t.theuncoveredsetsatisﬁesRUCT(cid:0)UCB-UC(α)(cid:1)≤C(K α δ)+4α(lnT)(cid:18)Xi<j:(i j)/∈UC(P)×UC(P)rUCP(i j)(∆Pij)2(cid:19).4.3UCB-BA:DuelingBanditAlgorithmforBanksSetTheselectionprocedureSELECTPROC-BA(Algorithm4) wheninstantiatedintheUCB-TStemplate yieldstheUCB-BAduelingbanditalgorithm.Intuitively SELECTPROC-BAﬁrstconstructsanoptimisticcandidatemaximalacyclicsubtournament(setJ;alsocalledaBankstrajectory)basedontheUCBsU(lines2–16).Ifthissubtournamentiscompletelyresolved(line17) thenitsmaximalarmaispickedand(a a)isreturned;ifnot anunresolvedpair(a b)isreturnedthatismostlikelytofailtheacyclicity/transitivityproperty.Wehavethefollowingresult(seeAppendixDforaproof):Theorem13(SELECTPROC-BAsatisﬁessafetyconditionsw.r.t.BA).SELECTPROC-BAsatis-ﬁesboththesafeidentical-armsconditionandthesafedistinct-armsconditionw.r.t.BA.Again byvirtueofTheorem8 thisimmediatelyyieldsthefollowingregretboundforUCB-BA:Corollary14(RegretboundforUCB-BAalgorithm).LetP∈PK.Letα>12andδ∈(0 1].Thenwithprobabilityatleast1−δ thecumulativeregretofUCB-BAw.r.t.theBankssetsatisﬁesRBAT(cid:0)UCB-BA(α)(cid:1)≤C(K α δ)+4α(lnT)(cid:18)Xi<j:(i j)/∈BA(P)×BA(P)rBAP(i j)(∆Pij)2(cid:19).7Figure4:RegretperformanceofouralgorithmscomparedtoBTMB RUCB SAVAGE-CO andCCB.Resultsareaveragedover10independentruns;lightcoloredbandsrepresentonestandarderror.Left:TopcycleregretofUCB-TConPMSLR.Middle:UncoveredsetregretofUCB-UConPTennis.Right:BankssetregretofUCB-BAonPHudry.SeeAppendixF.2foradditionalresults.5ExperimentsHereweprovideanempiricalevaluationoftheperformanceoftheproposedduelingbanditalgorithms.Weusedthefollowingthreepreferencematricesinourexperiments oneofwhichissyntheticandtworeal-world andnoneofwhichposessesaCondorcetwinner:•PHudry∈P13:ThisisconstructedfromtheHudrytournamentshowninFigure2(b);asnotedearlier thisisthesmallesttournamentwhoseCopelandsetandBankssetaredisjoint[14].DetailsofthispreferencematrixcanbefoundinAppendixF.1.1.•PTennis∈P8:ThisisconstructedfromrealdatacollectedfromtheAssociationofTennisProfessionals’(ATP’s)websiteonoutcomesoftennismatchesplayedamong8well-knownprofessionaltennisplayers.ThetournamentassociatedwithPTennisisshowninFigure2(c);furtherdetailsofthispreferencematrixcanbefoundinAppendixF.1.2.•PMSLR∈P16:ThisisconstructedfromrealdatafromtheMicrosoftLearningtoRank(MSLR)Web10Kdataset.FurtherdetailscanbefoundinAppendixF.1.3.Wecomparedtheperformanceofouralgorithms UCB-TC UCB-BA andUCB-UC withfourpreviousduelingbanditalgorithms:BTMB[2] RUCB[6] SAVAGE-CO[3] andCCB[11].7Ineachcase weassessedthealgorithmsintermsofaveragepairwiseregretrelativetothetargettournamentsolutionofinterest(seeSection2) averagedover10independentruns.AsampleoftheresultsisshowninFigure4;ascanbeseen theproposedalgorithmsUCB-TC UCB-UC andUCB-BAgenerallyoutperformexistingbaselinesintermsofminimizingregretrelativetothetopcycle theuncoveredset andtheBanksset respectively.Additionalresults includingresultswiththeCopelandsetvariantofouralgorithm UCB-CO canbefoundinAppendixF.2.6ConclusionInthispaper wehaveproposedtheuseofgeneraltournamentsolutionsassetsof‘winning’armsinstochasticduelingbanditproblems withtheadvantagethatthesetournamentsolutionsalwaysexistandcanbeusedtodeﬁnewinnersaccordingtocriteriathataremostrelevanttoagivenduelingbanditsetting.WehavedevelopedaUCB-stylefamilyofalgorithmsforsuchgeneraltournamentsolutions andhaveshownO(lnT)anytimeregretboundsforthealgorithminstantiatedtothetopcycle uncoveredset andBanksset(aswellastheCopelandset;seeAppendixE).Whileourapproachhasanappealingmodularstructurebothalgorithmicallyandinourproofs anopenquestionconcernstheoptimalityofourregretboundsintheirdependenceonthenumberofarmsK.FortheCondorcetwinner theMergeRUCBalgorithm[7]hasananytimeregretboundoftheformO(KlnT);fortheCopelandset theSCBalgorithm[11]hasananytimeregretboundoftheformO(KlnKlnT).Intheworstcase ourregretboundsareoftheformO(K2lnT).Isitpossiblethatforthetopcycle uncoveredset andBanksset onecanalsoshowanΩ(K2lnT)lowerboundontheregret?Orcanourregretboundsoralgorithmsbeimproved?Weleaveadetailedinvestigationofthisissuetofuturework.Acknowledgments.Thankstotheanonymousreviewersforhelpfulcommentsandsuggestions.SRthanksGoogleforatravelgranttopresentthisworkattheconference.7ForalltheUCB-basedalgorithms(includingouralgorithms RUCB andCCB) wesettheexplorationparameterαto0.51;forSAVAGE-CO wesettheconﬁdenceparameterδto1/T;andforBTMB wesetδto1/Tandchoseγtosatisfytheγ-relaxedstochastictransitivitypropertyforeachpreferencematrix.8References[1]YisongYue JosefBroder RobertKleinberg andThorstenJoachims.TheK-armedduelingbanditsproblem.JournalofComputerandSystemSciences 78(5):1538–1556 2012.[2]YisongYueandThorstenJoachims.Beatthemeanbandit.InProceedingsofthe28thInternationalConferenceonMachineLearning 2011.[3]TanguyUrvoy FabriceClerot RaphaelFéraud andSamiNaamane.Genericexplorationandk-armedvotingbandits.InProceedingsofthe30thInternationalConferenceonMachineLearning 2013.[4]RóbertBusa-Fekete BalazsSzorenyi WeiweiCheng PaulWeng andEykeHüllermeier.Top-kselectionbasedonadaptivesamplingofnoisypreferences.InProceedingsofthe30thInternationalConferenceonMachineLearning 2013.[5]NirAilon ZoharKarnin andThorstenJoachims.Reducingduelingbanditstocardinalbandits.InProceedingsofthe31stInternationalConferenceonMachineLearning 2014.[6]MasrourZoghi ShimonWhiteson RemiMunos andMaartendeRijke.Relativeupperconﬁ-denceboundforthek-armedduelingbanditproblem.InProceedingsofthe31stInternationalConferenceonMachineLearning 2014.[7]MasrourZoghi ShimonWhiteson andMaartendeRijke.MergeRUCB:Amethodforlarge-scaleonlinerankerevaluation.InProceedingsofthe8thACMInternationalConferenceonWebSearchandDataMining 2015.[8]KevinJamieson SumeetKatariya AtulDeshpande andRobertNowak.Sparseduelingbandits.InProceedingsofthe18thInternationalConferenceonArtiﬁcialIntelligenceandStatistics 2015.[9]JunpeiKomiyama JunyaHonda HisashiKashima andHiroshiNakagawa.Regretlowerboundandoptimalalgorithminduelingbanditproblem.InProceedingsofthe28thConferenceonLearningTheory 2015.[10]MiroslavDudık KatjaHofmann RobertESchapire AleksandrsSlivkins andMasrourZoghi.Contextualduelingbandits.InProceedingsofthe28thConferenceonLearningTheory 2015.[11]MasrourZoghi ZoharS.Karnin ShimonWhiteson andMaartendeRijke.Copelandduelingbandits.InAdvancesinNeuralInformationProcessingSystems28 2015.[12]FelixBrandt MarkusBrill andPaulHarrenstein.Tournamentsolutions.InHandbookofComputationalSocialChoice.CambridgeUniversityPress 2016.[13]FelixBrandt AndreDau andHansGeorgSeedig.Boundsonthedisparityandseparationoftournamentsolutions.DiscreteAppliedMathematics 187:41–49 2015.[14]OlivierHudry.AsmallesttournamentforwhichtheBankssetandtheCopelandsetaredisjoint.SocialChoiceandWelfare 16(1):137–143 1999.[15]KennethAShepsleandBarryRWeingast.Uncoveredsetsandsophisticatedvotingoutcomeswithimplicationsforagendainstitutions.AmericanJournalofPoliticalScience pages49–74 1984.[16]KevinJamiesonandRobertNowak.Activerankingusingpairwisecomparisons.InAdvancesinNeuralInformationProcessingSystems 2011.9,Siddartha Ramamohan
Arun Rajkumar
Shivani Agarwal
Shivani Agarwal