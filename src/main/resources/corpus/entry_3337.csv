2017,Mapping distinct timescales of functional interactions among brain networks,Brain processes occur at various timescales  ranging from milliseconds (neurons) to minutes and hours (behavior). Characterizing functional coupling among brain regions at these diverse timescales is key to understanding how the brain produces behavior. Here  we apply instantaneous and lag-based measures of conditional linear dependence  based on Granger-Geweke causality (GC)  to infer network connections at distinct timescales from functional magnetic resonance imaging (fMRI) data. Due to the slow sampling rate of fMRI  it is widely held that GC produces spurious and unreliable estimates of functional connectivity when applied to fMRI data. We challenge this claim with simulations and a novel machine learning approach. First  we show  with simulated fMRI data  that instantaneous and lag-based GC identify distinct timescales and complementary patterns of functional connectivity. Next  we analyze fMRI scans from 500 subjects and show that a linear classifier trained on either instantaneous or lag-based GC connectivity reliably distinguishes task versus rest brain states  with ~80-85% cross-validation accuracy. Importantly  instantaneous and lag-based GC exploit markedly different spatial and temporal patterns of connectivity to achieve robust classification. Our approach enables identifying functionally connected networks that operate at distinct timescales in the brain.,Mapping distinct timescales of functional interactions

among brain networks

Mali Sundaresan1

s.malisundar@gmail.com

Arshed Nabeel2

arshed@iisc.ac.in

Devarajan Sridharan1 2∗
sridhar@iisc.ac.in

1Center for Neuroscience  Indian Institute of Science  Bangalore

2Department of Computer Science and Automation  Indian Institute of Science  Bangalore

Abstract

Brain processes occur at various timescales  ranging from milliseconds (neurons)
to minutes and hours (behavior). Characterizing functional coupling among brain
regions at these diverse timescales is key to understanding how the brain produces
behavior. Here  we apply instantaneous and lag-based measures of conditional
linear dependence  based on Granger-Geweke causality (GC)  to infer network
connections at distinct timescales from functional magnetic resonance imaging
(fMRI) data. Due to the slow sampling rate of fMRI  it is widely held that GC
produces spurious and unreliable estimates of functional connectivity when applied
to fMRI data. We challenge this claim with simulations and a novel machine
learning approach. First  we show  with simulated fMRI data  that instantaneous
and lag-based GC identify distinct timescales and complementary patterns of func-
tional connectivity. Next  we analyze fMRI scans from 500 subjects and show
that a linear classiﬁer trained on either instantaneous or lag-based GC connectivity
reliably distinguishes task versus rest brain states  with ∼80-85% cross-validation
accuracy. Importantly  instantaneous and lag-based GC exploit markedly differ-
ent spatial and temporal patterns of connectivity to achieve robust classiﬁcation.
Our approach enables identifying functionally connected networks that operate at
distinct timescales in the brain.

1

Introduction

Processes in the brain occur at various timescales. These range from the timescales of milliseconds for
extremely rapid processes (e.g. neuron spikes)  to timescales of tens to hundreds of milliseconds for
processes coordinated across local populations of neurons (e.g. synchronized neural oscillations)  to
timescales of seconds for processes that are coordinated across diverse brain networks (e.g. language)
and even up to minutes  hours or days for processes that involve large-scale neuroplastic changes
(e.g. learning a new skill). Coordinated activity among brain regions that mediate each of these
cognitive processes would manifest in the form of functional connections among these regions at
the corresponding timescales. Characterizing patterns of functional connectivity that occur at these
different timescales is  hence  essential for understanding how the brain produces behavior.
Measures of linear dependence and feedback  based on Granger-Geweke causality (GC) [10][11]) 
have been used to estimate instantaneous and lagged functional connectivity in recordings of brain
activity made with electroencephalography (EEG  [6])  and electrocorticography (ECoG  [3]). How-
ever  the application of GC measures to brain recordings made with functional magnetic resonance
imaging (fMRI) remains controversial [22][20][2]. Because the hemodynamic response is produced
and sampled at a timescale (seconds) several orders of magnitude slower than the underlying neural
processes (milliseconds)  previous studies have argued that GC measures  particularly lag-based GC 
produce spurious and unreliable estimates of functional connectivity from fMRI data [22][20].

∗Corresponding author

31st Conference on Neural Information Processing Systems (NIPS 2017)  Long Beach  CA  USA.

Three primary confounds have been reported with applying lag-based GC to fMRI data. First 
systematic hemodynamic lags: a slower hemodynamic response in one region  as compared to
another could produce a spurious directed GC connection from the second to the ﬁrst [22] [4].
Second  in simulations  measurement noise added to the signal during fMRI acquisition was shown to
produce signiﬁcant degradation in GC functional connectivity estimates [20]. Finally  downsampling
recordings to the typical fMRI sampling rate (seconds)  three orders of magnitude slower than the
timescale of neural spiking (milliseconds)  was shown to effectively eliminate all traces of functional
connectivity inferred by GC [20]. Hence  a previous  widely cited study argued that same-time
correlation based measures of functional connectivity  such as partial correlations  fare much better
than GC for estimating functional connectivity from fMRI data [22].
The controversy over the application of GC measures to fMRI data remains unresolved to date 
primarily because of the lack of access to “ground truth”. On the one hand  claims regarding
the efﬁcacy of GC estimates based on simulations  are only as valid as the underlying model of
hemodynamic responses. Because the precise mechanism by which neural responses generate
hemodynamic responses is an active area of research [7]  strong conclusions cannot be drawn based
on simulated fMRI data alone. On the other hand  establishing “ground truth” validity for connections
estimated by GC on fMRI data require concurrent  brain-wide invasive neurophysiological recordings
during fMRI scans  a prohibitive enterprise.
Here  we seek to resolve this controversy by introducing a novel application of machine learning that
works around these criticisms. We estimate instantaneous and lag-based GC connectivity  ﬁrst  with
simulated fMRI time series under different model network conﬁgurations and  next  from real fMRI
time series (from 500 human subjects) recorded under different task conditions. Based on the GC
connectivity matrices  we train a linear classiﬁer to discriminate model network conﬁgurations or
subject task conditions  and assess classiﬁer accuracy with cross validation. Our results show that
instantaneous and lag-based GC connectivity estimated from empirical fMRI data can distinguish
task conditions with over 80% cross-validation accuracies. To permit such accurate classiﬁcation  GC
estimates of functional connectivity must be robustly consistent within each model conﬁguration (or
task condition) and reliably different across conﬁgurations (or task conditions). In addition  drawing
inspiration from simulations  we show that GC estimated on real fMRI data downsampled to 3x-7x
the original sampling rate provides novel insights into functional brain networks that operate at
distinct timescales.

2 Simulations and Theory

2.1

Instantaneous and lag-based measures of conditional linear dependence

The linear relationship among two multivariate signals x and y conditioned on a third multivariate
signal z can be measured as the sum of linear feedback from x to y (Fx→y)  linear feedback
from y to x (Fy→x)  and instantaneous linear feedback (Fx◦y) [11][16]. To quantify these linear
relationships  we model the future of each time series in terms of their past values with a well-
established multivariate autoregressive (MVAR) model (detailed in Supplementary Material  Section
S1).
Brieﬂy  Fx→y is a measure of the improvement in the ability to predict the future values of y given
the past values of x  over and above what can be predicted from the past values of z and y  itself (and
vice versa for Fy→x). Fx◦y  on the other hand  measures the instantaneous inﬂuence between x and
y conditioned on z (see Supplementary Material  Section S1). We refer to Fx◦y  as instantaneous GC
(iGC)  and Fx→y Fy→x as lag-based GC or directed GC (dGC)  with the direction of the inﬂuence
(x to y or vice versa) being indicated by the arrow. The “full” measure of linear dependence and
feedback Fx y is given by :

Fx y = Fx→y + Fy→x + Fx◦y

(1)

Fx y measures the complete conditional linear dependence between two time series. If  at a given
instant  no aspect of one time series can be explained by a linear model containing all the values (past
and present) of the other  Fx y will evaluate to zero [16]. These measures are ﬁrmly grounded in
information theory and statistical inferential frameworks [9].

2

Figure 1: Network simulations. (A) Network conﬁguration H. (Left) Connectivity matrix. Red vs.
blue: Excitatory vs. inhibitory connections. Deeper hues: Higher connection strengths. Non-zero
value at (i  j) corresponds to a connection from node j to node i (column to row). Sub-network A-B-C
operates at a fast timescale (50 ms) whereas D-E-F operates at a slow timescale (2 s). (Right) Network
schematic showing the connectivity matrix as a graph. (B) Network conﬁguration J. Conventions are
the same as in A. (C) The eigenspectra of networks H (left) and J (right). (D) Simulated time series
in network conﬁguration J with fast (top panel) and slow (bottom panel) dynamics  corresponding to
nodes A-B and E-F  respectively. Within each panel  the top plot is the simulated neural time series 
and the bottom plot is the simulated fMRI time series.

2.2 Simulating functional interactions at different timescales

To test the ability of GC measures to reliably recover functional interactions at different timescales 
we simulated fMRI time series for model networks with two conﬁgurations of directed connectivity.
Simulated fMRI time series were generated using a two-stage model (2): the ﬁrst stage involved
a latent variable model that described neural dynamics  and the second stage that convolved these
dynamics with the hemodynamic response function (HRF) to obtain the simulated fMRI time series.

˙x = Ax + ε

y = H ∗ x

(2)

where A is the neural (“ground truth”) connectivity matrix  x is the neural time series  ˙x is dx/dt  H
is the canonical hemodynamic response function (HRF; simulated with spm_hrf in SPM8 software) 
∗ is the convolution operation  y is the simulated BOLD time series  and ε is i.i.d Gaussian noise.
Other than noise ε  other kinds of external input were not included in these simulations. Similar
models have been employed widely for simulating fMRI time series data previously [22][2][20].
First  we sought to demonstrate the complementary nature of connections estimated by iGC and dGC.
For this  we used network conﬁguration H  shown in Fig. 1A. Note that this corresponds to two
non-interacting sub-networks  each operating at distinctly different timescales (50 ms and 2000 ms
node decay times  respectively) as revealed by the eigenspectrum of the connectivity matrix (Fig. 1C).
For convenience  we term these two timescales as “fast” and “slow”. Moreover  each sub-network
operated with a distinct pattern of connectivity  either purely feedforward  or with feedback (E-I).
Dynamics were simulated with a 1 ms integration step (Euler scheme)  convolved with the HRF and
then downsampled to 0.5 Hz resolution (interval of 2 s) to match the sampling rate (repeat time  TR)
of typical fMRI recordings.
Second  we sought to demonstrate the ability of dGC to recover functional interactions at distinct
timescales. For this  we simulated a different network conﬁguration J  whose connectivity matrix

3

DEFABCDestinationSourceFEDCBAACEBDFAFEDCBADestinationSource2s50msConnection strength-200ms-16s-1Node time-constant-6s-16s-15s50msBCD600s600sAmplitude (a.u.)Fast interaction (50ms)Slow interaction (5s)Time (s)Network HNetwork J-0.020Network JImfastintermediateslowRe0.020.0020.002-0.020Network HImfastslowRe0.020.0020.002Figure 2: Connectivity estimated from simulated data. (A) iGC and dGC values estimated from
simulated fMRI time series  network H. (Leftmost) Ground truth connectivity used in simulations.
(Top) Estimated iGC connectivity matrix (left) and signiﬁcant connections (right  p<0.05) estimated
by a bootstrap procedure using 1000 phase scrambled surrogates[18]. (Bottom) Same as top panel  but
for dGC. (B) dGC estimates from simulated fMRI time series  network J  sampled at three different
sampling intervals: 50 ms (left)  500 ms (middle) and 5 s (right). In each case the estimated dGC
matrix and signiﬁcant connections are shown  with the same conventions as in panel (A).

is shown in Fig. 1B. This network comprised three non-interacting sub-networks operating at three
distinct timescales (50 ms  0.5 s  and 5 s node decay times; eigenspectrum in Fig. 1C). As before 
simulated dynamics were downsampled at various rates – 20 Hz  2 Hz  0.2 Hz – corresponding to
sampling intervals of 50 ms  0.5 s  and 5 s  respectively. The middle interval (0.5 s) is closest to the
repeat time (TR=0.7 s) of the experimental fMRI data used in our analyses; the ﬁrst and last intervals
were chosen to be one order of magnitude faster and slower  respectively.
Sufﬁciently long (3000 s) simulated fMRI timeseries were generated for each network conﬁguration
(H and J). Sample time series from a subset of these simulations before and after hemodynamic
convolution and downsampling are shown in Fig. 1D.

2.3

Instantaneous and lag-based GC identify complementary connectivity patterns

Our goal was to test if the ground truth neural connectivity matrix (A in equation 2) could be estimated
by applying iGC and dGC to the fMRI time series y. dGC was estimated from the time series with
the MVGC toolbox (GCCA mode) [1][19] and iGC was estimated from the MVAR residuals [16].
For simulations with network conﬁguration H  iGC and dGC identiﬁed connectivity patterns that
differed in two key respects (Fig. 2A). First  iGC identiﬁed feedforward interactions at both fast and
slow timescales whereas dGC was able to estimate only the slow interactions  which occurred at a
timescale comparable to the sampling rate of the measurement. Second  dGC was able to identify
the presence of the E-I feedback connection at the slow timescale  whereas iGC entirely failed to
estimate this connection. In the Supplementary Material (Section S2)  we show theoretically why
iGC can identify mutually excitatory or mutually inhibitory feedback connections  but fails to identify
the presence of reciprocal excitatory-inhibitory (E-I) feedback connections  particularly when the
connection strengths are balanced.
For simulations with network conﬁguration J  dGC identiﬁed distinct connections depending on the
sampling rate. At the highest sampling rate (20 Hz)  connections at the fastest timescales (50 ms)
were estimated most effectively  whereas at the slowest sampling rates (0.2 Hz)  only the slowest
timescale connections (5 s) were estimated; intermediate sampling rates (2 Hz) estimated connections
at intermediate timescales (0.5 s). Thus  dGC estimated robustly those connections whose process
timescale was closest to the sampling rate of the data.
The ﬁrst ﬁnding — that connections at fast timescales (50 ms) could not be estimated from data
sampled at much lower rates (0.2 Hz) — is expected  and in line with previous ﬁndings. However  the
converse ﬁnding — that the slowest timescale connections (5 s) could not be detected at the fastest
sampling rates (20 Hz) — was indeed surprising. To better understand these puzzling ﬁndings  we
performed simulations over a wide range of sampling rates for each of these connection timescales; the
results are shown in Supplementary Figure S1. dGC values (both with and without convolution with
the hemodynamic response function) systematically increased from baseline  peaked at a sampling
rate corresponding to the process timescale and decreased rapidly at higher sampling rates  matching

4

DEFABCACEBDFABSampling Interval500ms50msiGCdGCGround
TruthGround
Truth5s0.0600.020recent analytical ﬁndings[2]. Thus  dGC for connections at a particular timescale was highest when
the data were sampled at a rate that closely matched that timescale.
Two key conclusions emerged from these simulations. First  functional connections estimated by
dGC can be distinct from and complementary to connections identiﬁed by iGC  both spatially and
temporally. Second  connections that operate at distinct timescales can be detected by estimating
dGC on data sampled at distinct rates that match the timescales of the underlying processes.

3 Experimental Validation

We demonstrated the success of instantaneous and lag-based GC to accurately estimate functional
connectivity with simulated fMRI data. Nevertheless  application of GC measures to real fMRI data
is fraught with signiﬁcant caveats  associated with hemodynamic confounds and measurement noise 
as described above. We asked whether  despite these confounds  iGC and dGC would be able to
produce reliable estimates of connectivity in real fMRI data. Moreover  as with simulated data  would
iGC and dGC reveal complementary patterns of connectivity that varied reliably with different task
conditions?

3.1 Machine learning  cross-validation and recursive feature elimination

We analyzed minimally preprocessed brain scans of 500 subjects  drawn from the Human Connectome
Project (HCP) database [12]. We analyzed data from resting state and seven other task conditions (total
of 4000 scans; Supplementary Table S1). In the main text we present results for classifying the resting
state from the language task; the other classiﬁcations are reported in the Supplementary Material.
The language task involves subjects listening to short segments of stories and evaluating semantic
content in the stories. This task is expected to robustly engage a network of language processing
regions in the brain. The resting state scans served as a “task-free” baseline  for comparison.
Brain volumes were parcellated with a 14-network atlas [21] (see Supplementary Material Section
S3; Supplementary Table S2). Network time series were computed by averaging time series across all
voxels in a given network using Matlab and SPM8. These multivariate network time series were then
ﬁt with an MVAR model (Supplementary Material Section S1). Model order was determined with
the Akaike Information Criterion for each subject  was typically 1  and did not change with further
downsampling of the data (see next section). The MVAR model ﬁt was then used to estimate both an
instantaneous connectivity matrix using iGC (Fx◦y) and a lag-based connectivity matrix using dGC
(Fx→y).
The connection strengths in these matrices were used as feature vectors in a linear classiﬁer based on
support vector machines (SVMs) for high dimensional predictor data. We used Matlab’s ﬁtclinear
function  optimizing hyperparameters using a 5-fold approach: by estimating hyperparameters with
ﬁve sets of 100 subjects in turn  and measuring classiﬁcation accuracies with the remaining 400
subjects; the only exception was for the classiﬁcation analysis with averaging GC matrices (Fig. 3B)
for which classiﬁcation was run with default hyperparameters (regularization strength = 1/(cardinality
of training-set)  ridge penalty). The number of features for iGC-based classiﬁcation was 91 (upper
triangular portion of the symmetric 14×14 iGC matrix) and for dGC-based classiﬁcation was 182
(all entries of the 14×14 dGC matrix  barring self-connections on the main diagonal). Based on
these functional connectivity features  we asked if we could reliably predict the task condition (e.g.
language versus resting). Classiﬁcation performance was tested with leave-one-out and k-fold cross-
validation. We also assessed the signiﬁcance of the classiﬁcation accuracy with permutation testing
[14] (Supplementary Material  Section S4).
Finally  we wished to identify a key set of connections that permitted accurately classifying task
from resting states. To accomplish this  we applied a two-stage recursive feature elimination (RFE)
algorithm [5]  which identiﬁed a minimal set of features that provided maximal cross validation
accuracy (generalization performance). Details are provided in the Supplementary Material (Section
S5  Supplementary Figs. S2-S3).

5

Figure 3: Classiﬁcation based on GC connectivity estimates in real data.
(A) Leave-one-out
classiﬁcation accuracies for different GC measures for the 14-network parcellation (left) and the
90-node parcellation (right). Within each group  the ﬁrst two bars represent the classiﬁcation accuracy
with dGC and iGC respectively. The third bar is the classiﬁcation accurcay with fGC (see equation 1).
Chance: 50% (two-way classiﬁcation). Error-bars: Clopper-Pearson binomial conﬁdence intervals.
(B) Classiﬁcation accuracy when the classiﬁer is tested on average GC matrices  as a function of
number of subjects being averaged (see text for details).

3.2

Instantaneous and lag-based GC reliably distinguish task from rest

Both iGC and dGC connectivity were able to distinguish task from resting state signiﬁcantly above
chance (Fig. 3A). Average leave-one-out cross validation accuracy was 80.0% with iGC and 83.4%
with dGC (Fig. 3A  left). Both iGC and dGC classiﬁcation exhibited high precision and recall at
identifying language task (precision= 0.81  recall= 0.78 for iGC and precision= 0.85  recall= 0.81 for
dGC). k-fold (k=10) cross-validation accuracy was also similar for both the GC measures (79.4% for
iGC and 83.7% for dGC).
dGC and iGC are complementary measures of linear dependence  by their deﬁnition. We asked if
combining them would produce better classiﬁcation performance. We combined dGC and iGC in two
ways. First  we performed classiﬁcation after pooling features (connectivity matrices) across both
dGC and iGC (“iGC ∪ dGC”). Second  we estimated the full GC measure (Fx y)  which is a direct
sum of dGC and iGC estimates (see equation 1). Both of these approaches yielded marginally higher
classiﬁcation accuracies – 88.2% for iGC ∪ dGC and 84.6% for fGC – than dGC or iGC alone.
Next  we asked if classiﬁcation would be more accurate if we averaged the GC measures across a
few subjects  to remove uncorrelated noise (e.g. measurement noise) in connectivity estimates. For
this  the data were partitioned into two groups of 250 subjects: a training (T) group and a test (S)
group. The classiﬁer was trained on group T and the classiﬁer prediction was tested by averaging GC
matrices across several folds of S  each fold containing a few (m=2 4 5 10 or 25) subjects. Prediction
accuracy for both dGC and iGC reached ∼90% with averaging as few as two subjects’ GC matrices 
and reached ∼100%  with averaging 10 subjects’ matrices (Fig. 3B).
We also tested if these classiﬁcation accuracies were brain atlas or cognitive task speciﬁc. First  we
tested an alternative atlas with 90 functional nodes based on a ﬁner regional parcellation of the 14
functional networks [21]. Classiﬁcation accuracies for iGC and fGC improved (87.9% and 90.8% 
respectively)  and for dGC remained comparable (81.4%)  to the 14 network case (Fig. 3A  right).
Second  we performed the same GC-based classiﬁcation analysis for six other tasks drawn from the
HCP database (Supplementary Table S1) . We discovered that all of the remaining six tasks could be
classiﬁed from the resting state with accuracy comparable to the language versus resting classiﬁcation
(Supplementary Fig. S4).
Finally  we asked how iGC and dGC classiﬁcation accuracies would compare to those of other
functional connectivity estimators. For example  partial correlations (PC) have been proposed
as a robust measure of functional connectivity in previous studies [22]. Classiﬁcation accuracies
for PC varied between 81-96% across tasks (Supplementary Fig. S5B). PC’s better performance
is expected: estimators based on same-time covariance are less susceptible to noise than those
based on lagged covariance  a result we derive analytically in the Supplementary Material (Section
S6). Also  when classifying language task versus rest  PC and iGC relied on largely overlapping
connections (∼60% overlap) whereas PC and dGC relied on largely non-overlapping connections
(∼25% overlap; Supplementary Fig. S5C). These results highlight the complementary nature of PC
and dGC connectivity. Moreover  we demonstrate  both with simulations and with real-data  that

6

Accuracy60708090100No. of Subjects01020304050Classiﬁcation using dGCClassiﬁcation using iGCABAccuracy506070809010014-NetworkdGCiGCfGC90-NodeParcellation SchemeFigure 4: Maximally discriminative connections identiﬁed with RFE (A) (Top) iGC connections
that were maximally discriminative between the language task and resting state  identiﬁed using
recursive feature elimination (RFE). Darker gray shades denote more discriminative connections
(higher beta weights) (Bottom) RFE curves  with classiﬁcation accuracy plotted as a function of the
number of remaining features. The dots mark the elbow-points of the RFE curves  corresponding
to the optimal number of discriminative connections. (B) Same as in (A)  except that RFE was
performed on dGC connectivity matrices with data sampled at 1x  3x  5x  and 7x of the original
sampling interval (TR=0.72 s). Non-zero value at (i  j) corresponds to a connection from node j to
node i (column to row).

classiﬁcation accuracy with GC typically increased with more scan timepoints  consistent with GC
being an information theoretic measure (Supplementary Fig. S6).
These superior classiﬁcation accuracies show that  despite conventional caveats for estimating GC
with fMRI data  both iGC and dGC yield functional connectivity estimates that are reliable across
subjects. Moreover  dGC’s lag-based functional connectivity provides a robust feature space for
classifying brain states into task or rest. In addition  we found that dGC connectivity can be used to
predict task versus rest brain states with near-perfect (>95-97%) accuracy  by averaging connectivity
estimates across as few as 10 subjects  further conﬁrming the robustness of these estimates.

3.3 Characterizing brain functional networks at distinct timescales

Recent studies have shown that brain regions  across a range of species  operate at diverse timescales.
For example  a recent calcium imaging study demonstrated the occurrence of fast (∼100 ms) and
slow (∼1 s) functional interactions in mouse cortex [17]. In non-human primates  cortical brain
regions operate at a hierarchy of intrinsic timescales  with the sensory cortex operating at faster
timescales compared to prefrontal cortex [13]. In the resting human brain  cortical regions organize
into a hierarchy of functionally-coupled networks characterized by distinct timescales [24]. It is
likely that these characteristic timescales of brain networks are also modulated by task demands. We
asked if the framework presented in our study could characterize brain networks operating at distinct
timescales across different tasks (and rest) from fMRI data.
We had already observed  in simulations  that instantaneous and lag-based GC measures identiﬁed
functional connections that operate at different timescales (Fig. 2A). We asked if these measures
could identify connections at fast versus slow timescales (compared to TR=0.72s) that were speciﬁc
to task verus rest  from fMRI recordings. To identify these task-speciﬁc connections  we performed
recursive feature elimination (described in Supplementary Material  Section S5) with the language
task and resting state scans  separately with iGC and dGC features (connections). Prior to analysis
of real data  we validated RFE by applying it to estimate key differences in two simulated networks
(Supplementary Material Fig. S2 and Fig. S3). RFE accurately identiﬁed connections that differed in
simulation “ground truth”: speciﬁcally  differences in fast timescale connections were identiﬁed by
iGC  and in slow timescale connections by dGC.
When applied to the language task versus resting state fMRI data  RFE identiﬁed a small subset of
18(/91) connections based on iGC (Fig. 4A)  and an overlapping but non-identical set of 17(/182)
connections based on dGC (Fig. 4B); these connections were key to distinguishing task (language)

7

Sampling rate1x (0.72s)3x (2.16s)5x (3.60s)7x (5.04s) 13161911211511811316191121151181131619112115118113161911211511810.513161# FeaturesAccuracy1D-DMN
LECN
RECN
A-SAL
P-SAL
LANG
AUD
SENMOT
BG
PREC
V-DMN
VISPA
PR-VIS
HI-VIS 0.40010.53200.61610.72460.430900000ABfrom resting brain states. Speciﬁcally  the highest iGC beta weights  corresponding to the most
discriminative iGC connections  occurred among various cognitive control networks  including the
anterior and posterior salience networks  the precuneus and the visuospatial network (Fig. 5A). Some
of these connections were also detected by dGC. Nevertheless  the highest dGC beta weights occurred
for connections to and from the language network  for example from the language network to dorsal
default mode network and from the precuneus to the language network (Fig. 5B). Notably  these
latter connections were important for classiﬁcation based on dGC  but not based on iGC. Moreover 
iGC identiﬁed a connection between the language network and the basal ganglia whereas dGC  in
addition  identiﬁed the directionality of the connection  as being from the language network to the
basal ganglia. In summary  dGC and iGC identiﬁed several complementary connections  but dGC
alone identiﬁed many connections with the language network  indicating that slow processes in this
network signiﬁcantly distinguished language from resting states.
Next  we tested whether estimating dGC after systematically downsampling the fMRI time series
would permit identifying maximally discriminative connections at progressively slower timescales.
To avoid degradation of GC estimates because of fewer numbers of samples with downsampling
(by decimation)  we concatenated the different downsampled time series to maintain an identical
total number of samples. RFE was applied to GC estimates based on data sampled at different rates:
1.4 Hz  0.5 Hz  0.3 Hz and 0.2 Hz corresponding to 1x  3x  5x  and 7x of TR (sampling period of
0.72 s  2.16 s  3.6 s and 5.04 s)  respectively. RFE with dGC identiﬁed 17(/182) key connections
at each of these timescales (Fig. 4B). Interestingly  some connections manifested in dGC estimates
across all sampling rates. For instance  the connection from the precuneus to the language network
was important for classiﬁcation across all sampling rates (Fig. 5C). On the other hand  connections
between the language network and various other networks manifested at speciﬁc sampling rates only.
For instance an outgoing connection from the language network to the basal ganglia manifested only
at the 1.4 Hz sampling rate  to the visuospatial network and default mode networks only at 0.5 Hz  to
the higher-visual network only at 0.2-0.3 Hz  and an incoming connection from the anterior salience
only at 0.2 Hz. None of these connections were identiﬁed by the iGC classiﬁer (compare Fig. 5A
and 5C). Similar timescale generic and timescale speciﬁc connections were observed in other tasks
as well (Supplementary Fig. S7). Despite downsampling  RFE accuracies were signiﬁcantly above
chance  although accuracies decreased at lower sampling rates (Fig. 4 lower panels) [20]. Thus  dGC
identiﬁed distinct connectivity proﬁles for data sampled at different timescales  without signiﬁcantly
compromising classiﬁcation performance.
Finally  we sought to provide independent evidence to conﬁrm whether these network connections
operated at different timescales. For this  we estimated the average cross coherence (Supplementary
Material  Section S7) between the fMRI time series of two connections from the language network
that were identiﬁed by RFE exclusively at 0.2-0.3 Hz (language to higher visual) and 0.5 Hz (language
to visuospatial) sampling rates  respectively (Fig. 5C). Each connection exhibited an extremum in the
coherence plot at a frequency which closely matched the respective connection’s timescale (Fig. 5D).
These ﬁndings  from experimental data  provide empirical validation to our simulation results  which
indicate that estimating dGC on downsampled data is a tenable approach for identifying functional
connections that operate at speciﬁc timescales.

4 Conclusions

These results contain three novel insights. First  we show that two measures of conditional linear
dependence – instantaneous and directed Granger-Geweke causality – provide robust measures of
functional connectivity in the brain  resolving over a decade of controversy in the ﬁeld [23][22].
Second  functional connections identiﬁed by iGC and dGC carry complementary information  both
in simulated and in real fMRI recordings. In particular  dGC is a powerful approach for identifying
reciprocal excitatory-inhibitory connections  which are easily missed by iGC and other same-time
correlation based metrics like partial correlations [22]. Third  when processes at multiple timescales
exist in the data  our results show that downsampling the time series to different extents provides an
effective method for recovering connections at these distinct timescales.
Our simulations highlight the importance of capturing emergent timescales in simulations of neural
data. For instance  a widely-cited study [22] employed purely feedforward connectivity matrices with
a 50 ms neural timescale in their simulations  and argued that functional connections are not reliably
inferred with GC on fMRI data. However  such connectivity matrices preclude the occurrence of

8

Figure 5: Connectivity at different timescales.
(A-B) Discriminative connections identiﬁed
exclusively by iGC (teal)  exclusively by dGC (blue)  or by both (yellow). Each connection is
represented as a band going from a source node on the left to a destination node on the right. (C)
(Top) Discriminative connections identiﬁed by dGC  exclusively at different sampling intervals (1x 
3x  5x  7x TR). (D) (Left) Directed connection between language network and visuospatial network
identiﬁed by dGC with fMRI data sampled at 0.5 Hz (sampling interval  3x TR). (Right) Directed
connection between language network and higher visual network identiﬁed by dGC with fMRI data
sampled at 0.3 Hz (sampling interval  5x TR). (Lower plots) Cross coherence between respective
network time series. Shaded area: Frequencies from Fs/2 to Fs  where Fs is the sampling rate of the
fMRI timeseries from which dGC was estimated.

slower  behaviorally relevant timescales of seconds  which readily emerge in the presence of feedback
connections  both in simulations [8][15] and in the brain [17][24]. Our simulations explicitly
incorporated these slow timescales to show that connections at these timescales could be robustly
estimated with GC on simulated fMRI data. Moreover  we show that such slow interactions also occur
in human brain networks. Our approach is particularly relevant for studies that seek to investigate
dynamic functional connectivity with slow sampling techniques  such as fMRI or calcium imaging.
Our empirical validation of the robustness of GC measures  by applying machine learning to fMRI
data from 500 subjects (and 4000 functional scans)  is widely relevant for studies that seek to
apply GC to estimate directed functional networks from fMRI data. Although  scanner noise or
hemodynamic confounds can inﬂuence GC estimates in fMRI data [20][4]  our results demonstrate
that dGC contains enough directed connectivity information for robust prediction  reaching over
95% validation accuracy with averaging even as few as 10 subjects’ connectivity matrices (Fig. 3B).
These results strongly indicate the existence of slow information ﬂow networks in the brain that
can be meaningfully inferred from fMRI data. Future work will test if these functional networks
inﬂuence behavior at distinct timescales.

Acknowledgments. This research was supported by a Wellcome Trust DBT-India Alliance
Intermediate Fellowship  a SERB Early Career Research award  a Pratiksha Trust Young Investigator
award  a DBT-IISc Partnership program grant  and a Tata Trusts grant (all to DS). We would like to
thank Hritik Jain for help with data analysis.

References
[1] L. Barnett and A. K. Seth. The MVGC multivariate Granger causality toolbox: A new approach to

Granger-causal inference. Journal of Neuroscience Methods  223:50 – 68  2014.

9

ABCDiGC onlydGC onlyBothD-DMNRECNA-SALBGPRECV-DMNVISPAHI-VISP-SALAUDD-DMNBGPRECVISPAHI-VISA-SALV-DMNP-SALAUDA-SALPRECVISPALANGRECNVISPAHI-VISRECNA-SALLANGD-DMN
LECN
RECN
A-SAL
P-SAL
LANG
AUD
SENMOT
BG
PREC
V-DMN
VISPA
PR-VIS
HI-VIS A-SALLANGPRECVISPAHI-VISD-DMNRECNP-SALLANGBGPRECV-DMNVISPAHI-VIS1.39 Hz0.46 Hz0.28 Hz0.19 HzAllLANG→VISPA (dGC 3x)0.01-0.010.7HzFreqCoherence0.46Hz0.32Hz0.01-0.010.7HzFreqCoherence0.28Hz0.14HzLANG→HI-VIS (dGC 5x)LANGV-DMND-DMNP-SALBGPREC[2] L. Barnett and A. K. Seth. Detectability of Granger causality for subsampled continuous-time neurophysi-

ological processes. Journal of Neuroscience Methods  275:93 – 121  2017.

[3] A. M. Bastos  J. Vezoli  C. A. Bosman  J.-M. Schoffelen  R. Oostenveld  J. R. Dowdall  P. De Weerd 
H. Kennedy  and P. Fries. Visual areas exert feedforward and feedback inﬂuences through distinct frequency
channels. Neuron  85(2):390–401  2015.

[4] C. Chang  M. E. Thomason  and G. H. Glover. Mapping and correction of vascular hemodynamic latency

in the BOLD signal. NeuroImage  43(1):90 – 102  2008.

[5] F. De Martino  G. Valente  N. Staeren  J. Ashburner  R. Goebel  and E. Formisano. Combining multivariate
voxel selection and support vector machines for mapping and classiﬁcation of fMRI spatial patterns.
NeuroImage  43(1):44–58  2008.

[6] M. Dhamala  G. Rangarajan  and M. Ding. Analyzing information ﬂow in brain networks with nonpara-

metric Granger causality. NeuroImage  41(2):354 – 362  2008.

[7] K. J. Friston  A. Mechelli  R. Turner  and C. J. Price. Nonlinear responses in fMRI: the Balloon model 

Volterra kernels  and other hemodynamics. NeuroImage  12(4):466–477  2000.

[8] S. Ganguli  J. W. Bisley  J. D. Roitman  M. N. Shadlen  M. E. Goldberg  and K. D. Miller. One-dimensional

dynamics of attention and decision making in LIP. Neuron  58(1):15–25  2008.

[9] I. M. Gel’fand and A. M. Yaglom. Calculation of the amount of information about a random function
contained in another such function. American Mathematical Society Translations  12(1):199–246  1959.
[10] J. Geweke. Measurement of linear dependence and feedback between multiple time series. Journal of the

American Statistical Association  77(378):304–313  1982.

[11] J. F. Geweke. Measures of conditional linear dependence and feedback between time series. Journal of the

American Statistical Association  79(388):907–915  1984.

[12] M. F. Glasser  S. N. Sotiropoulos  J. A. Wilson  T. S. Coalson  B. Fischl  J. L. Andersson  J. Xu  S. Jbabdi 
M. Webster  J. R. Polimeni  et al. The minimal preprocessing pipelines for the Human Connectome Project.
NeuroImage  80:105–124  2013.

[13] J. D. Murray  A. Bernacchia  D. J. Freedman  R. Romo  J. D. Wallis  X. Cai  C. Padoa-Schioppa  T. Paster-
nak  H. Seo  D. Lee  et al. A hierarchy of intrinsic timescales across primate cortex. Nature Neuroscience 
17(12):1661–1663  2014.

[14] M. Ojala and G. C. Garriga. Permutation tests for studying classiﬁer performance. Journal of Machine

Learning Research  11:1833–1863  2010.

[15] K. Rajan and L. Abbott. Eigenvalue spectra of random matrices for neural networks. Physical Review

Letters  97(18):188104  2006.

[16] A. Roebroeck  E. Formisano  and R. Goebel. Mapping directed inﬂuence over the brain using Granger

causality and fMRI. NeuroImage  25(1):230–242  2005.

[17] C. A. Runyan  E. Piasini  S. Panzeri  and C. D. Harvey. Distinct timescales of population coding across

cortex. Nature  548(7665):92–96  2017.

[18] S. Ryali  K. Supekar  T. Chen  and V. Menon. Multivariate dynamical systems models for estimating causal

interactions in fMRI. NeuroImage  54(2):807–823  2011.

[19] A. K. Seth. A MATLAB toolbox for Granger causal connectivity analysis. Journal of Neuroscience

Methods  186(2):262–273  2010.

[20] A. K. Seth  P. Chorley  and L. C. Barnett. Granger causality analysis of fMRI bold signals is invariant to

hemodynamic convolution but not downsampling. NeuroImage  65:540–555  2013.

[21] W. Shirer  S. Ryali  E. Rykhlevskaia  V. Menon  and M. Greicius. Decoding subject-driven cognitive states

with whole-brain connectivity patterns. Cerebral Cortex  22(1):158–165  2012.

[22] S. M. Smith  K. L. Miller  G. Salimi-Khorshidi  M. Webster  C. F. Beckmann  T. E. Nichols  J. D. Ramsey 

and M. W. Woolrich. Network modelling methods for fMRI. NeuroImage  54(2):875–891  2011.

[23] D. Sridharan  D. J. Levitin  and V. Menon. A critical role for the right fronto-insular cortex in switching
between central-executive and default-mode networks. Proceedings of the National Academy of Sciences 
105(34):12569–12574  2008.

[24] D. Vidaurre  S. M. Smith  and M. W. Woolrich. Brain network dynamics are hierarchically organized in

time. Proceedings of the National Academy of Sciences  114(48):12827–12832  2017.

10

,Chinmay Hegde
Piotr Indyk
Ludwig Schmidt
Mali Sundaresan
Arshed Nabeel
Devarajan Sridharan