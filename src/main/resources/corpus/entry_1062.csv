2016,Computational and Statistical Tradeoffs in Learning to Rank,For massive and heterogeneous modern  data sets  it is of fundamental interest to provide guarantees on the accuracy of estimation when computational resources are limited. In the application of learning to rank  we provide a hierarchy of rank-breaking mechanisms ordered by the complexity in thus generated sketch of the data. This allows the number of data points collected to be gracefully traded off against computational resources available  while guaranteeing the desired level of accuracy. Theoretical guarantees on the proposed generalized rank-breaking implicitly provide such trade-offs  which can be explicitly characterized under certain canonical scenarios on the structure of the data.,ComputationalandStatisticalTradeoffsinLearningtoRankAshishKhetanandSewoongOhDepartmentofISE UniversityofIllinoisatUrbana-ChampaignEmail:{khetan2 swoh}@illinois.eduAbstractFormassiveandheterogeneousmoderndatasets itisoffundamentalinteresttoprovideguaranteesontheaccuracyofestimationwhencomputationalresourcesarelimited.Intheapplicationoflearningtorank weprovideahierarchyofrank-breakingmechanismsorderedbythecomplexityinthusgeneratedsketchofthedata.Thisallowsthenumberofdatapointscollectedtobegracefullytradedoffagainstcomputationalresourcesavailable whileguaranteeingthedesiredlevelofaccuracy.Theoreticalguaranteesontheproposedgeneralizedrank-breakingimplicitlyprovidesuchtrade-offs whichcanbeexplicitlycharacterizedundercertaincanonicalscenariosonthestructureofthedata.1IntroductionInclassicalstatisticalinference wearetypicallyinterestedincharacterizinghowmoredatapointsimprovetheaccuracy withlittlerestrictionsorconsiderationsoncomputationalaspectsofsolvingtheinferenceproblem.However withmassivegrowthsoftheamountofdataavailableandalsothecomplexityandheterogeneityofthecollecteddata computationalresources suchastimeandmemory aremajorbottlenecksinmanymodernapplications.Asasolution recentadvancesin[7 23 8 1 16]introducehierarchiesofalgorithmicsolutions orderedbytherespectivecomputationalcomplexity forseveralfundamentalmachinelearningapplications.Guidedbysharpanalysesonthesamplecomplexity theseapproachesprovidetheoreticallysoundguidelinesthatallowtheanalysttheﬂexibilitytofallbacktosimpleralgorithmstoenjoythefullmeritoftheimprovedrun-time.Inspiredbytheseadvances westudythetime-datatradeoffinlearningtorank.Inmanyapplicationssuchaselection policymaking polling andrecommendationsystems wewanttoaggregateindi-vidualpreferencestoproduceaglobalrankingthatbestrepresentsthecollectivesocialpreference.Learningtorankisarankaggregationapproach whichassumesthatthedatacomesfromaparametricfamilyofchoicemodels andlearnstheparametersthatdeterminetheglobalranking.Traditionally eachrevealedpreferenceisassumedtohaveoneofthefollowingthreestructures.Pairwisecompari-son whereoneitemispreferredoveranother iscommoninsportsandchessmatches.Best-out-of-κcomparison whereoneischosenamongasetofκalternatives iscommoninhistoricalpurchasedata.κ-waycomparison whereweobservealinearorderingofasetofκcandidates isusedinsomeelectionsandsurveys.Forsuchtraditionalpreferences efﬁcientschemesforlearningtorankhavebeenproposed e.g.[12 9].However moderndatasetsareunstructuredandheterogeneous.Thiscanleadtosigniﬁcantincreaseinthecomputationalcomplexity requiringexponentialrun-timeinthesizeoftheproblemintheworstcase[15].Toalleviatethiscomputationalchallenge weproposeahierarchyofestimatorswhichwecallgeneralizedrank-breaking orderedinincreasingcomputationalcomplexityandachievingincreasingaccuracy.Thekeyideaistobreakdowntheheterogeneousrevealedpreferencesintosimplerpiecesofordinalrelations andapplyanestimatortailoredforthosesimplestructurestreatingeachpieceasindependent.Severalaspectsofrank-breakingmakesthisprobleminterestingandchallenging.A30thConferenceonNeuralInformationProcessingSystems(NIPS2016) Barcelona Spain.priori itisnotclearwhichchoicesofthesimpleordinalrelationsarerichenoughtobestatisticallyefﬁcientandyetleadtotractableestimators.Evenifweidentifywhichordinalrelationstoextract theignoredcorrelationsamongthosepiecescanleadtoaninconsistentestimate unlesswechoosecarefullywhichpiecestoincludeandwhichtoomitintheestimation.Wefurtherwantsharpanalysisonthesamplecomplexity whichrevealshowcomputationalandstatisticalefﬁcienciestradeoff.Wewouldliketoaddressallthesechallengesinprovidinggeneralizedrank-breakingmethods.Problemformulation.Westudytheproblemofaggregatingordinaldatabasedonusers’preferencesthatareexpressedintheformofpartiallyorderedsets(poset).Aposetisacollectionofordinalrelationsamongitems.Forexample consideraposet{(i6≺{i5 i4}) (i5≺i3) ({i3 i4}≺{i1 i2})}overitems{i1 ... i6} where(i6≺{i5 i4})indicatesthatitemi5andi4arebothpreferredoveritemi6.Sucharelationisextractedfrom forexample theusergivinga2-starratingtoi5andi4anda1-startoi6.Assumingthattherevealedpreferenceisconsistent aposetcanberepresentedasadirectedacyclicgraph(DAG)Gjasbelow.i1i2i3i4i5i6i1i2i3i4i5i6i1i2i3i4i5i6Gje1e2Figure1:AnexampleofGjforuserj’sconsistentposet andtworank-breakinghyperedgesextractedfromit:e1=({i6 i5 i4 i3}≺{i2 i1})ande2=({i6}≺{i5 i4 i3}).WeassumethateachuserjispresentedwithasubsetofitemsSj andindependentlyprovidesherordinalpreferenceintheformofaposet wheretheorderingisdrawnfromthePlackett-Luce(PL)model.ThePLmodelisapopularchoicemodelfromoperationsresearchandpsychology usedtomodelhowpeoplemakechoicesunderuncertainty.Itisaspecialcaseofrandomutilitymodels whereeachitemiisparametrizedbyalatenttrueutilityθi∈R.WhenofferedwithSj theusersamplestheperceivedutilityUiforeachitemindependentlyaccordingtoUi=θi+Zi whereZi’sarei.i.d.noise.Inparticular thePLmodelassumesZi’sfollowthestandardGumbeldistribution.AlthoughstatisticalandcomputationaltradeoffhasbeenstudiedunderMallowsmodels[6]orstochasticallytransitivemodels[22] thetechniqueswedeveloparedifferentandhaveapotentialtogeneralizetoanalyzemoregeneralclassofrandomutilitymodels.Theobservedposetisapartialobservationoftheorderingaccordingtothisperceivedutilities.TheparticularchoiceoftheGumbeldistributionhasseveralmerits largelystemmingfromthefactthattheGumbeldistributionhasalog-concavepdfandisinherentlymemoryless.Inouranalyses weusethelog-concavitytoshowthatourproposedalgorithmisaconcavemaximization(Remark2.1)andthememorylesspropertyformsthebasisofourrank-breakingidea.Precisely thePLmodelisstatisticallyequivalenttothefollowingprocedure.Considerarankingasamappingfromaranktoanitem i.e.σj:[|Sj|]→Sj.ItcanbeshownthatthePLmodelisgeneratedbyﬁrstindependentlyassigningeachitemi∈SjanunobservedvalueYi exponentiallydistributedwithmeane−θi andtheresultingrankingσjisinverselyorderedinYi’ssothatYσj(1)≤Yσj(2)≤···≤Yσj(|Sj|).Thisinheritsthememorylesspropertyofexponentialvariables suchthatP(Y1<Y2<Y3)=P(Y1<{Y2 Y3})P(Y2<Y3) leadingtoasimpleinterpretationofthePLmodelassequentialchoices:P(i3≺i2≺i1)=P({i3 i2}≺i1)P(i3≺i2)=(eθi1/(eθi1+eθi2+eθi3))×(eθi2/(eθi2+eθi3)).Ingeneral wehaveP[σj]=Q|Sj|−1i=1(eθ∗σj(i))/(P|Sj|i0=ieθ∗σj(i0)).Weassumethatthetrueutilityθ∗∈ΩbwhereΩb={θ∈Rd|Pi∈[d]θi=0 |θi|≤bforalli∈[d]}.NoticethatcenteringofθensuresitsuniquenessasPLmodelisinvariantundershiftingofθ.Theboundbonθiiswrittenexplicitlytocapturethedependenceinourmainresults.Wedenoteasetofnusersby[n]={1 ... n}andthesetofditemsby[d].LetGjdenotetheDAGrepresentationoftheposetprovidedbytheuserjoverSj⊆[d]accordingtothePLmodelwithweightsθ∗.Themaximumlikelihoodestimate(MLE)maximizesthesumofallpossiblerankings2thatareconsistentwiththeobservedGjforeachj:bθ∈argmaxθ∈Ωb(cid:26)nXj=1log(cid:18)Xσ∈GjPθ[σ](cid:19)(cid:27) (1)whereweslightlyabusethenotationGjtodenotethesetofallrankingsσthatareconsistentwiththeobservation.WhenGjhasatraditionalstructureasexplainedearlierinthissection thentheoptimizationisasimplemultinomiallogitregression thatcanbesolvedefﬁcientlywithoff-the-shelfconvexoptimizationtools[12].Forgeneralposets itcanbeshownthattheaboveoptimizationisaconcavemaximization usingsimilartechniquesasRemark2.1.However thesummationoverrankingsinGjcaninvolvenumberoftermssuperexponentialinthesize|Sj| intheworstcase.ThisrendersMLEintractableandimpractical.Pairwiserank-breaking.Acommonremedytothiscomputationalblow-upistouserank-breaking.Rank-breakingtraditionallyreferstopairwiserank-breaking whereabagofallthepairwisecom-parisonsisextractedfromobservations{Gj}j∈[n]andisappliedtoestimatorsthataretailoredforpairwisecomparisons treatingeachpairedoutcomeasindependent.Thisisoneofthemotivationsbehindthealgorithmicadvancesinlearningfrompairwisecomparisons[19 21 17].Itiscomputationallyefﬁcienttoapplymaximumlikelihoodestimatorassumingindependentpairwisecomparisons whichtakesO(d2)operationstoevaluate.However thiscomputationalgaincomesatthecostofstatisticalefﬁciency.Itisknownfrom[4]thatifweincludeallpairedcomparisons thentheresultingestimatecanbestatisticallyinconsistentduetotheignoredcorrelationsamongthepairedorderings evenwithinﬁnitesamples.IntheexamplefromFigure1 thereare12pairedrelations:(i6≺i5) (i6≺i4) (i6≺i3) ... (i3≺i1) (i4≺i1).Inordertogetaconsistentestimate [4]providesaruleforchoosingwhichpairstoinclude and[15]providesanestimatorthatoptimizeshowtoweigheachofthosechosenpairstogetthebestﬁnitesamplecomplexitybound.However suchaconsistentpairwiserank-breakingresultsinthrowingawaymanyoftheorderedrelations resultinginsigniﬁcantlossinaccuracy.Forexample noneofthepairwiseorderingscanbeusedfromGjintheexample withoutmakingtheestimatorinconsistent[3].Whetherweincludeallpairedcomparisonsoronlyasubsetofconsistentones thereisasigniﬁcantlossinaccuracyasillustratedinFigure2.Forthepreciseconditionforconsistentrank-breakingwereferto[3 4 15].Thestate-of-the-artapproachesoperateoneitheroneofthetwoextremepointsonthecomputationalandstatisticaltrade-off.TheMLEin(1)requiresO(Pj∈[n]|Sj|!)summationstojustevaluatetheobjectivefunction intheworstcase.Ontheotherhand thepairwiserank-breakingrequiresonlyO(d2)summations butsuffersfromsigniﬁcantlossinthesamplecomplexity.Ideally wewouldliketogivetheanalysttheﬂexibilitytochooseatargetcomputationalcomplexitysheiswillingtotolerate andprovideanalgorithmthatachievestheoptimaltrade-offatanyoperatingpoint.Contribution.Weintroduceanovelgeneralizedrank-breakingthatbridgesthegapbetweenMLEandpairwiserank-breaking.Ourapproachallowstheuserthefreedomtochoosethelevelofcomputationalresourcestobeused andprovidesanestimatortailoredforthedesiredcomplexity.Weprovethattheproposedestimatoristractableandconsistent andprovideanupperboundontheerrorrateintheﬁnitesampleregime.Theanalysisexplicitlycharacterizesthedependenceonthetopologyofthedata.Thisinturnprovidesaguidelinefordesigningsurveysandexperimentsinpractice inordertomaximizethesampleefﬁciency.Weprovidenumericalexperimentsconﬁrmingthetheoreticalguarantees.2Generalizedrank-breakingGivenGj’srepresentingtheusers’preferences generalizedrank-breakingextractsasetoforderedrelationsandappliesanestimatortreatingeachorderedrelationasindependent.Concretely foreachGj weﬁrstextractamaximalorderedpartitionPjofSjthatisconsistentwithGj.Anorderedpartitionisapartitionwithalinearorderingamongthesubsets e.g.Pj=({i6}≺{i5 i4 i3}≺{i2 i1})forGjfromFigure1.Thisismaximal sincewecannotfurtherpartitionanyofthesubsetswithoutcreatingartiﬁcialorderedrelationsthatarenotpresentintheoriginalGj.TheextractedorderedpartitionisrepresentedbyadirectedhypergraphGj(Sj Ej) whichwecallarank-breakinggraph.Eachedgee=(B(e) T(e))∈EjisadirectedhyperedgefromasubsetofnodesB(e)⊆SjtoanothersubsetT(e)⊆Sj.ThenumberofedgesinEjis|Pj|−13where|Pj|isthenumberofsubsetsinthepartition.ForeachsubsetinPjexceptfortheleastpreferredsubset thereisacorrespondingedgewhosetop-setT(e)isthesubset andthebottom-setB(e)isthesetofallitemslesspreferredthanT(e).InFigure1 forEj={e1 e2}weshowe1=(B(e1) T(e1))=({i6 i5 i4 i3} {i2 i1})ande2=(B(e2) T(e2)=({i6} {i5 i4 i3})extractedfromGj.DenotetheprobabilitythatT(e)ispreferredoverB(e)whenT(e)∪B(e)isofferedasPθ(e)=Pθ(cid:0)B(e)≺T(e)(cid:1)=Xσ∈ΛT(e)exp(cid:16)P|T(e)|c=1θσ(c)(cid:17)Q|T(e)|u=1(cid:16)P|T(e)|c0=uexp(cid:0)θσ(c0)(cid:1)+Pi∈B(e)exp(θi)(cid:17)(2)whichfollowsfromthedeﬁnitionofthePLmodel whereΛT(e)isthesetofallrankingsoverT(e).Thecomputationalcomplexityofevaluatingthisprobabilityisdominatedbythesizeofthetop-set|T(e)| asitinvolves(|T(e)|!)summations.WelettheanalystchoosetheorderM∈Z+dependingonhowmuchcomputationalresourceisavailable andonlyincludethoseedgeswith|T(e)|≤Minthefollowingstep.WeapplytheMLEforcomparisonsoverpairedsubsets assumingallrank-breakinggraphsareindependentlydrawn.Precisely weproposeorder-Mrank-breakingestimate whichisthesolutionthatmaximizesthelog-likelihoodundertheindependentassumption:bθ∈argmaxθ∈ΩbLRB(θ) whereLRB(θ)=Xj∈[n]Xe∈Ej:|T(e)|≤MlogPθ(e).(3)InaspecialcasewhenM=1 thiscanbetransformedintothetraditionalpairwiserank-breaking where(i)thisisaconcavemaximization;(ii)theestimateis(asymptotically)unbiasedandconsistent[3 4];and(iii)andtheﬁnitesamplecomplexityhavebeenanalyzed[15].Although thisorder-1rank-breakingprovidesasigniﬁcantgainincomputationalefﬁciency theinformationcontainedinhigher-orderedgesareunused resultinginasigniﬁcantlossinsampleefﬁciency.Weprovidetheanalystthefreedomtochoosethecomputationalcomplexityhe/sheiswillingtotolerate.However forgeneralM ithasnotbeenknowniftheoptimizationin(3)istractableand/orifthesolutionisconsistent.SincePθ(B(e)≺T(e))asexplicitlywrittenin(2)isasumoflog-concavefunctions itisnotclearifthesumisalsolog-concave.Duetotheignoreddependencyintheformulation(3) itisnotcleariftheresultingestimateisconsistent.WeﬁrstestablishthatitisaconcavemaximizationinRemark2.1 thenproveconsistencyinRemark2.2 andprovideasharpanalysisoftheperformanceintheﬁnitesampleregime characterizingthetrade-offbetweencomputationandsamplesizeinSection4.WeusetheRandomUtilityModel(RUM)interpretationofthePLmodeltoproveconcavity.WerefertoAppendixAinthesupplementarymaterialforaproof.Remark2.1.LRB(θ)isconcaveinθ∈Rd.Forconsistency weconsiderasimplebutcanonicalscenarioforsamplingorderedrelations.However westudyageneralsamplingscenario whenweanalyzetheorder-MestimatorintheﬁnitesampleregimeinSection4.Followingisthecanonicalsamplingscenario.Thereisasetof˜‘integers(˜m1 ... ˜m˜‘)whosesumisstrictlylessthand.Anewarrivinguserispresentedwithallditemsandisaskedtoprovidehertop˜m1itemsasanunorderedset andthenthenext˜m2items andsoon.ThisissamplingfromthePLmodelandobservinganorderedpartitionwith(˜‘+1)subsetsofsizes˜ma’s andthelastsubsetincludesallremainingitems.Weapplythegeneralizedrank-breakingtogetrank-breakinggraphs{Gj}with˜‘edgeseach andorder-Mestimateiscomputed.Weshowthatthisisconsistent i.e.asymptoticallyunbiasedinthelimitofthenumberofusersn.Aproofisprovidedinthesupplementarymaterial.Remark2.2.UnderthePLmodelandtheabovesamplingscenario theorder-Mrank-breakingestimatebθin(3)isconsistentforallchoicesofM≥mina∈˜‘˜ma.Figure2(left)illustratesthetrade-offbetweenrun-timeandsamplesizenecessarytoachieveaﬁxedaccuracy:MSE≤0.3d2×10−6.Inthemiddlepanel weshowtheaccuracy-sampletradeoffforincreasingcomputationMonthesamedata.Weﬁxd=256 ˜‘=5 ˜ma=afora∈{1 2 3 4 5} andsampleposetsfromthecanonicalscenario exceptthateachuserispresentedκ=32randomitems.ThePLweightsarechoseni.i.d.U[−2 2].Ontherightpanel welet˜ma=3foralla∈[˜‘]andvary˜‘.WecompareGRBwithM=3toPRB andanoracleestimatorwhoknowstheexactorderingamongthosetopthreeitemsandrunsMLE.4 200 600 100 1000105106Time(s)samplesizenM=1M=2M=3M=4M=510-610-510-4104105106inconsistent PRBGRB order M = 1234Ckbθ−θ∗k22samplesizen 0.05 4 0.1 112481620inconsistent PRBGRB order M=3oracle lower boundCR lower boundnumberofedges|Ej|Figure2:Thetime-datatrade-offforﬁxedaccuracy(left)andaccuracyimprovementforincreasedcomputationM(middle).GeneralizedRank-Breaking(GRB)achievestheoraclelowerboundandsigniﬁcantlyimprovesuponPairwiseRank-Breaking(PRB)(right).Notations.Givenrank-breakinggraphs{Gj(Sj Ej)}j∈[n]extractedfromtheposets{Gj} weﬁrstdeﬁnetheorderMrank-breakinggraphs{G(M)j(Sj E(M)j)} whereE(M)jisasubsetofEjthatincludesonlythoseedgesej∈Ejwith|T(ej)|≤M.ThisrepresentsthoseedgesthatareincludedintheestimationforachoiceofM.Forﬁnitesampleanalysis thefollowingquantitiescapturehowtheerrordependsonthetopologyofthedatacollected.Letκj≡|Sj|and‘j≡|E(M)j|.WeindexeachedgeejinE(M)jbya∈[‘j]anddeﬁnemj a≡|T(ej a)|forthea-thedgeofthej-thrank-breakinggraphandrj a≡|T(ej a)|+|B(ej a)|.Notethat weusetildeinsubscriptwithmj aand‘jwhenMisequaltoSj.Thatis˜‘jisthenumberofedgesinEjand˜mj aisthesizeofthetop-setsinthoseedges.Weletpj≡Pa∈[‘j]mj adenotetheeffectivesamplesizefortheobservationG(M)j suchthatthetotaleffectivesamplesizeisPj∈[n]pj.NoticethatalthoughwedonotexplicitlywritethedependenceonM alloftheabovequantitiesimplicitlydependonthechoiceofM.3ComparisongraphTheanalysisoftheoptimizationin(3)showsthat withhighprobability LRB(θ)isstrictlyconcavewithλ2(H(θ))≤−Cbγ1γ2γ3λ2(L)<0forallθ∈Ωb(LemmaC.3) andthegradientisalsoboundedwithk∇LRB(θ∗)k≤C0bγ−1/22(Pjpjlogd)1/2(LemmaC.2).thequantitiesγ1 γ2 γ3 andλ2(L) tobedeﬁnedshortly representthetopologyofthedata.ThisleadstoTheorem4.1:kbθ−θ∗k2≤2k∇LRB(θ∗)k−λ2(H(θ))≤C00bqPjpjlogdγ1γ3/22γ3λ2(L) (4)whereCb C0b andC00bareconstantsthatonlydependonb andλ2(H(θ))isthesecondlargesteigenvalueofanegativesemideﬁniteHessianmatrixH(θ)ofLRB(θ).Recallthatθ>1=0sincewerestrictoursearchinΩb.Hence theerrordependsonλ2(H(θ))insteadofλ1(H(θ))whosecorrespondingeigenvectoristheall-onesvector.WedeﬁneacomparisongraphH([d] E)asaweightedundirectedgraphwithweightsAii0=Pj∈[n]:i i0∈Sjpj/(κj(κj−1)).ThecorrespondinggraphLaplacianisdeﬁnedas:L≡nXj=1pjκj(κj−1)Xi<i0∈Sj(ei−ei0)(ei−ei0)>.(5)Itisimmediatethatλ1(L)=0with1astheeigenvector.Thereareremainingd−1eigenvaluesthatsumtoTr(L)=Pjpj.Therescaledλ2(L)andλd(L)capturethedependencyonthetopology:α≡λ2(L)(d−1)Tr(L) β≡Tr(L)λd(L)(d−1).(6)Inanidealcasewherethegraphiswellconnected thenthespectralgapoftheLaplacianislarge.Thisensuresalleigenvaluesareofthesameorderandα=β=Θ(1) resultinginasmallererror5rate.TheconcavityofLRB(θ)alsodependsonthefollowingquantities.WediscusstheroleofthetopologyinSection4.NotethatthequantitiesdeﬁnedinthissectionimplicitlydependonthechoiceofM whichcontrolsthenecessarycomputationalpower viathedeﬁnitionoftherank-breaking{Gj a}.Wedeﬁnethefollowingquantitiesthatcontrolourupperbound.γ1incorporatesasymmetryinprobabilitiesofitemsbeingrankedatdifferentpositionsdependingupontheirweightθ∗i.Itis1forb=0thatiswhenalltheitemshavesameweight anddecreasesexponentiallywithincreaseinb.γ2controlstherangeofthesizeofthetop-setwithrespecttothesizeofthebottom-setforwhichtheerrordecayswiththerateof1/(sizeofthetop-set).Thedependenceinγ3andνareduetoweaknessintheanalysis andensuresthattheHessianmatrixisstrictlynegativedeﬁnite.γ1≡minj a(cid:26)(cid:18)rj a−mj aκj(cid:19)2e2b−2(cid:27) γ2≡minj a(cid:26)(cid:18)rj a−mj arj a(cid:19)2(cid:27) and(7)γ3≡1−maxj a(cid:26)4e16bγ1m2j ar2j aκ2j(rj a−mj a)5(cid:27) ν≡maxj a(cid:26)mj aκ2j(rj a−mj a)2(cid:27).(8)4MainResultsWepresentmaintheoreticalanalysesandnumericalsimulationsconﬁrmingthetheoreticalpredictions.4.1UpperboundontheachievableerrorWeprovideanupperboundontheerrorfortheorder-Mrank-breakingapproach showingtheexplicitdependenceonthetopologyofthedata.Weassumeeachuserprovidesapartialrankingaccordingtohis/herorderedpartitions.Precisely weassumethatthesetofofferingsSj thenumberofsubsets(˜‘j+1) andtheirrespectivesizes(˜mj 1 ... ˜mj ˜‘j)arepredetermined.EachuserrandomlydrawsarankingofitemsfromthePLmodel andprovidesthepartialrankingoftheform({i6}≺{i5 i4 i3}≺{i2 i1})intheexampleinFigure1.ForachoiceofM theorder-Mrank-breakinggraphisextractedfromthisdata.Thefollowingtheoremprovidesanupperboundontheachievederror andaproofisprovidedinthesupplementarymaterial.Theorem4.1.Supposetherearenusers ditemsparametrizedbyθ∗∈Ωb andeachuserj∈[n]ispresentedwithasetofofferingsSj⊆[d]andprovidesapartialorderingunderthePLmodel.ForachoiceofM∈Z+ ifγ3>0andtheeffectivesamplesizePnj=1pjislargeenoughsuchthatnXj=1pj≥214e20bν2(αγ1γ2γ3)2βpmaxκmindlogd (9)whereb≡maxi|θ∗i|isthedynamicrange pmax=maxj∈[n]pj κmin=minj∈[n]κj αisthe(rescaled)spectralgap βisthe(rescaled)spectralradiusin(6) andγ1 γ2 γ3 andνaredeﬁnedin(7)and(8) thenthegeneralizedrank-breakingestimatorin(3)achieves1√dkbθ−θ∗k≤40e7bαγ1γ3/22γ3sdlogdPnj=1P‘ja=1mj a (10)withprobabilityatleast1−3e3d−3.Moreover forM≤3theaboveboundholdswithγ3replacedbyone givingatighterresult.NotethatthedependenceonthechoiceofMisnotexplicitinthebound butratherisimplicitintheconstructionofthecomparisongraphandthenumberofeffectivesamplesN=PjPa∈[‘j]mj a.Inanidealcase b=O(1)andmj a=O(r1/2j a)forall(j a)suchthatγ1 γ2areﬁnite.further ifthespectralgapislargesuchthatα>0andβ>0 thenEquation(10)impliesthatweneedtheeffectivesamplesizetoscaleasO(dlogd) whichisonlyalogarithmicfactorlargerthanthenumberofparameters.Inthisidealcase thereexistuniversalconstantsC1 C2suchthatifmj a<C1√rj aandrj a>C2κjforall{j a} thentheconditionγ3>0ismet.Further whenrj a=O(κj a) maxκj a/κj0 a0=O(1) andmaxpj a/pj0 a0=O(1) thenconditionontheeffectivesamplesizeismetwithPjpj=O(dlogd).Webelievethatdependenceinγ3isweaknessofouranalysisandthereisnodependenceaslongasmj a<rj a.64.2LowerboundoncomputationallyunboundedestimatorsRecallthat˜‘j≡|Ej| ˜mj a=|T(ea)|and˜rj a=|T(ea)∪B(ea)|whenM=Sj.Weproveafundamentallowerboundontheachievableerrorratethatholdsforanyunbiasedestimatorevenwithnorestrictionsonthecomputationalcomplexity.Foreach(j a) deﬁneηj aasηj a=˜mj a−1Xu=0(cid:16)1˜rj a−u+u(˜mj a−u)˜mj a(˜rj a−u)2(cid:17)+Xu<u0∈[˜mj a−1]2u˜mj a(˜rj a−u)˜mj a−u0˜rj a−u0(11)=˜m2j a/(3˜rj a)+O(˜m3j a/˜r2j a).(12)Theorem4.2.LetUdenotethesetofallunbiasedestimatorsofθ∗thatarecenteredsuchthatbθ1=0 andletµ=maxj∈[n] a∈[˜‘j]{˜mj a−ηj a}.Forallb>0 infbθ∈Usupθ∗∈ΩbE[kbθ−θ∗k2]≥max(d−1)2Pnj=1P˜‘ja=1(˜mj a−ηj a) 1µdXi=21λi(L).(13)TheproofreliesontheCramer-Raoboundandisprovidedinthesupplementarymaterial.Sinceηj a’sarenon-negative themeansquarederrorislowerboundedby(d−1)2/N whereN=PjPa∈˜‘j˜mj aistheeffectivesamplesize.Comparingittotheupperboundin(10) thisistightuptoalogarithmicfactorwhen(a)thetopologyofthedataiswell-behavedsuchthatallrespectivequantitiesareﬁnite;and(b)thereisnolimitonthecomputationalpowerandMcanbemadeaslargeasweneed.TheboundinEq.(13)furthergivesatighterlowerbound capturingthedependencyinηj a’sandλi(L)’s.Consideringtheﬁrstterm ηj aislargerwhen˜mj aiscloseto˜rj a givingatighterbound.Thesecondtermin(13)implieswegetatighterboundwhenλ2(L)issmaller. 112345inconsistent PRBGRB order M=moracle lower boundCR lower boundCkbθ−θ∗k22sizeoftop-setm 112345inconsistent PRBGRB order M=moracle lower boundCR lower boundsizeoftop-setm110100568163264 10b=210.50.2CR lower boundset-sizeκFigure3:Accuracydegradesas(κ−m)getssmallandasthedynamicrangebgetslarge.InFigure3leftandmiddlepanel wecompareperformanceofouralgorithmwithpairwisebreaking CramerRaolowerboundandoracleMLElowerbound.Weﬁxd=512 n=105 θ∗choseni.i.d.uniformlyover[−2 2].OracleMLEknowsrelativeorderingofitemsinallthetop-setsT(e)andhenceisstrictlybetterthantheGRB.Weﬁx˜‘=‘=1thatisr=κ andvarym.Intheleftpanel weﬁxκ=32andinthemiddlepanel weﬁxκ=16.Perhapssurprisingly GRBmatcheswiththeoracleMLEwhichmeansrelativeorderingoftop-mitemsamongthemselvesisstatisticallyinsigniﬁcantwhenmissufﬁcientlysmallincomparisontoκ.Forκ=16 asmgetslarge theerrorstartstoincreaseaspredictedbyouranalysis.Thereasonisthatthequantitiesγ1andγ2getssmallerasmincreases andtheupperboundincreasesconsequently.Intherightpanel weﬁxm=4.Whenκissmall γ2issmall andhenceerrorislarge;whenbislargeγ1isexponentiallysmall andhenceerrorissigniﬁcantlylarge.ThisisdifferentfromlearningMallowsmodels wherepeakeddistributionsareeasiertolearn[2] andisrelatedtothefactthatwearenotonlyinterestedinrecoveringthe(ordinal)rankingbutalsothe(cardinal)weight.4.3ComputationalandstatisticaltradeoffForestimatorswithlimitedcomputationalpower however theabovelowerboundfailstocapturethedependencyontheallowedcomputationalpower.Understandingsuchfundamentaltrade-offsisachallengingproblem whichhasbeenstudiedonlyinafewspecialcases e.g.plantedcliqueproblem7[10 18].Thisisoutsidethescopeofthispaper andweinsteadinvestigatethetrade-offachievedbytheproposedrank-breakingapproach.Whenwearelimitedoncomputationalpower Theorem4.1implicitlycapturesthisdependencewhenorder-Mrank-breakingisused.Thedependenceiscapturedindirectlyviatheresultingrank-breaking{Gj a}j∈[n] a∈[‘j]andthetopologyofit.Wemakethistrade-offexplicitbyconsideringasimplebutcanonicalexample.Supposeθ∗∈Ωbwithb=O(1).Eachusergivesani.i.d.partialranking whereallitemsareofferedandthepartialrankingisbasedonanorderedpartitionwith˜‘j=b√2cd1/4csubsets.Thetopsubsethassize˜mj 1=1 andthea-thsubsethassize˜mj a=a uptoa<˜‘j inordertoensurethattheysumatmosttoc√dforsufﬁcientlysmallpositiveconstantcandtheconditiononγ3>0issatisﬁed.Thelastsubsetincludesalltheremainingitemsinthebottom ensuring˜mj ˜‘j≥d/2andγ1 γ2andνareallﬁnite.Computation.ForachoiceofMsuchthatM≤‘j−1 weconsiderthecomputationalcomplexityinevaluatingthegradientofLRB whichscalesasTM=Pj∈[n]Pa∈[M](mj a!)rj a=O(M!×dn).NotethatweﬁndtheMLEbysolvingaconvexoptimizationproblemusingﬁrstordermethods anddetailedanalysisoftheconvergencerateandthecomplexityofsolvinggeneralconvexoptimizationsisoutsidethescopeofthispaper.Sample.Underthecanonicalsetting forM≤‘j−1 wehaveL=M(M+1)/(2d(d−1))(cid:0)I−11>(cid:1).Thiscompletegraphhasthelargestpossiblespectralgap andhenceα>0andβ>0.SincetheeffectivesamplessizeisPj a˜mj aI{˜mj a≤M}=nM(M+1)/2 itfollowsfromTheorem4.1thatthe(rescaled)rootmeansquarederrorisO(p(dlogd)/(nM2)).Inordertoachieveatargeterrorrateofε weneedtochooseM=Ω((1/ε)p(dlogd)/n).Theresultingtrade-offbetweenrun-timeandsampletoachieverootmeansquarederrorεisT(n)∝(d(1/ε)p(dlogd)/ne)!dn.WeshownumericalexperimentunderthiscanonicalsettinginFigure2(left)withd=256andM∈{1 2 3 4 5} illustratingthetrade-offinpractice.4.4Real-worlddatasetsOnsushipreferences[14]andjesterdataset[11] weimproveoverpairwisebreakingandachievessameperformanceastheoracleMLE.Fullrankingsoverκ=10typesofsushiarerandomlychosenfromd=100typesofsushiareprovidedbyn=5000individuals.Asthegroundtruthθ∗ weusetheMLestimateofPLweightsovertheentiredata.InFigure4 leftpanel foreachm∈{3 4 5 6 7} weremovetheknownorderingamongthetop-mandbottom-(10−m)sushiineachset andrunourestimatorwithonebreakingedgebetweentop-mandbottom-(10−m)items.Wecompareouralgorithmwithinconsistentpairwisebreaking(usingoptimalchoiceofparametersfrom[15])andtheoracleMLE.Form≤6 theproposedrank-breakingperformsaswellasanoraclewhoknowsthehiddenrankingamongthetopmitems.Jesterdatasetconsistsofcontinuousratingsbetween−10to+10of100jokesonsetsofsizeκ 36≤κ≤100 by24 983users.Weconvertratingsintofullrankings.Thegroundtruthθ∗iscomputedsimilarly.Form∈{2 3 4 5} weconverteachfullrankingintoaposetthathas‘=bκ/mcpartitionsofsizem byremovingknownrelativeorderingfromeachpartition.Figure4comparesthethreealgorithmsusingallsamples(middlepanel) andbyvaryingthesamplesize(rightpanel)forﬁxedm=4.Allﬁguresareaveragedover50instances. 1 10 3 4 5 6 7inconsistent PRBGRB order M = moracle lower boundCkbθ−θ∗k22sizeoftop-setm 0.01 0.1 1 2 3 4 5inconsistent PRBGRB order M = moracle lower boundsizeoftop-setsm 0.001 0.01 0.1 1000 10000inconsistent PRBGRB order M = 4oracle lower boundsamplesizenFigure4:Generalizedrank-breakingimprovesoverpairwiseRBandisclosetooracleMLE.AcknowledgementsThisworkissupportedbyNSFSaTCawardCNS-1527754 andNSFCISEawardCCF-1553452.8References[1]A.Agarwal P.L.Bartlett andJ.C.Duchi.Oracleinequalitiesforcomputationallyadaptivemodelselection.arXivpreprintarXiv:1208.0129 2012.[2]A.AliandM.Meil˘a.Experimentswithkemenyranking:Whatworkswhen?MathematicalSocialSciences 64(1):28–40 2012.[3]H.AzariSouﬁani W.Chen D.CParkes andL.Xia.Generalizedmethod-of-momentsforrankaggregation.InAdvancesinNeuralInformationProcessingSystems26 pages2706–2714 2013.[4]H.AzariSouﬁani D.Parkes andL.Xia.Computingparametricrankingmodelsviarank-breaking.InProceedingsofThe31stInternationalConferenceonMachineLearning pages360–368 2014.[5]H.AzariSouﬁani D.C.Parkes andL.Xia.Randomutilitytheoryforsocialchoice.InNIPS pages126–134 2012.[6]N.Betzler R.Bredereck andR.Niedermeier.Theoreticalandempiricalevaluationofdatareductionforexactkemenyrankaggregation.AutonomousAgentsandMulti-AgentSystems 28(5):721–748 2014.[7]O.BousquetandL.Bottou.Thetradeoffsoflargescalelearning.InAdvancesinneuralinformationprocessingsystems pages161–168 2008.[8]V.ChandrasekaranandM.I.Jordan.Computationalandstatisticaltradeoffsviaconvexrelaxation.ProceedingsoftheNationalAcademyofSciences 110(13):E1181–E1190 2013.[9]Y.ChenandC.Suh.Spectralmle:Top-krankaggregationfrompairwisecomparisons.arXiv:1504.07218 2015.[10]Y.DeshpandeandA.Montanari.Improvedsum-of-squareslowerboundsforhiddencliqueandhiddensubmatrixproblems.arXivpreprintarXiv:1502.06590 2015.[11]K.Goldberg T.Roeder D.Gupta andC.Perkins.Eigentaste:Aconstanttimecollaborativeﬁlteringalgorithm.InformationRetrieval 4(2):133–151 2001.[12]B.Hajek S.Oh andJ.Xu.Minimax-optimalinferencefrompartialrankings.InAdvancesinNeuralInformationProcessingSystems27 pages1475–1483 2014.[13]T.P.Hayes.Alarge-deviationinequalityforvector-valuedmartingales.Combinatorics ProbabilityandComputing 2005.[14]T.Kamishima.Nantonaccollaborativeﬁltering:recommendationbasedonorderresponses.InProceedingsoftheninthACMSIGKDDinternationalconferenceonKnowledgediscoveryanddatamining pages583–588.ACM 2003.[15]A.KhetanandS.Oh.Data-drivenrankbreakingforefﬁcientrankaggregation.InInternationalConferenceonMachineLearning 2016.[16]M.Lucic M.I.Ohannessian A.Karbasi andA.Krause.Tradeoffsforspace time dataandriskinunsupervisedlearning.InAISTATS 2015.[17]L.MaystreandM.Grossglauser.Fastandaccurateinferenceofplackett-lucemodels.InAdvancesinNeuralInformationProcessingSystems28(NIPS2015) 2015.[18]R.Meka A.Potechin andA.Wigderson.Sum-of-squareslowerboundsforplantedclique.InProceedingsoftheForty-SeventhAnnualACMonSymposiumonTheoryofComputing pages87–96.ACM 2015.[19]S.Negahban S.Oh andD.Shah.Rankcentrality:Rankingfrompair-wisecomparisons.preprintarXiv:1209.1688 2014.[20]A.Prékopa.Logarithmicconcavemeasuresandrelatedtopics.InStochasticprogramming 1980.[21]N.B.Shah S.Balakrishnan J.Bradley A.Parekh K.Ramchandran andM.J.Wainwright.Estimationfrompairwisecomparisons:Sharpminimaxboundswithtopologydependence.arXiv:1505.01462 2015.[22]N.B.Shah S.Balakrishnan A.Guntuboyina andM.J.Wainright.Stochasticallytransitivemodelsforpairwisecomparisons:Statisticalandcomputationalissues.arXivpreprintarXiv:1510.05610 2015.[23]S.Shalev-ShwartzandN.Srebro.Svmoptimization:inversedependenceontrainingsetsize.InProceedingsofthe25thinternationalconferenceonMachinelearning pages928–935.ACM 2008.9,Ashish Khetan
Sewoong Oh