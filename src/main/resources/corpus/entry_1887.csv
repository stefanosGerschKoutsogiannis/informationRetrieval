2018,Ex ante coordination and collusion in zero-sum multi-player extensive-form games,Recent milestones in equilibrium computation  such as the success of Libratus  show that it is possible to compute strong solutions to two-player zero-sum games in theory and practice. This is not the case for games with more than two players  which remain one of the main open challenges in computational game theory. This paper focuses on zero-sum games where a team of players faces an opponent  as is the case  for example  in Bridge  collusion in poker  and many non-recreational applications such as war  where the colluders do not have time or means of communicating during battle  collusion in bidding  where communication during the auction is illegal  and coordinated swindling in public. The possibility for the team members to communicate before game play—that is  coordinate their strategies ex ante—makes the use of behavioral strategies unsatisfactory. The reasons for this are closely related to the fact that the team can be represented as a single player with imperfect recall. We propose a new game representation  the realization form  that generalizes the sequence form but can also be applied to imperfect-recall games. Then  we use it to derive an auxiliary game that is equivalent to the original one. It provides a sound way to map the problem of finding an optimal ex-ante-correlated strategy for the team to the well-understood Nash equilibrium-finding problem in a (larger) two-player zero-sum perfect-recall game. By reasoning over the auxiliary game  we devise an anytime algorithm  fictitious team-play  that is guaranteed to converge to an optimal coordinated strategy for the team against an optimal opponent  and that is dramatically faster than the prior state-of-the-art algorithm for this problem.,Exantecoordinationandcollusioninzero-summulti-playerextensive-formgamesGabrieleFarina∗ComputerScienceDepartmentCarnegieMellonUniversitygfarina@cs.cmu.eduAndreaCelli∗DEIBPolitecnicodiMilanoandrea.celli@polimi.itNicolaGattiDEIBPolitecnicodiMilanonicola.gatti@polimi.itTuomasSandholmComputerScienceDepartmentCarnegieMellonUniversitysandholm@cs.cmu.eduAbstractRecentmilestonesinequilibriumcomputation suchasthesuccessofLibratus showthatitispossibletocomputestrongsolutionstotwo-playerzero-sumgamesintheoryandpractice.Thisisnotthecaseforgameswithmorethantwoplayers whichremainoneofthemainopenchallengesincomputationalgametheory.Thispaperfocusesonzero-sumgameswhereateamofplayersfacesanopponent asisthecase forexample inBridge collusioninpoker andmanynon-recreationalapplicationssuchaswar wherethecolludersdonothavetimeormeansofcom-municatingduringbattle collusioninbidding wherecommunicationduringtheauctionisillegal andcoordinatedswindlinginpublic.Thepossibilityfortheteammemberstocommunicatebeforegameplay—thatis coordinatetheirstrategiesexante—makestheuseofbehavioralstrategiesunsatisfactory.Thereasonsforthisarecloselyrelatedtothefactthattheteamcanberepresentedasasingleplayerwithimperfectrecall.Weproposeanewgamerepresentation therealizationform thatgeneralizesthesequenceformbutcanalsobeappliedtoimperfect-recallgames.Then weuseittoderiveanauxiliarygamethatisequivalenttotheoriginalone.Itprovidesasoundwaytomaptheproblemofﬁndinganoptimalex-ante-coordinatedstrategyfortheteamtothewell-understoodNashequilibrium-ﬁndingproblemina(larger)two-playerzero-sumperfect-recallgame.Byreasoningovertheauxiliarygame wedeviseananytimealgorithm ﬁctitiousteam-play thatisguaranteedtoconvergetoanoptimalcoordinatedstrategyfortheteamagainstanoptimalopponent andthatisdramaticallyfasterthanthepriorstate-of-the-artalgorithmforthisproblem.1IntroductionInrecentyears computationalstudiesonimperfect-informationgameshavelargelyfocusedontwo-playerzero-sumgames.Inthatsetting AItechniqueshaveachievedremarkableresults suchasdefeatingtophumanspecialistprofessionalsinheads-upno-limitTexashold’empoker[4 5].Fewerresultsareknownforsettingswithmorethantwoplayers.Yet manystrategicinteractionsprovideplayerswithincentivestoteamup.Insomecases playersmayhaveasimilargoalandmaybewillingtocoordinateandsharetheirﬁnalreward.Consider asanillustration thecaseofapoker∗Equalcontribution.32ndConferenceonNeuralInformationProcessingSystems(NeurIPS2018) Montr´eal Canada.gamewiththreeormoreplayers whereallbutoneofthemcolludeagainstanidentiﬁedtargetplayerandwillsharethewinningsafterthegame.Inothersettings playersmightbeforcedtocooperatebythenatureoftheinteractionitself.Thisisthecase forinstance inthecard-playingphaseofBridge whereateamoftwoplayers calledthe“defenders” playsagainstathirdplayer the“declarer”.Situationsofateamganginguponaplayerare ofcourse ubiquitousinmanynon-recreationalapplicationsaswell suchaswarwherethecolludersdonothavetimeormeansofcommunicatingduringbattle collusioninbiddingwherecommunicationduringtheauctionisillegal coordinatedswindlinginpublic andsoon.Thebeneﬁtsfromcoordination/collusiondependonthecommunicationpossibilitiesamongteammembers.Inthispaper weareinterestedinexantecoordination wheretheteammembershaveanopportunitytodiscussandagreeontacticsbeforethegamestarts butwillbeunabletocommunicateduringthegame exceptthroughtheirpublicly-observedactions.2Theteamfacesanopponentinazero-sumgame(asin forexample multi-playerpokerwithcollusionandBridge).Evenwithoutcommunicationduringthegame theplanningphasegivestheteammembersanad-vantage:forinstance theteammemberscouldskewtheirstrategiestousecertainactionstosignalabouttheirstate(forexample thattheyhaveparticularcards).Inotherwords byhavingagreedoneachmember’splannedreactionunderanypossiblecircumstanceofthegame informationcanbesilentlypropagatedintheclear bysimplyobservingpublicinformation.Exantecoordinationcanenabletheteammemberstoobtainsigniﬁcantlyhigherutility(uptoafactorlinearinthenumberofthegame-treeleaves)thantheutilitytheywouldobtainbyabstainingfromcoordination[1 6 25].FindinganequilibriumwithexantecoordinationisNP-hardandinapproximable[1 6].Theonlyknownalgorithmisbasedonahybridrepresentationofthegame whereteammembersplayjointnormal-formactionswhiletheadversaryemployssequence-formstrategies[6].Wewilldevelopdramaticallyfasteralgorithmsinthispaper.Ateamthatexantecoordinatescanbemodeledasasinglemeta-player.Thismeta-playertypicallyhasimperfectrecall giventhattheteammembersobservedifferentaspectsoftheplay(opponent’smoves eachothers’moves andchance’smoves)andcannotcommunicateduringthegame.Then solvingthegameamountstocomputingaNashequilibrium(NE)innormal-formstrategiesinatwo-playerzero-sumimperfect-recallgame.Thefocusonnormal-formstrategiesiscrucial.Indeed itisknownthatbehavioralstrategies thatprovideacompactrepresentationoftheplayers’strategies cannotbeemployedinimperfect-recallgameswithoutincurringalossofexpressiveness[18].Someimperfect-recallgamesdonotevenhaveanyNEinbehavioralstrategies[27].EvenwhenaNEinbehavioralstrategiesexists itsvaluecanbeuptoalinearfactor(inthenumberofthegame-treeleaves)worsethanthatofaNEinnormal-formstrategies.Forthesereasons recentefﬁcienttechniquesforapproximatingmaxminbehavioralstrategyproﬁlesinimperfect-recallgames[9 7]arenotapplicabletoourdomain.Maincontributionsofthispaper.Ourﬁrstcontributionisanewgamerepresentation whichwecalltherealizationform.Inperfect-recallgamesitessentiallycoincideswiththesequenceform but unlikethesequenceform itcanalsobeusedinimperfect-recallgames.Byexploitingtherealizationform weproduceatwo-playerauxiliarygamethathasperfectrecall andisequivalenttothenormalformoftheoriginalgame butsigniﬁcantlymoreconcise.Furthermore weproposeananytimealgorithm ﬁctitiousteam-play whichisavariationofﬁctitiousplay[2].Itisguaranteedtoconvergetoanoptimalsolutioninthesettingwheretheteammemberscoordinateexante.Experimentsshowthatitisdramaticallyfasterthanthepriorstate-of-the-artalgorithmforthisproblem.2PreliminariesInthissectionweprovideabriefoverviewofextensive-formgames(seealsothetextbookbyShohamandLeyton-Brown[20]).Anextensive-formgameΓhasaﬁnitesetPofplayersandaﬁnitesetofactionsA.Histhesetofallpossiblenodes describedassequencesofactions(histo-ries).A(h)isthesetofactionsavailableatnodeh.Ifa∈A(h)leadstoh0 wewriteha=h0.2Thiskindofcoordinationhassometimesbeenreferredtoasexantecorrelationamongteammembers[6].However wewillnotusethattermbecausethissettingisquitedifferentthantheusualnotionofcorrelationingametheory.Intheusualcorrelationsetting theindividualplayershavetobeincentivizedtofollowtherecommendationsofthecorrelationdevice.Incontrast herethereisnoneedforsuchincentivesbecausethemembersoftheteamcansharethebeneﬁtsfromcoordination.2P(h)∈P∪{c}istheplayerwhoactsath wherecdenoteschance.Hiisthesetofdecisionnodeswhereplayeriacts.Zisthesetofterminalnodes.Foreachplayeri∈P thereisapayofffunctionui:Z→R.Anextensive-formgamewithimperfectinformationhasasetIofinformationsets.Decisionnodeswithinthesameinformationsetarenotdistinguishablefortheplayerwhoseturnitistomove.Bydeﬁnition foranyI∈I A(I)=A(h) forallh∈I.IiistheinformationpartitionofHi.Apurenormal-formplanforplayeriisatupleσ∈Σi=×I∈IiA(I)thatspeciﬁesanactionforeachinformationsetofthatplayer.σ(I)denotestheactionselectedinσatinformationsetI.Anormal-formstrategyxiforplayeriisdeﬁnedasxi:Σi→∆|Σi|.WedenotebyXithenormal-formstrategyspaceofplayeri.Abehavioralstrategyπi∈ΠiassociateseachI∈IiwithaprobabilityvectoroverA(I).πi(I a)denotestheprobabilitywithwhichichoosesactionaatI.πcisthestrategyofavirtualplayer “chance” whoplaysnon-strategicallyandisusedtorepresentexogenousstochasticity.Theexpectedpayoffofplayeri whensheplaysxiandtheopponentsplayx−i isdenoted withanoverloadofnotation byui(xi x−i).Denotebyρxii(z)theprobabilitywithwhichplayeriplaystoreachzwhenfollowingstrategyxi(ρπii(z)isdeﬁnedanalogously).Then ρx(z)=Qi∈P∪{c}ρxii(z)istheprobabilityofreachingzwhenplayersfollowbehavioralstrategyproﬁlex.Wesaythatxi x0iarerealizationequivalentif foranyx−iandforanyz∈Z ρx(z)=ρx0(z) wherex=(xi x−i) x0=(x0i x−i).Thesamedeﬁni-tionholdsforstrategiesindifferentrepresentations(e.g. behavioralandsequenceform).Similarly twostrategiesxi x0iarepayoffequivalentif ∀j∈Pand∀x−i uj(xi x−i)=uj(x0i x−i).Aplayerhasperfectrecallifshehasperfectmemoryofherpastactionsandobservations.Formally ∀xi ∀I∈Ii ∀h h0∈I ρxii(h)=ρxii(h0).Γhasperfectrecallifeveryplayerhasperfectrecall.BR(x−i)denotesthebestresponseofplayeriagainstastrategyproﬁlex−i.Abestresponseisastrategysuchthatui(BR(x−i) x−i)=maxxi∈Xiui(xi x−i).ANE[17]isastrategyproﬁleinwhichnoplayercanimproveherutilitybyunilaterallydeviatingfromherstrategy.Therefore foreachplayeri aNEx∗=(x∗i x∗−i)satisﬁesui(x∗i x∗−i)=ui(BR(x∗−i) x∗−i).Thesequenceform[12 23]ofagameisacompactrepresentationapplicableonlytogameswithperfectrecall.Itdecomposesstrategiesintosequencesofactionsandtheirrealizationprobabilities.Asequenceqi∈Qiforplayeri deﬁnedbyanodeh isatuplespecifyingplayeri’sactionsonthepathfromtheroottoh.Asequenceissaidterminalif togetherwithsomesequencesoftheotherplayers leadstoaterminalnode.q∅denotestheﬁctitioussequenceleadingtotherootnodeandqaistheextendedsequenceobtainedbyappendingactionatoq.Asequence-formstrategyforplayeriisafunctionri:Qi→[0 1] s.t.ri(q∅)=1and foreachI∈IiandsequenceqleadingtoI −ri(q)+Pa∈A(I)ri(qa)=0.3Team-maxminequilibriumwithcoordinationdevice(TMECor)Inthesettingofexantecoordination teammembershavetheopportunitytodiscusstacticsbeforethegamebegins butareotherwiseunabletocommunicateduringthegame exceptviapublicly-observedactions.Apowerful game-theoreticwaytothinkaboutexantecoordinationisthroughacoordinationdevice.Intheplanningphasebeforethegamestarts theteammembersidentifyasetofjointpurenormal-formplans.Then justbeforetheplay thecoordinationdevicewillrandomlydrawoneofthenormal-formplansfromagivenprobabilitydistribution andtheteammemberswillallactasspeciﬁedintheselectedplan.ANEwhereteammembersplayexantecoordinatednormal-formstrategiesiscalledateam-maxminequilibriumwithcoordinationdevice(TMECor)[6].3Inanapproximateversion -TMECor neithertheteamnortheopponentcangainmorethanbydeviatingfromtheirstrategy assumingthattheotherdoesnotdeviate.BysamplingarecommendationfromajointprobabilitydistributionoverΣ1 Σ2 thecoordinationdeviceintroducesacorrelationbetweenthestrategiesoftheteammembersthatisotherwiseimpos-sibletocaptureusingbehavioralstrategies.Inotherwords ingeneralthereexistsnobehavioralstrategyfortheteamplayerthatisrealization-equivalenttothenormal-formstrategyinducedbythecoordinationdevice asthefollowingexamplefurtherillustrates.3Theyactuallycalleditcorrelation notcoordination.Asexplainedintheintroduction wewillusethetermcoordination.However wewillkeeptheiracronymTMECorinsteadofswitchingtotheacronymTMECoor.3Example1.Considerthezero-sumgameinFigure1.Twoteammembers(Players1and2)playagainstanadversaryA.Theteamobtainsacumulativepayoffof2whenthegameendsat1or8 andapayoffof0otherwise.Avalidexantecoordinationdeviceisasfollows:theteammemberstossanunbiasedcoin;ifheadscomesup Player1willplayactionAandPlayer2willplayactionC;otherwise Player1willplayactionBandPlayer2willplayactionD.Therealizationinducedontheleavesissuchthatρ(1)=ρ(8)=1/2andρ(i)=0fori6∈{1 8}.Nobehavioralstrategyfortheteammembersisabletoinducethesamerealization.ThiscoordinationdeviceisenoughtoovercometheimperfectinformationofPlayer2aboutPlayer1’smove asPlayer2knowswhatactionwillbeplayedbyPlayer1eventhoughPlayer2willnotobserveitduringthegame.A1C2DA3C4DB‘5C6DA7C8DBrPlayer2Player1Figure1:Exampleofextensive-formgamewithateam.Theuppercaselettersdenotetheactionnames.Thecirclednumbersuniquelyidentifytheterminalnodes.APlayer11E2FA3E4FB‘Player15E6FC7E8FDrPlayer2Figure2:Agamewherecoordinatedstrategieshaveaweaksignalingpower.Theuppercaselettersde-notetheactionnames.Thecirclednumbersuniquelyidentifytheterminalnodes.Onemightwonderwhetherthereisvalueinforcingthecoordinationdevicetoonlyinducenormal-formstrategiesforwhicharealization-equivalenttupleofbehavioralstrategies(oneforeachteammember)exists.Indeed undersucharestriction theproblemofconstructinganoptimalcoordina-tiondevicewouldamounttoﬁndingtheoptimaltupleofbehavioralstrategies(oneforeachteammember)thatmaximizestheteam’sutility.Thissolutionconceptisknownasteam-maxminequilib-rium(TME)[25].TMEoffersconceptualsimplicitythatunfortunatelycomesatahighcost.First ﬁndingthebesttupleofbehavioralstrategiesisanon-linear non-convexoptimizationproblem.Moreover restrictingtoTMEsisalsoundesirableintermsofﬁnalutilityfortheteam sinceitmayincurinanarbitrarilylargelosscomparedtoaTMECor[6].Interestingly aswewillproveinSection4.2 thereisastrongconnectionbetweenTMEandTMECor.Thelattersolutionconceptcanbeseenasthenatural“convexiﬁcation”oftheformer inasensethatwewillmakepreciseinTheorem2.4Realizationform:auniversal low-dimensionalgamerepresentationInthissection weintroducetherealizationformofagame whichenablesonetorepresentthestrategyspaceofaplayerbyanumberofvariablesthatislinearinthegamesize(asopposedtoexponentialasinthenormalform) eveningameswithimperfectrecall.Foreachplayeri arealization-formstrategyisavectorthatspeciﬁestheprobabilitywithwhichiplaystoreachthedifferentterminalnodes.Themappingfromnormal-formstrategiestorealization-formstrategiesallowsustocompresstheactionspacefromXi whichhasasmanycoordinatesasthenumberofnormal-formplans—usuallyexponentialinthesizeofthetree—toaspacethathasonecoordinateforeachterminalnode.Thismappingismany-to-onebecauseoftheredundanciesinthenormal-formrepresentation.Givenarealization-formstrategy allthenormal-formstrategiesthatinduceitarepayoffequivalent.Theconstructionoftherealizationformreliesonthefollowingobservation.Observation1.LetΓbeagameandz∈Zbeaterminalnode.Givenanormal-formstrategyproﬁlex=(x1 ... xn)∈X1×···×Xn theprobabilityofreachingzcanbeuniquelydecomposedastheproductofthecontributionsofeachindividualplayer pluschance’scontribution.Formally ρx(z)=ρxccQi∈Pρxii(z).Deﬁnition1(Realizationfunction).LetΓbeagame.Therealizationfunctionofplayeri∈PisthefunctionfΓi:Xi→[0 1]|Z|thatmapseverynormal-formstrategyforplayeritothecorrespondingvectorofrealizationsforeachterminalnode:fΓi:Xi3x7→(ρxi(z1) ... ρxi(z|Z|)).WeareinterestedintherangeoffΓi calledtherealizationpolytopeofplayeri.4Deﬁnition2(Realizationpolytopeandstrategies).Playeri’srealizationpolytopeΩΓiingameΓistherangeoffΓi thatisthesetofallpossiblerealizationvectorsforplayeri:ΩΓi:=fΓi(Xi).Wecallanelementωi∈ΩΓiarealization-formstrategy(or simply realization)ofplayeri.Thefunctionthatmapsatupleofrealization-formstrategies oneforeachplayer tothepayoffofeachplayer ismultilinear.ThisisbyconstructionandfollowsfromObservation1.Moreover therealizationfunctionhasthefollowingstrongproperty(allproofsareprovidedinAppendixB).Lemma1.fΓiisalinearfunctionandΩΓiisaconvexpolytope.Forplayerswithperfectrecall therealizationformistheprojectionofthesequenceform wherevariablesrelatedtonon-terminalsequencesaredropped.Inotherwords whentheperfect-recallpropertyissatisﬁed itispossibletomovebetweenthesequence-formandtherealization-formrepresentationsbymeansofasimplelineartransformation.Therefore therealizationpolytopeofperfect-recallgamescanbedescribedwithalinearnumber(inthegamesize)oflinearconstraints.Conversely ingameswithimperfectrecallthenumberofconstraintsrequiredtodescribetherealiza-tionpolytopemaybeexponential4.Akeyfeatureoftherealizationformisthatitcanbeappliedtobothsettingswithoutanymodiﬁcation.Forexample anoptimalNEinatwo-playerzero-sumgame withorwithoutperfectrecalland/orinformation canbecomputedthroughthebilinearsaddle-pointproblemmaxω1∈ΩΓ1minω2∈ΩΓ1ω>1Uω2 whereUisa(diagonal)|Z|×|Z|payoffmatrix.Finally therealizationformofagameisformallydeﬁnedasfollows.Deﬁnition3(Realizationform).Givenanextensive-formgameΓ itsrealizationformisatuple(P Z U ΩΓ) whereΩΓspeciﬁesarealizationpolytopeforeachi∈P.4.1TwoexamplesofrealizationpolytopesToillustratetherealization-formconstruction weconsidertwothree-playerzero-sumextensive-formgameswithperfectrecall whereateamcomposedoftwoplayersplayingagainstthethirdplayer.Asalreadyobserved sincetheteammemberhavethesameincentives theteamasawholebehavesasasinglemeta-playerwith(potentially)imperfectrecall.AsweshowinExample2 ex-antecoordinationallowsteammemberstobehaveasasingleplayerwithperfectrecall.Incontrast inExample3 thesignalingpowerofexantecoordinatedstrategiesisnotenoughtofullyrevealprivateteammembers’information.Example2.ConsiderthegamedepictedinFigure1.XTisthe4-dimensionalsimplexcorre-spondingtothespaceofprobabilitydistributionsoverthesetofpurenormal-formplansΣT={AC AD BC BD}.Givenx∈XT theprobabilitywithwhichTplaystoreachacertainout-comeisthesumofeveryx(σ)suchthatplanσ∈ΣTisconsistentwiththeoutcome(i.e. theoutcomeisreachableifTplaysσ).Intheexample wehave:fT(x)=(x(A C) x(A D) x(B C) x(B D) x(A C) x(A D) x(B C) x(B D)) whereoutcomesareorderedfromlefttorightinthetree.Then therealizationpolytopeisdescribedbyPolytope1.TheseconstraintsshowthatPlayerThasperfectrecallwhenemployingcoordinatedstrategies.Indeed theconstraintscoincideswiththesequence-formconstraintsobtainedwhensplittingPlayer2’sinformationsetintotwoinformationsets oneforeachaction{A B}.Example3.InthegameinFigure2 theteamPlayerThasimperfectrecallevenwhencoordinationisallowed.Inthiscase thesignalingpowerofexantecoordinatedstrategiesisnotenoughforPlayer1topropagatetheinformationobserved(thatis A’smove)toPlayer2.ItcanbeveriﬁedthattherealizationpolytopeΩΓTischaracterizedbythesetofconstraintsinPolytope2(seeAppendixAformoredetails).Asonemightexpect thispolytopecontainsPolytope1.4.2Relationshipwithteammax-minequilibriumInthissubsectionwestudytherelationshipwithteammax-minequilibrium andproveafactofpotentialindependentinterest.Thissubsectionisnotneededforunderstandingtherestofthepaper.Weprovethattherealizationpolytopeofanon-absent-mindedplayeristheconvexhullofthesetofrealizationsthatarereachablestartingfrombehavioralstrategies.ThisgivesaprecisemeaningtoourclaimthattheTMECorconceptistheconvexiﬁcationoftheTMEconcept.4Understandinginwhichsubclassesofimperfect-recallgamesthenumberofconstraintsremainspolyno-mialisaninterestingopenproblem.5ω(5)+ω(6)+ω(7)+ω(8)=1 ω(2)=ω(6) ω(4)=ω(8) ω(1)=ω(5) ω(3)=ω(7) ω(i)≥0i∈{1 2 3 4 5 6 7 8}.Polytope1:DescriptionoftherealizationpolytopeforthegameofFigure1.ω(5)+ω(6)+ω(7)+ω(8)=1 ω(2)+ω(4)=ω(6)+ω(8) ω(1)+ω(3)=ω(5)+ω(7) ω(i)≥0i∈{1 2 3 4 5 6 7 8}.Polytope2:DescriptionoftherealizationpolytopeforthegameofFigure2.Deﬁnition4.LetΓbeagame.Thebehavioral-realizationfunctionofplayeriisthefunction˜fΓi:Πi3π7→(ρπi(z1) ... ρπi(z|Z|))∈[0 1]|Z|.Accordingly thebehavioral-realizationsetofplayeriistherangeof˜fΓi thatis˜ΩΓi:=˜fΓi(Πi).Thissetisgenerallynon-convex.Denotingbyco(·)theconvexhullofaset wehavethefollowing:Theorem2.ConsideragameΓ.Ifplayeriisnotabsent-minded thenΩΓi=co(cid:0)˜ΩΓi(cid:1).5Auxiliarygame:anequivalentgamethatenablestheuseofbehavioralstrategiesIntherestofthispaper wefocusonthree-playerzero-sumextensive-formgameswithperfectrecall andwewillmodeltheinteractionofateamcomposedoftwoplayersplayingagainstthethirdplayer.Thetheorydevelopedalsoappliestosettingswithteamswithanarbitrarynumberofplayers.Weprovethatitispossibletoconstructanauxiliarygamewiththefollowingproperties:•itisatwo-playerperfect-recallgamebetweentheadversaryAandateam-playerT;•forbothplayers thesetofbehavioralstrategiesisas“expressive”asthesetofthenormal-formstrategiesintheoriginalgame(i.e. inthecaseoftheteam thesetofstrategiesthatteammemberscanachievethroughexantecoordination).Toaccomplishthis weintroducearootnodeφ whosebranchescorrespondtothenormal-formstrategiesoftheﬁrstplayeroftheteam.Thisrepresentationenablestheteamtoexpressanyprob-abilitydistributionovertheensuingsubtrees andleadstoanequivalencebetweenthebehavioralstrategiesinthisnewperfect-recallgame(theauxiliarygame)andthenormal-formstrategiesoftheoriginaltwo-playerimperfect-recallgamebetweentheteamandtheopponent.Theauxiliarygameisaperfect-recallrepresentationoftheoriginalimperfect-recallgamesuchthattheexpressivenessofbehavioral(andsequence-form)strategiesisincreasedtomatchtheexpressivenessofnormal-formstrategiesintheoriginalgame.ConsideragenericΓwithP={1 2 A} where1and2areteammembers.WewillrefertoPlayer1asthepivotplayer.Foranyσ1∈Σ1 wedeﬁneΓσ1asthetwo-playergamewithP={2 A}thatweobtainfromΓbyﬁxingthechoicesofPlayer1asfollows:∀I∈I1and∀a∈A(I) ifa=σ1(I) thenπ1 σ1(I a)=1;otherwise π1 σ1(I a)=0.Onceπ1 σ1hasbeenﬁxedinΓσ1 decisionnodesbelongingtoPlayer1canbeconsideredasiftheywerechancenodes.TheauxiliarygameofΓ denotedwithΓ∗ isdeﬁnedasfollows.Deﬁnition5(AuxiliaryGame).TheauxiliarygameΓ∗isatwo-playergameobtainedfromΓinthefollowingway:•P={T A};•therootφisadecisionnodeofPlayerTwithA(φ)={aσ}σ∈Σ1;•eachaσisfollowedbyasubtreeΓσ;•AdoesnotobservetheactionchosenbyTatφ.φaσ·········ΓσFigure3:StructureoftheauxiliarygameΓ∗.Byconstruction allthedecisionnodesofanyinformationsetofteamTarepartofthesamesubtreeΓσ.Intuitively thisisbecause intheoriginalgame teammembersjointlypickanactionfromtheirjointprobabilitydistributionand therefore everyteammemberknowswhattheothermemberisgoingtoplay.TheopponenthasthesamenumberofinformationsetsbothinΓandΓ∗.Thisisbecauseshedoesnotobservethechoiceatφand therefore herinformationsetsspanacrossallsubtreesΓσ.ThebasicstructureoftheauxiliarygametreeisdepictedinFigure3(informationsetsofAareomittedforclarity).Gameswithmorethantwoteammemberscanberepresentedthough6aΓ∗whichhasanumberofsubtreesequaltotheCartesianproductofthenormal-formplansofallteammembersexceptone.ThenextlemmaisfundamentaltounderstandtheequivalencebetweenbehavioralstrategiesofΓ∗andnormal-formstrategiesofΓ.Intuitively itjustiﬁestheintroductionoftherootnodeφ whosebranchescorrespondtothenormal-formstrategiesofthepivotplayer.ThisrepresentationenablestheteamTtoexpressanyconvexcombinationofrealizationsintheΓσsubtrees.Lemma3.ForanyΓ ΩΓT=co(cid:16)Sσ∈Σ1ΩΓσT(cid:17).ThefollowingtheoremfollowsfromLemma3andcharacterizestherelationshipbetweenΓandΓ∗.ItshowsthatthereisastrongconnectionbetweenthestrategiesofPlayerTintheauxiliarygameandtheexantecoordinatedstrategiesfortheteammembersintheoriginalgameΓ.Theorem4.GamesΓandΓ∗arerealization-formequivalentinthefollowingsense:(i)Team.Givenanydistributionovertheactionsatthegametreerootφ(i.e. achoiceΣ13σ7→λσ≥0suchthatPσλσ=1)andanychoiceofrealizations{ωσ∈ΩΓσT}σ∈Σ1 wehavethatPσ∈Σ1λσωσ∈ΩΓT.Theconverseisalsotrue:givenanyω∈ΩΓT thereexistsachoiceof{λσ}σ∈Σ1andrealizations{ωσ∈ΩΓσT}σ∈Σ1suchthatω=Pσ∈Σ1λσωσ.(ii)Adversary.TherealizationpolytopeoftheadversarysatisﬁesΩΓA=ΩΓ∗A.ThefollowingisthenadirectconsequenceofTheorem4Corollary1.ThesetofpayoffsreachableinΓcoincideswiththesetofpayoffsreachableinΓ∗.Speciﬁcally anystrategy{λσ}σ∈Σ1 {ωσ}σ∈Σ1overΓ∗ispayoff-equivalenttotherealization-formstrategyω=Pσ∈Σ1λσωσinΓ.Remark1.SinceΓσhasperfectrecall everyrealizationωσ∈ΩΓσcanbeinducedbyTviabehavioralstrategies.TheaboveshowsthatforeveryexantecoordinatedstrategyfortheteaminΓ thereexistsacor-responding(payoff-equivalent)behavioralstrategyforTinΓ∗ andviceversa.Hence duetorealization-formequivalencebetweenΓandΓ∗ ﬁndingaTMECorinΓ(employingexanteco-ordinatednormal-formstrategies) isequivalenttoﬁndingaNEinΓ∗(withbehavioralstrategies).6Fictitiousteam-play:ananytimealgorithmforTMECorThissectionintroducesananytimealgorithm ﬁctitiousteam-play forﬁndingaTMECor.ItfollowsfromtheprevioussectionthatinordertoﬁndaTMECorinΓ itsufﬁcestoﬁndatwo-playerNEintheauxiliarygameΓ∗(andviceversa althoughwedonotusethisseconddirection).Further-more sinceΓ∗isatwo-playerperfect-recallzero-sumgame theﬁctitiousplay(FP)algorithmcanbeappliedwithitstheoreticalguaranteeofconvergingtoaNE.Fictitiousplay[2 19]isanitera-tivealgorithmoriginallydescribedfornormal-formgames.Itkeepstrackofaveragenormal-formstrategies¯xi whichareoutputintheend andtheyconvergetoaNE.Atiterationt playericom-putesthebestresponseagainsttheopponent’sempiricaldistributionofplayuptotimet−1 thatis xti=BR(¯xt−1−i).Thenheraveragestrategyisupdatedas¯xti=t−1t¯xt−1i+1txti.Conceptually ourﬁctitiousteam-playalgorithmcoincideswithFPappliedtotheauxiliarygameΓ∗.However inordertoavoidtheexponentialsizeofΓ∗ ourﬁctitiousteam-playalgorithmdoesnotexplicitlyworkontheauxiliarygame.Rather itencodesthebest-responseproblemsbymeansofmixedintegerlinearprograms(MILPs)ontheoriginalgameΓ.Themainalgorithm.ThepseudocodeofthemainalgorithmisgivenasAlgorithm1 whereBRA(·)andBRT(·)arethesubroutinesforsolvingthebest-responseproblems.Ouralgorithmemploysrealization-formstrategies.Thisallowsforasigniﬁcantlymoreintuitivewayofperformingaveraging(Steps7 8 10)thanwhatisdoneinfull-widthextensive-formﬁctitiousplay[11] whichemploysbehavioralstrategies.Ouralgorithmmaintainsanaveragerealization¯ωAfortheadversary.Moreover the|Σ1|-dimensionalvector¯λkeepstheempiricalfrequenciesofactionsatnodeφinauxiliarygameΓ∗(seeFigure3).Finally ∀σ∈Σ1 ¯ωT σ∈ΩΓσTistheaveragerealizationoftheteaminthesubtreeΓσ.7Algorithm1Fictitiousteam-play1:functionFICTITIOUSTEAMPLAY(Γ)2:Initialize¯ωA3:¯λ←(0 ... 0) t←14:¯ωT σ←(0 ... 0)∀σ∈Σ15:whilewithincomputationalbudgetdo6:(σt ωtT)←BRT(¯ωA)7:¯λ←(1−1t)¯λ+1t1σt8:¯ωT σt←(1−1t)¯ωT σt+1tωtT9:ωtA←BRA(¯λ {¯ωT σ}σ)10:¯ωA←(1−1t)¯ωA+1tωtA11:t←t+112:return(¯λ (¯ωT σ)σ∈Σ1)Aftertiterationsofthealgorithm onlytpairsofstrategiesaregenerated.Hence anoptimizedimplementationofthealgorithmcanemployalazydatastructuretokeeptrackofthechangesto¯λand¯ωT σ.Initially(Step2) theaveragerealization¯ωAoftheadver-saryissettotherealization-formstrategyequivalenttoauniformbehavioralstrategyproﬁle.Ateachiterationthealgorithmﬁrstcomputesateam’sbest-responseagainst¯ωA.Werequirethatthechosenbestresponseassignprob-ability1tooneoftheavailableactions(say aσt)atnodeφ.(Apure—thatis non-randomized—bestresponseal-waysexistsand therefore inparticulartherealwaysexistsatleastonebestresponseselectingasingleactionattherootwithprobabilityone.)Then theaver-agefrequenciesandteam’srealizationsareupdatedonthebasisoftheobserved(σt ωtT).Finally theadversary’sbestresponseωtAagainsttheupdatedaveragestrategyoftheteamiscomputed andtheempiricaldistributionofplayoftheadversaryisupdated.Theexantecoordinatedstrategyproﬁlefortheteamisimplicitlyrepresentedbythepair(¯λ ¯ωT σ).Inparticular thatpairencodesacoordinationdevicethatoperatesasfollows:•Atthebeginningofthegame apurenormal-formplan˜σ∈Σissampledaccordingtothediscreteprobabilitydistributionencodedby¯λ.Player1willplaythegameaccordingtothesampledplan.•Player2willplayaccordingtoanynormal-formstrategyinf−12(¯ωT ˜σ) thatis anynormal-formstrategywhoserealizationis¯ωT ˜σ.Thecorrectnessofthealgorithmthenisadirectconsequenceofrealization-equivalencebetweenΓandΓ∗ whichwasshowninTheorem4.Inparticular thestrategyoftheteamconvergestoaproﬁlethatispartofanormal-formNEintheoriginalgameΓ.Best-responsesubroutines.Theproblemofﬁndingtheadversary’sbestresponsetoapairofstrate-giesoftheteam namelyBRA(¯λ {¯ωT σ}σ) canbeefﬁcientlytackledbyworkingonΓ(secondpointofTheorem4).Incontrast theproblemofcomputingBRT(¯ωA)isNP-hard[24] andinapprox-imable[6].CelliandGatti[6]proposeaMILPformulationtosolvetheteambest-responseproblem.InAppendixEweproposeanalternativeMILPformulationinwhichthenumberofbinaryvariablesispolynomialinΓandproportionaltothenumberofsequencesofthepivotplayer.Inouralgorithm weemployameta-oraclethatusessimultaneously asparallelprocesses bothsubroutines andstopsthemassoonasoneofthetwohasfoundasolutionor inthecaseatime-limitisreached itstopsbothsubroutinesanditreturnsthebestsolution(intermsofteam’sutility).ThiscircumventstheneedtoproveoptimalityintheMILP whichoftentakesmostoftheMILP-solvingtime andopensthedoorstoheuristicMILP-solvingtechniques.Oneofthekeyfeaturesofthemeta-oracleisthatitsperformancesarenotimpactedbythesizeofΓ∗ whichisneverexplicitlyemployedinthebest-responsescomputation.7ExperimentsWeconductedexperimentsonthree-playerKuhnpokergamesandthree-playerLeduchold’empokergames.Thesearestandardgamesinthecomputationalgametheoryliterature anddescriptionofthemcanbefoundinAppendixF.Ourinstancesareparametricinthenumberofranksinthedeck.TheinstancesadoptedarelistedinTables1and2 whereKrandLrdenote respectively aKuhninstancewithrranksandaLeducinstancewithrranks(i.e. 3rtotalcards).Table1alsodisplaystheinstances’dimensionsintermsofthenumberofinformationsetsperplayerandthenumberofsequences(i.e. numberofinformationset–actionpairs)perplayer aswellasthepayoffdispersion∆u—thatis thedifferencebetweenthemaximumandminimumattainableteamutility.Fictitiousteam-play.Weinstantiatedﬁctitiousteam-playwiththemeta-oraclepreviouslydis-cussed whichreturnsthebestsolutionfoundbytheMILPoracleswithinthetimelimit.Weleteachbest-responseformulationrunontheGurobi8.0MILPsolver withatimelimitof15secondsand5000maximumiterations.Ouralgorithmisananytimealgorithm soitdoesnotrequireatargetaccuracyfor-TMECortobespeciﬁedinadvance.Table1showstheany-8GameTreesize∆uFictitiousteam-playHCGInf.Seq.10%5%2%1.5%1%0.5%K3251360s0s0s1s1s1s0sK4331761s1s4s4s30s1m12s9sK5412161s2s44s1m4m15s8m57s1m58sK6492561s12s43s5m15s8m30s23m32s25m26sK7572964s17s2m15s5m46s6m31s23m49s2h50mL34572292115s1m14m05s30m40s1h34m30s>24hoomL4801401211s1m31s11m8s51m5s6h51m>24hoomTable1:Comparisonbetweentheruntimesofﬁctitiousteam-play(forvariouslevelsofaccuracy)andthehybridcolumngeneration(HCG)algorithm.(oom:outofmemory.)GameTeamUtilityAdv1Adv2Adv3K30.00000.00000.0003K40.04050.0259-0.0446K50.04340.0156-0.0282K60.05140.0271-0.0253K70.05920.0285-0.0259L30.23320.20890.1475L40.19910.1419-0.0223Table2:Valuesoftheaver-agestrategyproﬁlefordif-ferentchoicesofadversary.timeperformance thatis thetimeittooktoreachanα∆u-TMECorfordifferentaccuraciesα∈{10% 5% 2% 1.5% 1% 0.5%}.ResultsinTable1assumethattheteamconsistsoftheﬁrstandthirdmoverinthegame;theopponentisthesecondmover.Table2showsthevalueoftheaveragestrategycomputedbyﬁctitiousteam-playfordifferentchoicesoftheopponentplayer.Thisvaluecorrespondstotheexpectedutilityoftheteamfortheaveragestrategyproﬁle(¯λ ¯ωT σ)atit-eration1000.InAppendixF.3weshowtheminimumcumulativeutilitythattheteamisguaranteedtoachieve thatis−BRA(¯λ {¯ωT σ}σ).Hybridcolumngenerationbenchmark.Wecomparedagainstthehybridcolumngeneration(HCG)algorithm[6] whichistheonlyprioralgorithmforthisproblem.Tomakethecompari-sonfair weinstantiateHCGwiththesamemeta-oraclediscussedintheprevioussection.WeagainuseGurobi8.0MILPsolvertosolvethebestresponseproblemfortheteam.However inthecaseofHCG notimelimitcanbesetonGurobiwithoutinvalidatingthetheoreticalconvergenceguaranteeofthealgorithm.Thisisadrawback asitpreventsHCGfromrunninginananytimefashion de-spitecolumngenerationotherwisebeingananytimealgorithm.IntheLeducpokerinstances HCGexceededthememorybudget(40GB).Ourexperimentsshowthatﬁctitiousteam-playscalestosigniﬁcantlylargergamesthanHCG.Inter-estingly inalmostallthegames thevalueoftheteamwasnon-negative:bycolluding theteamwasabletoachievevictory.Moreover inAppendixF.4 weshowthataTMECorprovidestotheteamasubstantialpayoffincreaseoverthesettingwhereteammembersplayinbehavioralstrategies.8ConclusionsandfutureresearchThestudyofalgorithmsformulti-playergamesischallenging.Inthispaper weproposedanalgo-rithmforsettingsinwhichateamofplayersfacesanadversaryandtheteammemberscanexploitonlyexantecoordination discussingandagreeingontacticsbeforethegamestarts.Ourﬁrstcon-tributionwastherealizationform anovelrepresentationthatallowsustorepresentthestrategiesofthenormalformmoreconcisely.Therealizationformisalsoapplicabletoimperfect-recallgames.Weusedittoderiveatwo-playerperfect-recallauxiliarygamethatisequivalenttotheoriginalgame andprovidesatheoreticallysoundwaytomaptheproblemofﬁndinganoptimalex-ante-coordinatedstrategyfortheteamtoaclassicalwell-understoodNashequilibrium-ﬁndingprobleminatwo-playerzero-sumperfect-recallgame.Oursecondcontributionwasthedesignoftheﬁc-titiousteam-playalgorithm whichemploysanovelbest-responsemeta-oracle.Theanytimealgo-rithmisguaranteedtoconvergetoanequilibrium.Ourexperimentsshowedthatﬁctitiousteam-playisdramaticallyfasterthantheprioralgorithmsforthisproblem.Inthefuture itwouldbeinterestingtoadaptotherpopularequilibriumcomputationtechniquesfromthetwo-playersetting(suchasCFR)foroursetting byreasoningovertheauxiliarygame.Thestudyofalgorithmsforteamgamescouldshedfurtherlightonhowtodealwithimperfect-recallgames thatarereceivingincreasingattentioninthecommunityduetotheapplicationofimperfect-recallabstractionstothecomputationofstrategiesforlargeextensive-formgames[26 14 10 3 8 13].Acknowledgments.ThismaterialisbasedonworksupportedbytheNationalScienceFoundationundergrantsIIS-1718457 IIS-1617590 andCCF-1733556 andtheAROunderawardW911NF-17-1-0082.9References[1]N.Basilico A.Celli G.DeNittis andN.Gatti.Team-maxminequilibrium:efﬁciencyboundsandalgorithms.InAAAIConferenceonArtiﬁcialIntelligence(AAAI) pages356–362 2017.[2]G.W.Brown.Iterativesolutionofgamesbyﬁctitiousplay.Activityanalysisofproductionandallocation 13(1):374–376 1951.[3]N.Brown S.Ganzfried andT.Sandholm.Hierarchicalabstraction distributedequilibriumcomputation andpost-processing withapplicationtoachampionno-limitTexasHold’emagent.InInternationalConferenceonAutonomousAgentsandMulti-AgentSystems(AAMAS) 2015.[4]N.BrownandT.Sandholm.Safeandnestedsubgamesolvingforimperfect-informationgames.InAdvancesinNeuralInformationProcessingSystems(NIPS) pages689–699 2017.[5]N.BrownandT.Sandholm.SuperhumanAIforheads-upno-limitpoker:Libratusbeatstopprofessionals.Science pageeaao1733 2017.[6]A.CelliandN.Gatti.Computationalresultsforextensive-formadversarialteamgames.InAAAIConferenceonArtiﬁcialIntelligence(AAAI) 2018.[7]J.ˇCerm´ak B.Boˇsansk`y K.Hor´ak V.Lis`y andM.Pˇechouˇcek.Approximatingmaxminstrategiesinimperfectrecallgamesusinga-lossrecallproperty.InternationalJournalofAp-proximateReasoning 93:290–326 2018.[8]J.ˇCerm´ak B.Boˇsansky andV.Lis´y.Analgorithmforconstructingandsolvingimperfectrecallabstractionsoflargeextensive-formgames.InProceedingsoftheInternationalJointConferenceonArtiﬁcialIntelligence(IJCAI) pages936–942 2017.[9]J.ˇCerm´ak B.Boˇsansk`y andM.Pˇechouˇcek.Combiningincrementalstrategygenerationandbranchandboundsearchforcomputingmaxminstrategiesinimperfectrecallgames.InInter-nationalConferenceonAutonomousAgentsandMulti-AgentSystems(AAMAS) pages902–910 2017.[10]S.GanzfriedandT.Sandholm.Potential-awareimperfect-recallabstractionwithearthmover’sdistanceinimperfect-informationgames.InAAAIConferenceonArtiﬁcialIntelligence(AAAI) 2014.[11]J.Heinrich M.Lanctot andD.Silver.Fictitiousself-playinextensive-formgames.InInter-nationalConferenceonMachineLearning(ICML) pages805–813 2015.[12]D.Koller N.Megiddo andB.VonStengel.Efﬁcientcomputationofequilibriaforextensivetwo-persongames.Gamesandeconomicbehavior 14(2):247–259 1996.[13]C.KroerandT.Sandholm.Imperfect-recallabstractionswithboundsingames.InProceedingsoftheACMConferenceonEconomicsandComputation(EC) 2016.[14]M.Lanctot R.Gibson N.Burch M.Zinkevich andM.Bowling.No-regretlearninginextensive-formgameswithimperfectrecall.InInternationalConferenceonMachineLearning(ICML) 2012.[15]M.Maschler S.Zamir E.Solan andM.Borns.GameTheory.CambridgeUniversityPress 2013.[16]H.B.McMahan G.J.Gordon andA.Blum.Planninginthepresenceofcostfunctionscontrolledbyanadversary.InInternationalConferenceonMachineLearning(ICML) pages536–543 2003.[17]J.Nash.Equilibriumpointsinn-persongames.ProceedingsoftheNationalAcademyofSciences 36:48–49 1950.[18]M.PiccioneandA.Rubinstein.Ontheinterpretationofdecisionproblemswithimperfectrecall.GamesandEconomicBehavior 20(1):3–24 1997.10[19]J.Robinson.Aniterativemethodofsolvingagame.Annalsofmathematics pages296–301 1951.[20]Y.ShohamandK.Leyton-Brown.Multiagentsystems:Algorithmic game-theoretic andlog-icalfoundations.CambridgeUniversityPress 2008.[21]F.Southey M.Bowling B.Larson C.Piccione N.Burch D.Billings andC.Rayner.Bayes’bluff:Opponentmodellinginpoker.InProceedingsofthe21stAnnualConferenceonUncer-taintyinArtiﬁcialIntelligence(UAI) July2005.[22]M.TawarmalaniandN.V.Sahinidis.Apolyhedralbranch-and-cutapproachtoglobalopti-mization.MathematicalProgramming 103:225–249 2005.[23]B.VonStengel.Efﬁcientcomputationofbehaviorstrategies.GamesandEconomicBehavior 14(2):220–246 1996.[24]B.vonStengelandF.Forges.Extensive-formcorrelatedequilibrium:Deﬁnitionandcompu-tationalcomplexity.MathematicsofOperationsResearch 33(4):1002–1022 2008.[25]B.vonStengelandD.Koller.Team-maxminequilibria.GamesandEconomicBehavior 21(1-2):309–321 1997.[26]K.Waugh M.Zinkevich M.Johanson M.Kan D.Schnizlein andM.Bowling.Apracti-caluseofimperfectrecall.InSymposiumonAbstraction ReformulationandApproximation(SARA) 2009.[27]P.C.Wichardt.ExistenceofNashequilibriainﬁniteextensiveformgameswithimperfectrecall:Acounterexample.GamesandEconomicBehavior 63(1):366–369 2008.11,Gabriele Farina
Andrea Celli
Nicola Gatti
Tuomas Sandholm
Farzin Haddadpour
Mohammad Mahdi Kamani
Mehrdad Mahdavi
Viveck Cadambe