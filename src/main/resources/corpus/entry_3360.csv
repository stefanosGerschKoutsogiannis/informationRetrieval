2017,Matrix Norm Estimation from a Few Entries,Singular values of a data in a matrix form provide insights on the structure of the data  the effective dimensionality  and the choice of hyper-parameters on higher-level data analysis tools. However  in many practical applications such as collaborative filtering and network analysis   we only get a partial observation. Under such scenarios  we consider the fundamental problem of recovering various spectral properties of the underlying matrix from a sampling of its entries. We propose a framework of first estimating the Schatten $k$-norms of a matrix for several values of $k$  and using these as surrogates for estimating spectral properties of interest  such as   the spectrum itself or the rank.  This paper focuses on the technical challenges in accurately estimating the Schatten norms from a sampling of a matrix. We introduce  a novel unbiased estimator based on counting small structures in a graph and provide  guarantees that match its empirical performances.  Our theoretical analysis shows that Schatten norms can be recovered accurately from strictly smaller number of samples compared to what is needed to recover the underlying low-rank matrix. Numerical experiments suggest that we significantly improve upon a competing approach of using matrix completion methods.,MatrixNormEstimationfromaFewEntriesAshishKhetanDepartmentofISEUniversityofIllinoisUrbana-Champaignkhetan2@illinois.eduSewoongOhDepartmentofISEUniversityofIllinoisUrbana-Champaignswoh@illinois.eduAbstractSingularvaluesofadatainamatrixformprovideinsightsonthestructureofthedata theeffectivedimensionality andthechoiceofhyper-parametersonhigher-leveldataanalysistools.However inmanypracticalapplicationssuchascollaborativeﬁlteringandnetworkanalysis weonlygetapartialobservation.Undersuchscenarios weconsiderthefundamentalproblemofrecoveringvariousspectralpropertiesoftheunderlyingmatrixfromasamplingofitsentries.WeproposeaframeworkofﬁrstestimatingtheSchattenk-normsofamatrixforseveralvaluesofk andusingtheseassurrogatesforestimatingspectralpropertiesofinterest suchasthespectrumitselfortherank.ThispaperfocusesonthetechnicalchallengesinaccuratelyestimatingtheSchattennormsfromasamplingofamatrix.Weintroduceanovelunbiasedestimatorbasedoncountingsmallstructuresinagraphandprovideguaranteesthatmatchitsempiricalperformances.OurtheoreticalanalysisshowsthatSchattennormscanberecoveredaccuratelyfromstrictlysmallernumberofsamplescomparedtowhatisneededtorecovertheunderlyinglow-rankmatrix.Numericalexperimentssuggestthatwesigniﬁcantlyimproveuponacompetingapproachofusingmatrixcompletionmethods.1IntroductionComputingandanalyzingthesetofsingularvaluesofadatainamatrixform whichiscalledthespectrum provideinsightsintothegeometryandtopologyofthedata.Suchaspectralanalysisisroutinelyaﬁrststepingeneraldataanalysiswiththegoalofcheckingifthereexistsalowerdimensionalsubspaceexplainingtheimportantaspectsofthedata whichitselfmightbehighdimensional.Concretely itisaﬁrststepindimensionalityreductionmethodssuchasprincipalcomponentanalysisorcanonicalcorrelationanalysis.However spectralanalysisbecomeschallenginginpracticalscenarioswherethedataisonlypartiallyobserved.Wecommonlyobservepairwiserelationsofrandomlychosenpairs:eachuseronlyratesafewmoviesinrecommendationsystems andeachplayer/teamonlyplaysagainstafewopponentsinsports.Inotherapplications wehavemorestructuredsamples.Forexample inanetworkanalysiswemightbeinterestedinthespectrumoftheadjacencymatrixofalargenetwork butonlygettoseetheconnectionswithinasmallsubsetofnodes.Whateverthesamplingpatternis typicalnumberofpairedrelationsweobserveissigniﬁcantlysmallerthanthedimensionofthedatamatrix.Westudyallsuchvariationsinsamplingpatternsforpartiallyobserveddatamatrices andaskthefollowingfundamentalquestion:canweestimatespectralpropertiesofadatamatrixfrompartialobservations?Webuildonthefactthatseveralspectralpropertiesofinterest suchasthespectrumitselfortherank canbeestimatedaccuratelyviaﬁrstestimatingtheSchattenk-normsofamatrixandthenaggregatingthosenormstoestimatethespectralproperties.Inthispaper wefocusonthechallengingtaskofestimatingtheSchattenk-normsdeﬁnedaskMkk=(Pdi=1σi(M)k)1/k whereσ1(M)≥···≥σd(M)aresingularvaluesofthedatamatrixM∈Rd×d.OnceweobtainaccurateestimatesofSchattenk-norms theseestimates aswellascorrespondingperformanceguarantees canreadilybetranslatedintoaccurateestimatesofthespectralpropertiesofinterest.31stConferenceonNeuralInformationProcessingSystems(NIPS2017) LongBeach CA USA.1.1SetupWewanttoestimatetheSchattenk-normofapositivesemideﬁnitematrixM∈Rd×dfromasubsetofitsentries.Therestrictiontopositivesemideﬁnitematricesisfornotationalconvenience andouranalyses theestimator andtheefﬁcientalgorithmsnaturallygeneralizetoanynon-squarematrices.Namely wecanextendourframeworktobipartitegraphsandestimateSchattenk-normofanymatrixforanyevenk.LetΩdenotethesetofindicesofsampleswearegivenandletPΩ(M)={(i j Mij)}(i j)∈Ωdenotethesamples.Withaslightabuseofnotation weusedPΩ(M)toalsodenotethed×dsampledmatrix:PΩ(M)ij=(cid:26)Mijif(i j)∈Ω 0otherwise anditshouldbeclearfromthecontextwhichonewereferto.Althoughweproposeaframeworkthatgenerallyappliestoanyprobabilisticsampling itisnecessarytoproposespeciﬁcsamplingscenariostoprovidetightanalysesontheperformance.Hence wefocusonErdös-Rényisampling.Thereisanextensivelineofresearchinlow-rankmatrixcompletionproblems[3 11] whichaddressesafundamentalquestionofhowmanysamplesarerequiredtocompleteamatrix(i.e.estimateallthemissingentries)fromasmallsubsetofsampledentries.Itistypicallyassumedthateachentryofthematrixissampledindependentlywithaprobabilityp∈(0 1].WerefertothisscenarioasErdös-Rényisampling astheresultingpatternofthesamplesencodedasagraphisdistributedasanErdös-Rényirandomgraph.Thespectralpropertiesofsuchansampledmatrixhavebeenwellstudiedintheliterature[7 1 6 11 14].Inparticular itisknownthattheoriginalmatrixiscloseinspectralnormtothesampledonewherethemissingentriesareﬁlledinwithzerosandproperlyrescaledundercertainincoherenceassumptions.Thissuggestsusingthesingularvaluesof(d2/|Ω|)P(M)directlyforestimatingtheSchattennorms.However inthesub-linearregimeinwhichthenumberofsamples|Ω|=d2piscomparabletoorsigniﬁcantlysmallerthanthedegreesoffreedominrepresentingasymmetricrank-rmatrix whichisdr−r2 thespectrumofthesampledmatrixissigniﬁcantlydifferentfromthespectrumoftheoriginalmatrixasshowninFigure1.Weneedtodesignnovelestimatorsthataremoresampleefﬁcientinthesub-linearregimewhered2p(cid:28)dr. 10 20 30 40 50 0 10 20 30histogramof{σi(M)}di=1←histogramof(rescaled){σi(PΩ(M))}di=1↓Figure1:Histogramof(positive)singularvaluesofMwithrankr=100(inyellow) andsingularvaluesofthesampledmatrix(inblack).1.2SummaryoftheapproachandpreviewofresultsWeproposeusinganalternativeexpressionoftheSchattenk-normforpositivesemideﬁnitematricesasthetraceofthek-thpowerofM i.e.(kMkk)k=Tr(Mk).ThissumoftheentriesalongthediagonalofMkisthesumoftotalweightsofalltheclosedwalksoflengthk.ConsidertheentriesofMasweightsonacompletegraphKdoverdnodes(withself-loops).Aclosedwalkoflengthkisdeﬁnedasasequenceofnodesw=(w1 w2 ... wk+1)withw1=wk+1 whereweallowrepeatednodesandrepeatededges.Theweightofaclosedwalkw=(w1 ... wk w1)isdeﬁnedasωM(w)≡Qki=1Mwiwi+1 whichistheproductoftheweightsalongthewalk.ItfollowsthatkMkkk=Xw:alllengthkclosedwalksωM(w).(1)Followingthenotationsfromenumerationofsmallsimplecyclesinagraphby[2] wepartitionthissummationintothosewiththesamepatternHthatwecallak-cyclicpseudograph.Let2Ck=(Vk Ek)denotetheundirectedsimplecyclegraphwithknodes e.g.A3inFigure2isC3.Weexpandthestandardnotionofsimplek-cyclicgraphstoincludemultiedgesandloops hencethenamepseudograph.Deﬁnition1WedeﬁneanunlabelledandundirectedpseudographH=(VH EH)tobeak-cyclicpseudographfork≥3ifthereexistsanontonode-mappingfromCk=(Vk Ek) i.e.f:Vk→VH andaone-to-oneedge-mappingg:Ek→EHsuchthatg(e)=(f(ue) f(ve))foralle=(ue ve)∈Ek.WeuseHktodenotethesetofallk-cyclicpseudographs.Weusec(H)tothenumberofdifferentnodemappingsffromCktoak-cyclicpseudographH.A1A2A3c(A1)=1c(A2)=3c(A3)=6Figure2:The3-cyclicpseudographsH3={A1 A2 A3}.Intheaboveexample eachmemberofH3isadistinctpatternthatcanbemappedfromC3.ForA1 itisclearthatthereisonlyonemappingfromC3toA1(i.e.c(A1)=1).ForA2 onecanmapanyofthethreenodestotheleft-nodeofA2 hencec(A2)=3.ForA3 anyofthethreenodescanbemappedtothebottom-left-nodeofA3andalsoonecanmaptherestofthenodesclockwiseorcounter-clockwise resultinginc(A3)=6.Fork≤7 allthek-cyclicpseudographsaregivenintheAppendixE(SeeFigures8–13).EachclosedwalkwoflengthkisassociatedwithoneofthegraphsinHk asthereisauniqueHthatthewalkisanEuleriancycleof(underaone-to-onemappingofthenodes).WedenotethisgraphbyH(w)∈Hk.ConsideringtheweightofawalkωM(w) therearemultipledistinctwalkswiththesameweight.Forexample alength-3walkw=(v1 v2 v2 v1)hasH(w)=A2andthereare3walkswiththesameweightω(w)=(Mv1v2)2Mv2v2 i.e.(v1 v2 v2 v1) (v2 v2 v1 v2) and(v2 v1 v2 v2).ThismultiplicityoftheweightdependsonlyonthestructureH(w)ofawalk anditisexactlyc(H(w))thenumberofmappingsfromCktoH(w)inDeﬁnition1.Thetotalsumoftheweightsofclosedwalksoflengthkcanbepartitionedintotheirrespectivepattern whichwillmakecomputationofsuchtermsmoreefﬁcient(seeSection2)andalsode-biasingstraightforward(seeEquation(3)):kMkkk=XH∈HkωM(H)c(H) (2)wherewithaslightabuseofanotation weletωM(H)forH∈HkbethesumofalldistinctweightsofwalkswwithH(w)=H andc(H)isthemultiplicityofeachdistinctweight.ThisisanalternativetoolforcomputingtheSchattennormwithoutexplicitlycomputingtheσi(M)’s.Givenonlytheaccesstoasubsetofsampledentries onemightbetemptedtoapplytheaboveformulatothesampledmatrixwithanappropriatescaling i.e.k(d2/|Ω|)PΩ(M)kkk=(d2/|Ω|)PH∈HkωPΩ(M)(H)c(H) toestimatekMkkk.However thisissigniﬁcantlybiased.Toeliminatethebias weproposerescalingeachtermin(1)bytheinverseoftheprobabilityofsamplingthatparticularwalkw(i.e.theprobabilitythatalledgesinwaresampled).Acrucialobservationisthat foranysamplingmodelthatisinvariantunderarelabellingofthenodes thisprobabilityonlydependsonthepatternH(w).Inparticular thisistrueforErdös-Rényisampling.Basedonthisobservation weintroduceanovelestimatorthatde-biaseseachgroupseparately:bΘk(PΩ(M))=XH∈Hk1p(H)ωPΩ(M)(H)c(H) (3)wherep(H)istheprobabilitythepatternHissampled.Itimmediatelyfollowsthatthisestimatorisunbiased i.e.EΩ[bΘk(PΩ(M))]=kMkkk wheretherandomnessisinΩ.However computingthisestimatecanbechallenging.NaiveenumerationoverallclosedwalksoflengthktakestimescalingasO(d∆k−1) where∆isthemaximumdegreeofthegraph.Exceptforextremelysparsegraphs thisisimpractical.Inspiredbytheworkof[2]incountingshortcyclesinagraph weintroduceanovelandefﬁcientmethodforcomputingtheproposedestimateforsmallvaluesofk.3Proposition2ForapositivesemideﬁnitematrixMandanysamplingpatternΩ theproposedestimatebΘk(PΩ(M))in(3)canbecomputedintimeO(dα)fork∈{3 4 5 6 7} whereα<2.373istheexponentofmatrixmultiplication.Fork=1or2 bΘk(PΩ(M))canbecomputedintimeO(d)andO(d2) respectively.Thisboundholdsregardlessofthedegree andthecomplexitycanbeevensmallerforsparsegraphsasmatrixmultiplicationsaremoreefﬁcient.WegiveaconstructiveproofbyintroducinganovelalgorithmachievingthiscomplexityinSection2.Fork≥8 ourapproachcanpotentiallybeextended butthecomplexityoftheproblemfundamentallychangesasitisatleastashardascountingK4inagraph forwhichthebestknownruntimeisO(dα+1)forgeneralgraphs[12].Wemakethefollowingcontributionsinthispaper:•Weintroducein(3)anovelunbiasedestimatoroftheSchattenk-normofapositivesemidef-initematrixM fromarandomsamplingofitsentries.Ingeneral thecomplexityofcomputingtheestimatescalesasO(d∆k)where∆isthemaximumdegree(numberofsampledentriesinacolumn)inthesampledmatrix.Weintroduceanovelefﬁcientalgorithmforcomputingtheestimatein(3)exactlyforsmallk≤7 whichinvolvesonlymatrixoperations.Thisalgorithmissigniﬁcantlymoreefﬁcientandhasrun-timescalingasO(dα)independentofthedegreeandforallk≤7(seeProposition2).•UnderthecanonicalErdös-Rényisampling weshowthattheSchattenk-normofanincoher-entrank-rmatrixcanbeapproximatedwithinanyconstantmultiplicativeerror withnumberofsamplesscalingasO(dr1−2/k)(seeTheorem1).Inparticular thisisstrictlysmallerthanthenumberofsamplesnecessarytocompletethematrix whichscalesasO(drlogd).Belowthismatrixcompletionthreshold numericalexperimentsconﬁrmthattheproposedestimatorsigniﬁcantlyoutperformssimpleheuristicsofusingsingularvaluesofthesampledmatricesdirectlyorapplyingstate-of-the-artmatrixcompletionmethods(seeFigure4).•GivenestimationofﬁrstKSchattennorms itisstraightforwardtoestimatespectralproperties.WeapplyourSchattennormestimatestotheapplicationofestimatingthegeneralizedrankstudiedin[20]andestimatingthespectrumstudiedin[13].Weprovideperformanceguaranteesforbothapplicationsandprovideexperimentalresultssuggestingweimproveuponothercompetingmethods.Duetospacelimitations theseresultsareincludedinAppendixB.Intheremainder weprovideanefﬁcientimplementationoftheestimator(3)forsmallkinSection2.InSection3 weprovideatheoreticalanalysisofourestimator.1.3RelatedworkSeveralSchattennormestimationproblemsunderdifferentresourceconstrainedscenarioshavebeenstudied.However thoseapproachesassumespeciﬁcnoisyobservationswhichallowthemtousetherelationE(cid:2)kf(M)gk22(cid:3)=Pif(σi(M))2whichholdsforastandardi.i.d.Gaussiang∼N(0 I)andanypolynomialfunctionf(·).Thismakestheestimationsigniﬁcantlyeasierthanoursetting andnoneofthosealgorithmscanbeappliedunderourrandomsamplingmodel.Inparticular countingsmallstructureforde-biasingisnotrequired.[20 8]and[9]proposemultiplyingGaussianrandomvectorstothedatamatrix inordertoreducecommunicationand/orcomputation.[13]proposesaninterestingestimatorforthespectrumofthecovariancematrixfromsamplesofrandomavector.[15]proposesimilarestimatorsforSchattennormsfromrandomlinearprojectionsofadatamatrix and[16]studytheproblemforsparsedatamatricesinastreamingmodel.OneofourcontributionisthatweproposeanefﬁcientalgorithmforcomputingtheweightedcountsofsmallstructuresinSection2 whichcansigniﬁcantlyimproveuponlesssample-efﬁcientcounterpartin forexample [13].Underthesettingof[13](andalso[15]) themainideaoftheestimatoristhattheweightofeachlength-kcycleintheobservedempiricalcovariancematrix(1/n)Pni=1XiXTiprovidesanunbiasedestimatorofkE[XXT]kkk.Onepreferstosumovertheweightsofasmanycyclesascomputationallyallowedinordertoreducethevariance.Ascountingallcyclesisingeneralcomputationallyhard theyproposecountingonlyincreasingcycles(whichonlyaccountsforonly1/k!fractionofallthecycles) whichcanbecomputedintimeO(dα).Ifonehasanefﬁcientmethodtocountallthe(weighted)cycles thenthevarianceoftheestimatorcouldpotentiallydecreasebyanorderofk!.Fork≤7 ourproposedalgorithminSection2providesexactlysuchanestimator.4Wereplace[13 Algorithm1]withours andrunthesameexperimenttoshowcasetheimprovementinFigure3 fordimensiond=2048andvariousvaluesofnumberofsamplesncomparingthemultiplicativeerrorinestimatingkE[XXT]kkk fork=7.Withthesamerun-time signiﬁcantgainisachievedbysimplysubstitutingourproposedalgorithmforcountingsmallstructures inthesub-routine.Ingeneral theefﬁcientalgorithmweproposemightbeofindependentinteresttovariousapplications andcandirectlysubstitute(andsigniﬁcantlyimproveupon)otherpopularbutlessefﬁcientcounterparts. 0.01 0.1 1 10 100 256 512 1024 2048increasing simple cyclesall simple cyclesnumberofsamples n\|kE[XXT]kkk−kE[XXT]kkk|kE[XXT]kkkFigure3:Byreplacing[13 Algorithm1]thatonlycountsincreasingcycleswithourproposedalgorithmthatcountsallcycles signiﬁcantgainisacheivedinestimatingkE[XXT]kkk fork=7.Themainchallengeunderoursamplingscenarioisthatexistingcountingmethodslikethatof[13]cannotbeapplied regardlessofhowmuchcomputationalpowerwehave.Underthematrixcompletionscenario weneedto(a)sumoverallsmallstructuresH∈HkandnotjustCkasin[13];and(b)foreachstructureweneedtosumoverallsubgraphswiththesamestructureandnotjustthosewalkswhoselabelsformamonotonicallyincreasingsequenceasin[13].2EfﬁcientAlgorithmInthissectionwegiveaconstructiveproofofProposition2.Incomputingtheestimatein(3) c(H)canbecomputedintimeO(k!)andsupposep(H)hasbeencomputed(wewillexplainhowtocomputep(H)forErös-RényisamplinginSection3).ThebottlenecktheniscomputingtheweightsωPΩ(M)(H)foreachH∈Hk.LetγM(H)≡ωM(H)c(H).WegivematrixmultiplicationbasedequationstocomputeγM(H)foreveryH∈Hkfork∈{3 4 5 6 7}.ThisestablishesthatγM(H) andhenceωM(H) canbecomputedintimeO(dα) provingProposition2.ForanymatrixA∈Rd×d letdiag(A)tobeadiagonalmatrixsuchthat(diag(A))ii=Aii foralli∈[d]and(diag(A))i j=0 foralli6=j∈[d].ForagivenmatrixM∈Rd×d deﬁnethefollowing:OMtobematrixofoff-diagonalentriesofMthatisOM≡M−diag(M)andweletDM≡diag(M).Lettr(A)denotetraceofA thatistr(A)=Pi∈[d]Aii andletA∗BdenotethestandardmatrixmultiplicationoftwomatricesAandBtomakeitmoreexplicit.ConsidercomputingγM(H)forH∈H3aslabeledinFigure2:γM(A1)=tr(DM∗DM∗DM)(4)γM(A2)=3tr(DM∗OM∗OM)(5)γM(A3)=tr(OM∗OM∗OM)(6)TheﬁrstweightedsumγM(A1)issumofallweightsofwalksoflength3thatconsistsofthreeself-loops.OnecanshowthatγM(A1)=Pi∈[d]M3ii whichinourmatrixoperationnotationsis(4).Similarly γM(A3)isthesumofweightsoflength3walkswithnoself-loop whichleadsto(6).γM(A2)isthesumofweightsoflength3walkswithasingleself-loop whichleadsto(5).Thefactor3accountsforthefactthattheselfloopcouldhavebeenplacedatvariouspositions.Similarly foreachk-cyclicpseudographsinHkfork≤7 computingγM(H)involvesafewmatrixoperationswithrun-timeO(dα).WeprovidethecompletesetofexplicitexpressionsinAppendixF.AMATLABimplementationoftheestimator(3) thatincludesasitssub-routinesthecomputationoftheweightsofallk-cyclicpseudographs isavailablefordownloadat5https://github.com/khetan2/Schatten_norm_estimation.TheexplicitformulaeinAp-pendixFtogetherwiththeimplementationintheaboveurlmightbeofinteresttootherproblemsinvolvingcountingsmallstructuresingraphs.Fork=1 theestimatorsimpliﬁestobΘk(PΩ(M))=(1/p)PiPΩ(M)ii whichcanbecomputedintimeO(d).Fork=2 theestimatorsimpliﬁestobΘk(PΩ(M))=(1/p)Pi jPΩ(M)2ij whichcanbecomputedintimeO(|Ω|).However fork≥8 thereexistswalksoverK4 acliqueover4nodes thatcannotbedecomposedintosimplecomputationsinvolvingmatrixoperations.ThebestknownalgorithmforasimplertaskofcountingK4hasrun-timescalingasO(dα+1) whichisfundamentallydifferent.Algorithm1Schattenk-normestimatorRequire:PΩ(M) k Hk p(H)forallH∈HkEnsure:bΘk(PΩ(M))1:ifk≤7then2:ForeachH∈Hk computeγPΩ(M)(H)usingtheformulafromEq.(4)–(6)fork=3andEq.(43)–(186)fork∈{4 5 6 7}3:bΘk(PΩ(M))←PH∈Hk1p(H)γPΩ(M)(H)4:else5:bΘk(PΩ(M))←Algorithm2[PΩ(M) k Hk p(H)forallH∈Hk][AppendixA]6:endif3PerformanceguaranteesUnderthestylizedbutcanonicalErdös-Rényisampling noticethattheprobabilityp(H)thatweobservealledgesinawalkwithpatternHisp(H)=pm(H) (7)wherepistheprobabilityanedgeissampledandm(H)isthenumberofdistinctedgesinak-cyclicpseudographH.Plugginginthisvalueofp(H) whichcanbecomputedintimelinearink intotheestimator(3) wegetanestimatecustomizedforErdös-Rényisampling.Givenarank-rmatrixM thedifﬁcultyofestimatingpropertiesofMfromsampledentriesiscapturedbytheincoherenceoftheoriginalmatrixM whichwedenotebyµ(M)∈R[3].Formally letM≡UΣU>bethesingularvaluedecompositionofapositivedeﬁnitematrixwhereUisad×rorthonormalmatrixandΣ≡diag(σ1 ··· σr)withsingularvaluesσ1≥σ2≥···≥σr>0.LetUi rdenotethei-throwandj-thcolumnentryofmatrixU.Theincoherenceµ(M)isdeﬁnedasthesmallestpositivevalueµsuchthatthefollowingholds:A1.Foralli∈[d] wehavePra=1U2ia(σa/σ1)≤µr/d.A2.Foralli6=j∈[d] wehave|Pra=1UiaUja(σa/σ1)|≤µ√r/d.Theincoherencemeasureshowwellspreadoutthematrixisandisacommonmeasureofdifﬁcultyincompletingamatrixfromrandomsamples[3 11].3.1PerformanceguaranteeForanyd×dpositivesemideﬁnitematrixMofrankrwithincoherenceµ(M)=µandtheeffectiveconditionnumberκ=σmax(M)/σmin(M) wedeﬁneρ2≡(κµ)2kg(k)max(1 (dp)k−1d rkpk−1dk−1) (8)suchthatthevarianceofourestimatorisboundedbyVar(bΘ(PΩ(M))/kMkkk)≤ρ2(r1−2/k/dp)kasweshowintheproofofTheorem1inSectionD.1.Here g(k)=O(k!).6Theorem1(UpperboundundertheErdös-Rényisampling)Foranyintegerk∈[3 ∞) anyδ>0 anyrank-rpositivesemideﬁnitematrixM∈Rd×d andgiveni.i.d.samplesoftheentriesofMwithprobabilityp theproposedestimateof(3)achievesnormalizederrorδwithprobabilityboundedbyP (cid:12)(cid:12)bΘk(PΩ(M))−kMkkk(cid:12)(cid:12)kMkkk≥δ!≤ρ2δ2(cid:16)r1−2/kdp(cid:17)k.(9)Consideratypicalscenariowhereµ κ andkareﬁnitewithrespecttodandr.ThentheChebyshev’sboundin(9)impliesthatthesampled2p=O(dr1−2/k)issufﬁcienttorecoverkMkkkuptoarbitrarilysmallmultiplicativeerrorandarbitrarilysmall(butstrictlypositive)errorprobability.Thisisstrictlylessthantheknownminimaxsamplecomplexityforrecoveringtheentirelow-rankmatrix whichscalesisΘ(rdlogd).Asweseektoestimateonlyapropertyofthematrix(i.e.theSchattenk-norm)andnotthewholematrixitself wecanbemoreefﬁcientonthesamplecomplexitybyafactorofr2/kinrankandafactoroflogdinthedimension.Weemphasizeherethatsuchagaincanonlybeestablishedusingtheproposedestimatorbasedonthestructureofthek-cyclicpseudographs.WewillshowempiricallythatthestandardmatrixcompletionapproachesfailinthecriticalregimeofsamplesbelowtherecoverythresholdofO(rdlogd). 0 0.2 0.4 0.6 0.8 1 0.01 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1proposed estimatorscaled sampled matrix matrix completionsamplingprobability prelativeerrord=500 r=100 0 0.2 0.4 0.6 0.8 1 0.01 0.1 0.2 0.3 0.4 0.5 0.6 0.7 0.8 0.9 1proposed estimatorscaled sampled matrixmatrix completionsamplingprobability prelativeerrord=500 r=500Figure4:Theproposedestimatoroutperformsbothbaselineapproachesbelowthematrixcompletionthreshold.Fork=5 comparisonoftheabsoluterelativeerrorinestimatedSchattennormthatis(cid:12)(cid:12)kMkkk−\kMkkk(cid:12)(cid:12)/kMkkkforthethreealgorithms:(1)theproposedestimator \kMkkk=bΘk(PΩ(M)) (2)Schattennormofthescaledsampledmatrix \kMkkk=k(1/p)Pr(PΩ(M))kkk (3)Schattennormofthecompletedmatrix fM=AltMin(PΩ(M))from[10] \kMkkk=kfMkkk wherePr(·)isthestandardbestrank-rprojectionofamatrix.ΩisgeneratedbyErdös-RényisamplingofmatrixMwithprobabilityp.Figure4isascatterplotoftheabsoluterelativeerrorinestimatedSchattenk-norm (cid:12)(cid:12)kMkkk−\kMkkk(cid:12)(cid:12)/kMkkk fork=5 forthreeapproaches:theproposedestimator Schattennormofthescaledsampledmatrix(afterrank-rprojection) andSchattennormofthecompletedmatrix usingstate-of-the-artalternatingminimizationalgorithm[10].Allthethreeestimatorsareevaluated20timesforeachvalueofp.Misasymmetricpositivesemi-deﬁnitematrixofsized=500 andrankr=100(leftpanel)andr=500(rightpanel).SingularvectorsUofM=UΣU> aregeneratedbyQRdecompositionofN(0 Id×d)andΣi iisuniformlydistributedover[1 2].Foralowrankmatrixontheleft thereisaclearcriticalvalueofp’0.45 abovewhichmatrixcompletionisexactwithhighprobability.However thisalgorithmknowstheunderlyingrankandcruciallyexploitsthefactthattheunderlyingmatrixisexactlylow-rank.Incomparison ourapproachisagnostictothelow-rankassumptionbutﬁndstheaccurateestimatethatisadaptivetotheactualrankinadata-drivenmanner.Usingtheﬁrstrsingularvaluesofthe(rescaled)sampledmatrixfailsmiserablyforallregimes(wetruncatetheerroratoneforillustrationpurposes).Inthispaper weareinterestedinthe7regimewhereexactmatrixcompletionisimpossibleaswedonothaveenoughsamplestoexactlyrecovertheunderlyingmatrix:p≤0.45intheleftpanelandallregimesintherightpanel.Thesufﬁcientconditionofd2p=O(dr1−2/k)inTheorem1holdsforabroadrangeofparameterswheretherankissufﬁcientlysmallr=O(dk/((k−1)(k−2)))(toensurethattheﬁrstterminρ2dominates).However thefollowingresultsinFigure5onnumericalexperimentssuggestthatouranalysisholdsmoregenerallyforallregimesoftherankr eventhoseclosetod.MisgeneratedusingsettingssimilartothatofFigure4.Empiricalprobabilitiesarecomputedbyaveragingover100instances.OnemighthopetotightentheChebyshevboundbyexploitingthefactthatthecorrelationamongthesummandsinourestimator(3)isweak.Thiscanbemadepreciseusingrecentresultfrom[18] whereaBernstein-typeboundwasprovedforsumofpolynomialsofindependentrandomvariablesthatareweaklycorrelated.Theﬁrstterminthebound(10)isthenaturalBernstein-typeboundcorrespondingtotheChebyshev’sboundin(9).However undertheregimewherekislargeorpislarge thecorrelationamongthesummandsbecomestronger andthesecondandthirdterminthebound(10)startstodominate.Inthetypicalregimeofinterestwhereµ κ kareﬁnite d2p=O(dr1−2/k) andsufﬁcientlysmallrankr=O(dk/((k−1)(k−2))) theerrorprobabilityisdominatedbytheﬁrsttermintheright-handsideof(10).Neitheroneofthetwoboundsin(9)and(10)dominatestheother anddependingonthevaluesoftheproblemparameters wemightwanttoapplytheonethatistighter.WeprovideaproofinSectionD.2.Theorem2UnderthehypothesesofTheorem1 theerrorprobabilityisupperboundedbyP (cid:12)(cid:12)bΘk(PΩ(M))−kMkkk(cid:12)(cid:12)kMkkk≥δ!≤e2max(e−δ2ρ2(cid:16)dpr1−2/k(cid:17)k e−(dp)(cid:16)δdρrk−1(cid:17)1/k e−(dp)(cid:16)δdρrk−1(cid:17) e−δdpρ).(10)5505000.0020.020.2 0 0.2 0.4 0.6 0.8 1rank rsamplingprobability pk=2k=3k=4k=5k=6k=75505000.0020.020.2 0 0.2 0.4 0.6 0.8 1k=2k=3k=4k=5k=6k=7Figure5:Eachcolormapineachblockfork∈{2 3 4 5 6 7}showempiricalprobabilityoftheevent(cid:8)(cid:12)(cid:12)kMkkk−bΘk(PΩ(M))(cid:12)(cid:12)/kMkkk≤δ(cid:9) forδ=0.5(leftpanel)andδ=0.2(rightpanel).ΩisgeneratedbyErdös-RényisamplingofmatrixMwithprobabilityp(verticalaxis).Misasymmetricpositivesemi-deﬁnitematrixofsized=1000.Thesolidlinescorrespondtoourtheoreticalpredictionp=(1/d)r1−2/k.Thesetworesultsshowthatthesamplesizeofd2p=O(dr1−2/k)issufﬁcienttoestimateaSchattenk-normaccurately.Ingeneral wedonotexpecttogetauniversalupperboundthatissigniﬁcantlytighterforallr becauseforaspecialcaseofr=d thefollowingcorollaryof[15 Theorem3.2]providesalowerbound;itisnecessarytohavesamplesized2p=Ω(d2−4/k)whenr=d.Hence thegapisatmostafactorofr2/kinthesamplecomplexity.Corollary1ConsideranylinearobservationX∈RnofamatrixM∈Rd×dandanyestimateθ(X)satisfying(1−δk)kMkkk≤θ(X)≤(1+δk)kMkkkforanyMwithprobabilityatleast3/4 whereδk=(1.2k−1)/(1.2k+1).Then n=Ω(d2−4/k).8Fork∈{1 2} preciseboundscanbeobtainedwithsimpleranalyses.Inparticular wehavethefollowingremarks whoseprooffollowsimmediatelybyapplyingChebyshev’sinequalityandBernstien’sinequalityalongwiththeincoherenceassumptions.Remark3Fork=1 theprobabilityoferrorin(9)isupperboundedbymin{ν1 ν2} whereν1≡1δ2(κµ)2dp andν2≡2exp(cid:16)−δ22(cid:16)(κµ)2dp+δ(κµ)3dp(cid:17)−1(cid:17).Remark4Fork=2 theprobabilityoferrorin(9)isupperboundedbymin{ν1 ν2} whereν1≡1δ2(κµ)4d2p(cid:0)2+r2d(cid:1) andν2≡2exp(cid:16)−δ22(cid:16)(κµ)4d2p(cid:0)2+r2d(cid:1)+δ(κµ)2r3d2p(cid:17)−1(cid:17).Whenk=2 forranksmallr≤C√d weonlyneedd2p=Ω(1)samplesforrecoveryuptoanyarbitrarysmallmultiplicativeerror.Whenrankrislarge ourestimatorrequiresd2p=Ω(d)forbothk∈{1 2}.AcknowledgmentsThisworkwaspartiallysupportedbyNSFgrantsCNS-1527754 CCF-1553452 CCF-1705007andGOOGLEFacultyResearchAward.References[1]DimitrisAchlioptasandFrankMcSherry.Fastcomputationoflowrankmatrixapproximations.InProceedingsofthethirty-thirdannualACMsymposiumonTheoryofcomputing pages611–618.ACM 2001.[2]N.Alon R.Yuster andU.Zwick.Findingandcountinggivenlengthcycles.Algorithmica 17(3):209–223 1997.[3]E.J.CandèsandB.Recht.Exactmatrixcompletionviaconvexoptimization.FoundationsofComputationalMathematics 9(6):717–772 2009.[4]E.DiNapoli E.Polizzi andY.Saad.Efﬁcientestimationofeigenvaluecountsinaninterval.NumericalLinearAlgebrawithApplications 2016.[5]KhaledMElbassioni.Apolynomialdelayalgorithmforgeneratingconnectedinducedsub-graphsofagivencardinality.J.GraphAlgorithmsAppl. 19(1):273–280 2015.[6]U.FeigeandE.Ofek.Spectraltechniquesappliedtosparserandomgraphs.RandomStruct.Algorithms 27(2):251–275 2005.[7]J.Friedman J.Kahn andE.Szemerédi.Onthesecondeigenvalueinrandomregulargraphs.InProceedingsoftheTwenty-FirstAnnualACMSymposiumonTheoryofComputing pages587–598 Seattle Washington USA may1989.ACM.[8]I.Han D.Malioutov H.Avron andJ.Shin.Approximatingthespectralsumsoflarge-scalematricesusingchebyshevapproximations.arXivpreprintarXiv:1606.00942 2016.[9]I.Han D.Malioutov andJ.Shin.Large-scalelog-determinantcomputationthroughstochasticchebyshevexpansions.InICML pages908–917 2015.[10]P.Jain P.Netrapalli andS.Sanghavi.Low-rankmatrixcompletionusingalternatingminimiza-tion.InSTOC pages665–674 2013.[11]R.H.Keshavan A.Montanari andS.Oh.Matrixcompletionfromafewentries.InformationTheory IEEETransactionson 56(6):2980–2998 2010.[12]T.Kloks D.Kratsch andH.Müller.Findingandcountingsmallinducedsubgraphsefﬁciently.InformationProcessingLetters 74(3):115–121 2000.9[13]W.KongandG.Valiant.Spectrumestimationfromsamples.arXivpreprintarXiv:1602.00061 2016.[14]C.M.Le E.Levina andR.Vershynin.Sparserandomgraphs:regularizationandconcentrationofthelaplacian.arXivpreprintarXiv:1502.03049 2015.[15]Y.Li H.L.Nguyên andD.P.Woodruff.Onsketchingmatrixnormsandthetopsingularvector.InProceedingsoftheTwenty-FifthAnnualACM-SIAMSymposiumonDiscreteAlgorithms pages1562–1581.SocietyforIndustrialandAppliedMathematics 2014.[16]Y.LiandD.P.Woodruff.Onapproximatingfunctionsofthesingularvaluesinastream.arXivpreprintarXiv:1604.08679 2016.[17]J.C.MasonandD.C.Handscomb.Chebyshevpolynomials.CRCPress 2002.[18]W.SchudyandM.Sviridenko.Bernstein-likeconcentrationandmomentinequalitiesforpolynomialsofindependentrandomvariables:multilinearcase.arXivpreprintarXiv:1109.5193 2011.[19]RyuheiUeharaetal.Thenumberofconnectedcomponentsingraphsanditsapplications.Manuscript.URL:http://citeseerx.ist.psu.edu/viewdoc/summary 1999.[20]Y.Zhang M.J.Wainwright andM.I.Jordan.Distributedestimationofgeneralizedmatrixrank:Efﬁcientalgorithmsandlowerbounds.arXivpreprintarXiv:1502.01403 2015.10,Ashish Khetan
Sewoong Oh